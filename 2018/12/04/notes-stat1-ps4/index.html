<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.52" />


<title>Notes on Econometrics: PS4 - loikein</title>
<meta property="og:title" content="Notes on Econometrics: PS4 - loikein">



  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/loikein-logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/">Posts</a></li>
    
    <li><a href="/tags/">Tags</a></li>
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="https://github.com/loikein">GitHub</a></li>
    
    <li><a href="https://twitter.com/LeiqiongWan">Twitter</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">5 min read</span>
    

    <h1 class="article-title">Notes on Econometrics: PS4</h1>

    
    <span class="article-date">2018/12/04</span>
    
    
    
    <span class="tags">
    
    
    Tags:
    
    <a href='/tags/notes'>notes</a>
    
    <a href='/tags/r'>R</a>
    
    <a href='/tags/stat'>stat</a>
    
    
    
    </span>
    

    <div class="article-content">
      

<div id="TOC">
<ul>
<li><a href="#q1">Q1</a><ul>
<li><a href="#a">a)</a></li>
<li><a href="#b">b)</a></li>
<li><a href="#c">c)</a></li>
<li><a href="#d">d)</a></li>
<li><a href="#e">e)</a></li>
<li><a href="#f">f)</a></li>
<li><a href="#g">g)</a></li>
</ul></li>
<li><a href="#q2">Q2</a><ul>
<li><a href="#a-1">a)</a></li>
<li><a href="#b-1">b)</a></li>
<li><a href="#c-1">c)</a></li>
<li><a href="#d-1">d)</a></li>
<li><a href="#e-1">e)</a></li>
<li><a href="#f-1">f)</a></li>
<li><a href="#g-1">g)</a></li>
<li><a href="#h">h)</a></li>
<li><a href="#i">i)</a></li>
</ul></li>
</ul>
</div>

<pre class="r"><code>library(repr)
options(repr.plot.width=4,repr.plot.height=4)</code></pre>
<div id="q1" class="section level2">
<h2>Q1</h2>
<p>Consider the nonlinear consumption function
<span class="math display">\[c_t = α + γ y_t^δ\]</span>
where <span class="math inline">\(c_t\)</span> is real consumption and yt labels real income and <span class="math inline">\(α ≥ 0\)</span>, <span class="math inline">\(γ &gt; 0\)</span> and <span class="math inline">\(δ &gt; 0\)</span></p>
<div id="a" class="section level3">
<h3>a)</h3>
Can this function be linearized?<br />

<hr>
<p>no. <span class="math inline">\(\log(c_t) = \log(α + γ y_t^δ)\)</span></p>
</div>
<div id="b" class="section level3">
<h3>b)</h3>
Under which parameter restriction is the function linear?
<hr>
<p><span class="math inline">\(δ=1\)</span> or <span class="math inline">\(α = 0\)</span></p>
</div>
<div id="c" class="section level3">
<h3>c)</h3>
Could you estimate the parameters α, γ, δ via OLS directly?
<hr>
<p>no. the estimation problem leads to an objective function that is non-linear</p>
</div>
<div id="d" class="section level3">
<h3>d)</h3>
<p>An econometrician who dislikes nonlinear least squares, but favors OLS wants to estimate the parameters in a reasonable way. The following possibilities are considered:</p>
<pre class="r"><code>rm(list=ls())

# number of obs
N = 250

# generate log-normally distributed real income
y = rlnorm(N,3,1)
# set parameters (you can vary those, of course)
beta1 = 1
beta2 = 0.6
beta3 = 0.8
# generate real consumption according to the nonlinear consumption function + random error
c = beta1 + beta2*y^(beta3) + rnorm(N,0,0.1)
plot(x = y, y = c)</code></pre>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(c_t = β_1 + β_2y_t + ε_t\)</span> such that hopefully <span class="math inline">\(b_1 = \hat{α}\)</span> and <span class="math inline">\(b_2 = \hat{γ}\)</span>
<hr>
is good when <span class="math inline">\(δ = 1\)</span></li>
</ol>
<pre class="r"><code># (i)
reg1 = lm(c ~ y)
summary(reg1)</code></pre>
<ol start="2" style="list-style-type: lower-roman">
<li><span class="math inline">\(\ln(c_t) = β_1 + β_2 \ln(y_t) + ε_t\)</span> such that hopefully <span class="math inline">\(b_1 = \ln(\hat{γ})\)</span> and <span class="math inline">\(b_2 = \hat{δ}\)</span>
<hr>
is good when <span class="math inline">\(α = 0\)</span>, <span class="math inline">\(\hat{γ} = \exp(b_1)\)</span> and <span class="math inline">\(\hat{δ} = b_2\)</span><br>
inference on a non-linear transormation of a parameter via the <b>delta method</b></li>
</ol>
<pre class="r"><code># (ii)
reg2 = lm(log(c) ~ log(y))
summary(reg2)
exp(reg2$coef[1])</code></pre>
<ol start="3" style="list-style-type: lower-roman">
<li><span class="math inline">\(c_t = β_1 + β_2y_t^2 + ε_t\)</span> such that hopefully <span class="math inline">\(b_1 = \hat{α}\)</span> and <span class="math inline">\(b_2 = \hat{γ}\)</span> and <span class="math inline">\(\hat{δ} = 2\)</span>.
<hr>
is good when <span class="math inline">\(δ = 2\)</span></li>
</ol>
<pre class="r"><code># (iii)
reg3 = lm(c ~ I(y^2))
summary(reg3)</code></pre>
<ol start="4" style="list-style-type: lower-roman">
<li><span class="math inline">\(c = β_1 + β_2 \sqrt{y} + ε\)</span> such that hopefully <span class="math inline">\(b_1 = \hat{α}\)</span> and <span class="math inline">\(b_2 = \hat{γ}\)</span> and <span class="math inline">\(\hat{δ} = 1/2\)</span>.
<hr>
is good when <span class="math inline">\(δ = 1/2\)</span></li>
</ol>
<pre class="r"><code># (iv)
reg4 = lm(c ~ I(sqrt(y)))
summary(reg4)</code></pre>
v)<span class="math inline">\(c_t =β_1+β_2\tilde{y}_t+ε_t\)</span> where <span class="math inline">\(\tilde{y}_t =y_t^a\)</span> with <span class="math inline">\(a\in A=[\underline{a},\bar{a}]\)</span> and <span class="math inline">\(0 &lt; \underline{a} &lt; \bar{a} \leq\infty\)</span>
<hr>
<p>hopefully works w/o restrictions</p>
<pre class="r"><code># (v)
beta3.fix = 1
reg5 = lm(c ~ I(y^beta3.fix))
summary(reg5)

beta3.fix = 1.1
reg5 = lm(c ~ I(y^beta3.fix))
summary(reg5)

beta3.fix = 0.9
reg5 = lm(c ~ I(y^beta3.fix))
summary(reg5)

beta3.fix = 0.8
reg5 = lm(c ~ I(y^beta3.fix))
summary(reg5)

beta3.fix = 1.2
reg5 = lm(c ~ I(y^beta3.fix))
summary(reg5)</code></pre>
</div>
<div id="e" class="section level3">
<h3>e)</h3>
<p>Use the US data from 1960:Q1 to 2009:Q4 with N = 200 observations available in the data set usdata.txt to estimate the parameters empirically.<br />
In the data set, the first column is real consumption, and the second is real disposable income.<br />
The R code nonlin_consum_estim.R implements the different approaches.<br />
Comment on your findings and summarize them in a regression output table.</p>
<pre class="r"><code>rm(list=ls())

#     U.S. data on real consumption and real disposable income(2005 $)
#     1960:Q1 to 2009:Q4 200 observations

USdata = read.table(file=&quot;usdata.txt&quot;)
c = USdata[,1]
y = USdata[,2]
N = length(y)

# note the data is trending
ts.plot(USdata)</code></pre>
<pre class="r"><code># (v)
beta.fix.vec = seq( 0.01, 2, 0.01 )
reg5.coef = matrix( NA, length(beta.fix.vec), 2 )
s2 = matrix( NA, length(beta.fix.vec), 1 )

for(i in 1:length( beta.fix.vec )){
    beta3.fix = beta.fix.vec[i]
    reg5 = lm( c ~ I( y^beta3.fix ))
    reg5.coef[i,] = reg5$coef
    s2[i,1] = summary(reg5)$sigma^2
}

# plot objective function
plot(s2)</code></pre>
<pre class="r"><code># find the arg min and run this particular regression
which.min(s2)

i = which.min(s2)
(beta3.fix = beta.fix.vec[i])

reg5 = lm(c ~ I( y^beta3.fix ))
summary(reg5)
round(reg5$coef,2)</code></pre>
</div>
<div id="f" class="section level3">
<h3>f)</h3>
<p>Following up on e), test the restriction <span class="math inline">\(δ = 1\)</span></p>
<pre class="r"><code># restricted model
reg5r = lm( formula (c ~ y))
summary(reg5r)</code></pre>
</div>
<div id="g" class="section level3">
<h3>g)</h3>
<p>Plot the residuals and their autocorrelation function.<br />
Find the empirical first-order autocorrelation coefficient.<br />
Use the Box-Pierce test with one and five lags.<br />
State the null and the alternative hypotheses in both cases.<br />
Compute the test statistics and compare them to the appropriate critical values.<br />
Interpret your findings briefly.</p>
<pre class="r"><code># residuals of unrestricted model
e = reg5$res
par( mfrow = c( 1, 2 ))

# plot
ts.plot( e )
abline( h = 0 )

# notice that the auto-correlations are getting smaller
## plot
acf( e )
## table
acf( e, plot = FALSE )</code></pre>
<p>Use the Box-Pierce test with one and five lags.</p>
<pre class="r"><code>( rho1 = acf(e,plot=FALSE)$acf[2] )

( Q1 = N * rho1^2 )

qchisq( 0.95, 1 )
qchisq( 0.99, 1 )</code></pre>
<pre class="r"><code>( Q5 = N * sum( I( acf( e, plot = F)$acf[2:6]^2 )) )

qchisq( 0.95, 5 )</code></pre>
<pre class="r"><code># how to choose lag?
log(N)</code></pre>
</div>
</div>
<div id="q2" class="section level2">
<h2>Q2</h2>
<p>True or false?</p>
<div id="a-1" class="section level3">
<h3>a)</h3>
Under heteroskedastiticity and/or autocorrelation of the errors, the OLS estimator is still unbiased.
<hr>
<p>true. <br>
see slides</p>
</div>
<div id="b-1" class="section level3">
<h3>b)</h3>
Under heteroskedastiticity and/or autocorrelation of the errors, the covariance matrix of the OLS estimator does not change in comparison to the case of homoscedasticity and absence of autocorrelation.
<hr>
<p>wrong.<br>
see slides</p>
</div>
<div id="c-1" class="section level3">
<h3>c)</h3>
When applying robust standard errors, the OLS point estimates do not change.
<hr>
<p>true</p>
</div>
<div id="d-1" class="section level3">
<h3>d)</h3>
When applying White robust standard errors under heteroskedasticity, the t-statistics change in comparison to the case of regular standard errors assuming homoskedasticity.
<hr>
<p>true</p>
</div>
<div id="e-1" class="section level3">
<h3>e)</h3>
The PE test cannot be applied to compare a linear to an exponential specification.
<hr>
<p>false<br>
see slides 5 P12-13</p>
</div>
<div id="f-1" class="section level3">
<h3>f)</h3>
The Chow breakpoint test cannot be applied in a cross-sectional regression.
<hr>
<p>false<br>
see slides 5 P17</p>
</div>
<div id="g-1" class="section level3">
<h3>g)</h3>
The LLN states that sample moments converge in probability to their population counterparts.
<hr>
<p>true<br>
<span class="math display">\[\frac{1}{T}\sum y_t^2 \to P\to E(y_t^2)\]</span></p>
</div>
<div id="h" class="section level3">
<h3>h)</h3>
When testing a single restriction, a t-test must be used as an F -test cannot be computed for J = 1.
<hr>
<p>false</p>
</div>
<div id="i" class="section level3">
<h3>i)</h3>
When testing multiple restrictions, a t-test cannot be used.
<hr>
<p>true</p>
</div>
</div>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  (function() { 
  var d = document, s = d.createElement('script');
  s.src = 'https://loikein-github.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>





</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
          <li>By loikein with love</li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

