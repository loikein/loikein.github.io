---
title: "Notes on Game Theory"
author: "loikein"
date: "2019-04-06"
slug: "notes-game-theory"
tags: ["notes","micro","GT"]
output:
  blogdown::html_page:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = FALSE, tidy = FALSE, echo = TRUE, eval = FALSE)
```

textbook 1: (OR) [A Course in Game Theory](http://gametheory.tau.ac.il/arielDocs/downloadme.asp?id=1)  
textbook 2: (BM) [Fun and games](http://93.174.95.27/book/index.php?md5=E69CA8B537D303E08D8D422CDF09C4B6)  
[Reference: Carlos Hurtado's lecture notes](http://www.econ.uiuc.edu/~hrtdmrt2/Teaching/GT_2016_19/)

## Extensive Game (Perfect Information)

OR 6.1  
[Reference](http://gki.informatik.uni-freiburg.de/teaching/ss13/gametheory/gametheory15.pdf)

- Extensive Game with Perfect Information: 
$$Γ = \langle N,H,P,(\succsim_i)\rangle\text{ or }\langle N,H,P\rangle$$
    - Finite game: $|H|<\infty$ 
    - Finite horizon: $K <\infty$ for all $(a^k)_{k=1}^K\in H$
    - Rank of game: $\max K$ for all $(a^k)_{k=1}^K\in H$
    - Length of game: $l(Γ)$ is the length of longest history in $Γ$ 
- Set of players: $N$
    - Player function: $P: (H\backslash Z)\to N$
    - Player to move after history $h$: $P(h)$
<!--     - Initial player: $P(\emptyset)$ with $a^0\in A(\emptyset)$
    - Second player: $P(a^0)$ with $a^1\in A(a^0)$ -->
- Set of (possible) actions: $A(h): \{ a \ | \ (h,a)\in H\}$
    - Action: $a\in h$ for some $k\in K$
    - Action profile: $a = (a_i)_{i\in N}$
    - Set of action profiles: $A = \times_{i\in N} A_i$
- Preference relation: $\succsim_i$ defined on $Z$
- Set of histories: $H$
    - Initial history: $\emptyset\in H$
    - History (sequence): $h = (a^k)_{k=1}^K$
    - History of length $k+1$: $(h,a)$
    - $(a^k)_{k=1}^K\in H$, $K>L\implies (a^k)_{k=1}^L\in H$
    - $(a^k)_{k=1}^K\in H$ for all $K\in\mathbb{N} \implies (a^k)_{k=1}^{\infty}\in H$
- Set of terminal histories: $Z\subset H$
    - Terminal history: $(a^k)_{k=1}^K\in H$ is terminal if exists no $(a^k)_{k=1}^{K+1}\in H$
- Continuous in infinity:  
For any $ε>0$, exists $T\in\mathbb{N}$ s.t. $|u_i(s_i, s_{-i}) - u_i(s_i', s_{-i})| < ε$ if $s_i$ and $s_i'$ assign different actions only after histories of length $\geq T$

> Exercise (slides P13)  
> Israel is deciding whether to invest in a new costly offensive weapon system.  
> The weapon system does not create any direct benefits in case of peace, on the contrary, its maintenance is costly.  
> Being an offensive system, it also does not affect the amount of casualties Israel would have in case of an attack from Iran once Iran develops nuclear weapons.  
> However, in case of an attack from Iran, it would lead to very drastic casualties for Iran’s leaders and their families.  
> 1. How can you model Israel’s decision to invest and Iran’s decision to attack as an extensive form game?  
> 2. Imagine Israel cares only about its own casualties.  
> How would your game change if you wanted to model a defensive weapon system instead?

1. Offensive system  
NE: {( Invest; I-No, N-Attack ), ( No; I-Attack, N-Attack )}  
SPNE: {( Invest; No )}

![](/post-img/notes-game-theory--israel-iran.png){width=369px}

|        |               | Iran               |                |                |             |
| ------ | ------------- | ------------------ | -------------- | -------------- | ----------- |
|        |               | I-Attack,<br>N-Attack | I-Attack,<br>N-No | I-No,<br>N-Attack |<br>I-No, N-No  |
| Israel | Invest System | -101, -10          | -101, -10      | __\*1, 1\*__   | 1, 1\*      |
|        | No System     | __\*-100, 5\*__    | \*2,1          | -100, 5\*      | \*2, 1      |

2. Defensive system

### Strategy

- Strategy: $s_i: (H\backslash Z)\to A(h)$ for $P(h) = i$
    - Strategy profile: $s = (s_i)_{i\in N}$
    - Outcome of a strategy profile: $O(s) = (a^1,\dots, a^K)\in Z$  
    s.t. $s_{P(a^1,\dots, a^k)}(a^1,\dots, a^k) = a^{k+1}$ for all $k\in [0,K)$
- Nash Equilibrium (NE)  
$s^*$ s.t. $O(s^*)\succsim_i O(s_i, s_{-i}^*)$ for all $s_i$, for all $i\in N$
- Zermelo's Theorem (BM 1.7)  
Let $T\subset Z$ be arbitrary set of terminal histories in a finite two-player extensive game, then either player 1 can force the outcome to be in $T$, or player 2 can force the outcome to be in $Z\backslash T$ 

> Exercise (slides P16)  
> Can you use Zermelo’s Theorem to conclude that in chess either black has a strategy forcing a win, or white has a strategy forcing a win, or one of the players has a strategy forcing a draw?

Let $T_1 =$ {white wins}, $T_2 =$ {black wins}, $T_3 =$ {draw}, $T_1\cup T_2\cup T_3 = Z$  
Without loss of generality, assume $T = T_1\cup T_3$, $T^c = T_2$, there exist several cases:

1.  1. White has a strategy to force white wins or draw; or
    2. Black has a strategy to force black wins
2.  1. Black has a strategy to force white wins or draw; or
    2. White has a strategy to force black wins

So there are no certain outcomes. 

> Exercise (slides P17)  
> Consider a game of Nim with one stack.  
> Use the idea in the proof of Zermelo’s theorem to decide for what initial allocations of matches player I can force a win and for which player II can force a win.  
> Can you construct a winning strategy?

Conclusion: for games with $4k+1$ matches, player 2 has winning strategy; otherwise player 1 has winning strategy.

| \# of match left | Who has winning strategy | Strategy    |
| ----------- | ------------------------ | ----------- |
| 1           | Player 2                 | Take 1 or 2 or 3 |
| 2           | Player 1                 | Take 1           |
| 3           | Player 1                 | Take 2           |
| 4           | Player 1                 | Take 3           |
| 5           | Player 2                 |             |
| 6           | Player 1                 |             |
| 7           | Player 1                 |             |
| 8           | Player 1                 |             |
| 9           | Player 2                 |             |

5. a. Player 1 takes 1 $\implies$ 4, player 2 wins
    b. Player 1 takes 2 $\implies$ 3, player 2 wins
    c. Player 1 takes 3 $\implies$ 2, player 2 wins
6. Player 1 takes 1 $\implies$ 5, player 1 wins
7. Player 1 takes 2 $\implies$ 5, player 1 wins
8. Player 1 takes 3 $\implies$ 5, player 1 wins
9. a. Player 1 takes 1 $\implies$ 8, player 2 wins
    b. Player 1 takes 2 $\implies$ 7, player 2 wins
    c. Player 1 takes 3 $\implies$ 6, player 2 wins

### Subgame

- Subgame: $Γ(h) = \langle N,H|_h,P|_h,(\succsim_i|_h)\rangle$ starting from (the end node of) history $h\in H$ <!-- \backslash Z? -->
- Subgame Perfect Nash Equilibrium (SPNE)  
$s^*$ s.t. $O_h(s^*|_h) \succsim_i|_h O_h(s_{-i}^*|_h, s_i)$ for all $s_i$ in $Γ(h)$, for all $i\in N$, for all $h\in H$ <!-- \backslash Z? -->
    - $s^*$ s.t. $s^*|_h$ is a NE of $Γ(h)$ for all $h\in H$
- One-Step Deviation Principle (finite horizon)  
$s^*$ is a SPNE $\iff$ $O_h(s^*|_h) \succsim_i|_h O_h(s_{-i}^*|_h, s_i)$ for all $s_i$ identical to $s_i^*$ except for the action immediately after $h$, for all $i\in N$, for all $h\in H$ s.t. $P(h) = i$
- One-Step Deviation Principle (infinite horizon)  
one-step deviation principle holds for infinite horizon game if it is continuous at infinity
- Kuhn's Theorem (OR Proposition 99.2)  
Every finite extensive form game with perfect information without simultaneous moves has a subgame perfect equilibrium

> Exercise (slides P23), Exercise 3  
> Give an example of a infinite horizon game for which SPNE  
> $\iff$ one-step deviation principle does not hold.

Consider $(s_n)$ where $s_1$ corresponds to the start node  
$\implies s_n =$ {always stop} satisfies one-step deviation but is not a SPNE

![Source: [Game theory Centipede game](https://math.stackexchange.com/questions/2513447/game-theory-centipede-game)](/post-img/notes-game-theory--centipede.png)

> Exercise (slides P26)  
> Give an example of a infinite game for which Kuhn theorem does not hold.

Example of no NE or SPNE:

![](/post-img/notes-game-theory--infinite-horizon.png){width=408px}

### Chance Moves

- Player function: $P: (H\backslash Z)\to N\cup\{c\}$
- Probability function: $f_c(\cdot \ | \ h): A(h)\to [0,1]$ for each $P(h) = c$ and $a\in A(h)$
- Extensive Game with Perfect Information and Chance: $Γ = \langle N,H,P, f_c, (\succsim_i)\rangle$

> Example: Duel (OR 6.3.1)  
> Two duelists approach each other slowly starting far away from each other.  
> Each has one bullet in his pistol, and can shoot whenever they want.  
> Old-fashioned pistols weren't really reliable at a long distance, so the chance of killing the opponent depends on the distance.  
> Solve the game.

1. Let the duelists be player 1, 2, and let Nature be the third player
2. a. For each history $h\in H$ s.t. $P(h) = 3$, let the probability of $a\in A(h)$ be $f_h$
    b. Alernatively, let the initial distance be $D = d_n$, assume $n$ is odd and large.  
    For each $d\in[d_0,d_n]$, probability for player $i$ to kill the opponent be $p_i(d)$.  
    Assume $p_1(d) = p_2(d) = p(d)$ for all $d$.  
    Let $p(D) = 0$, $p(d_0) = 1$
3. When $P(h) = i$ at $d$, payoff for player $i$ to shoot is $p_i(d)$, and player $-i$ gets $1-p_i(d)$

![](/post-img/notes-game-theory--duel-tree.png)

| Distance  | Player | Payoff to shoot | Comparison | Payoff to step |
| --------- | ------ | --------------- | ---------- | -------------- |
| $d_0$     | 2      | $p(d_0) = 1$    |            |                |
| $d_1$     | 1      | $p(d_1)$        | $>$        | $1-p(d_0) = 0$ |
| $d_2$     | 2      | $p(d_2)$        | ?          | $1-p(d_1)$     |
| $d_3$     | 1      | $p(d_3)$        | ?          | $1-p(d_2)$     |
| …         |        |                 |            |                |
| $d_x$     |        | $p(d_x)$        | $>$        | $1-p(d_{x-1})$ |
| $d_{x+1}$ |        | $p(d_{x+1})$    | $=$        | $1-p(d_x)$     |
| $d_{x+2}$ |        | $p(d_{x+2})$    | $<$        | $1-p(d_{x+1})$ |
| …         |        |                 |            |                |
| $d_{n-2}$ | 1      | $p(d_{n-2})$    |            |                |
| $d_{n-1}$ | 2      | $p(d_{n-1})$    |            |                |
| $d_n$     | 1      | $p(d_n) = 0$    | $<$        |                |

Let $x\in\mathbb{R}$ be the solution that solves 
$$\begin{aligned}p(d_{x+1}) &= 1-p(d_x) \\ p(d_{x+1}) + p(d_x) &= 1 \end{aligned}$$

1. At $d_2$
    a. Player 2 shoots if $d_2 \leq d_{x+1}\implies x\geq 1$
    b. Player 2 steps if $x<1$  
    $\implies$ all choices before were "step"
2. At $d_3$
    a. Player 1 shoots if $d_3 \leq d_{x+1}\implies x\geq 2$
    b. Player 1 steps if $x<2$  
    $\implies$ all choices before were "step"
3. At $d_k$ for arbitrary $k\in\mathbb{N}$
    a. Player shoots if $d_k \leq d_{x+1}\implies x\geq k-1$
    b. Player steps if $x<k-1$  
5. Therefore, player shoots at $d_k$ if $k-1\leq x < k$

SPNE:  
Player shoots whenever $d\leq d_k$, steps whenever distance is $d> d_k$,  
where $k = \text{argmin}_{k\in\mathbb{N}} \ k > x$

> Exercise (slide P31)  
> We have assumed that $p_1(x) = p_2(x)$, i.e. that both duelists are equally skilled.  
> Go through the above analysis for the case where the that is not the case.  
> When will players start shooting?

Let $p_i(D)= 0$, $p_i = 1$, $p_i'\leq 0$, $p_1\geq p_2$  

0. At $d_0$, player 2 shoots
1. Player 1  
Let $x_1\in\mathbb{R}$ be the solution that solves 
$$\begin{aligned}p_1(x+\frac{D}{n}) + p_2(x) &= 1 \end{aligned}$$
    a. At $d_1$, player 1 shoots if  
    $$\begin{aligned}p_1(d_1) &> 1-p_2(d_0) \\
    p_1(d_1) + p_2(d_0) &> 1 \\
    p_1(d_0 + \frac{D}{n}) + p_2(d_0) &> 1  \end{aligned}$$
    $\implies$ player 1 shoots if $d_0<d_{x_1}$
    b. At $d_k$  
    Assume player 2 shoots at next step ($d_{k-1}$)
    Player 1 shoots if 
    $$\begin{aligned}p_1(d_k) &\geq 1-p_2(d_{k-1}) \\
    p_1(d_{k-1}+\frac{D}{n}) + p_2(d_{k-1}) &\geq 1\end{aligned}$$
    $\implies$ player 1 shoots if $d_{k-1}\leq x_1$
2. Player 2  
Let $x_1\in\mathbb{R}$ be the solution that solves 
$$\begin{aligned}p_2(x+\frac{D}{n}) + p_1(x) &= 1 \end{aligned}$$
    a. At $d_k$, player 2 shoots if  
    $$\begin{aligned}p_2(d_k) &\geq 1-p_1(d_{k-1}) \\
    p_2(d_{k-1}+\frac{D}{n}) + p_1(d_{k-1}) &\geq 1\end{aligned}$$
    $\implies$ player 2 shoots if $d_{k-1}\leq x_2$
3. Therefore, player i shoots at distantce $d_k$ if
$$\begin{cases}d_{k-1}\leq x_i \\ x_{k+1}>x_i \end{cases}$$
When each step is really small, player i shoots at $x_i$ when
$$\begin{aligned}\frac{D}{n} &\to 0 \\
p_i(x_i) + p_j(x_i) &\approx 1 \\
p_i(x_i) &\approx 1-p_j(x_i)\end{aligned}$$

## Bargaining

### Ultimatum Game

- Timing
    1. Player 1 proposes $x\in [0,1]$
    2. Player 2 chooses accept or reject
- Utility function: $v: [0,1]\to\mathbb{R}$
    - $v(1) = 1$, $v(0) = 0$, $v'>0$, $v''<0$
    - For player 1: $v_1(x)$ if accepted, $v_1(0)$ if rejected
    - For player 2: $v_2(1-x)$ if accepted, $v_2(0)$ if rejected
- NE: many
- SPNE: { $s_1=x_1 = 1$; $s_2 =$ accept everything }

> Exercise (slides P36)  
> What are the SPNE if the game is changed so that player 1 can only offer amounts that can be expressed in cents?

0. In any SPNE, player 2 plays A after demands where player demand less than 100 cents.  
1. Check player 2 always plays A  
Equilibrium: $(100; A)$
2. Check player 2 plays R at 100 but plays A otherwise  
Equilibrium: $(99; R|_{100}, A|_{<100})$

### Two-Round Ultimatum Game

- Timing
    1. Player 1 proposes $x_1\in [0,1]$
    2. Player 2 chooses accept or reject
    3. If player 2 rejects, player 2 proposes $x_2\in [0,1]$
    4. Player 1 chooses accept or reject
- Utility for player 1
    1. $v_1(x_1)$ if accepted
    2. $δ_1\cdot v_1(1-x_2)$ if accepts player 2's proposal
    3. $δ_1\cdot v_1(0) = 0$ if rejects player 2's proposal
- Utility for player 2
    1. $v_2(1-x_1)$ if accepts player 1's proposal
    2. $δ_2\cdot v_2(x_2)$ if accepted
    3. $δ_2\cdot v_2(0) = 0$ if rejected
- SPNE:
    - Player 2: $x_2 = 1$; accept everything larger than $δ_2\cdot v_2(1)$
    - Player 1: $x_1=x^*$ s.t. $v_2( 1-x^* ) = δ_2\cdot v_2(1)$; accept everything

![](/post-img/notes-game-theory--two-round-ultimatum.png)

### Rubinstein Game

OR 7.2

- Utility function: $v(\cdot):[0,1]\to\mathbb{R}$
    - $v(0) = 0$, $v(1) = 1$
    - $v'>0$, $v''<0$
- $x_1+x_2 = 1$, $y_1+y_2 = 1$ for all $x,y$
- Timing
    1. Player 1 proposes $x = (x_1, x_2)$
    2. Player 2 chooses accept or reject
    3. If player 2 rejects, player 2 proposes $y = (y_1, y_2)$
    4. Player 1 chooses accept or reject
    5. If player 1 rejects, player 1 proposes $x' = (x_1', x_2')$
    6. Player 2 chooses accept or reject
    7. …
- Utility for player 1
    1. $v_1(x_1)$ if accepted
    2. $δ_1\cdot v_1(y_1)$ if accepts player 2's proposal
    3. $δ_1^2\cdot v_1(x_1')$ if accepted
    4. …
- Utility for player 2
    1. $v_2(x_2)$ if accepts player 1's proposal
    2. $δ_2\cdot v_2(y_2)$ if accepted
    3. $δ_2^2\cdot v_2(x_2')$ if accepts player 1's proposal
    4. …
- Propositions of the equilibrium (OR 7.3.2)
    - Efficiency
    - Stationarity of strategies
    - First mover advantage
    - Comparative statics of impatience

![](/post-img/notes-game-theory--rubinstein.png)

> Lemma (OR Proposition 122.1)  
> There exists a unique pair $x_1^*, y_1^*\in [0, 1]$ that solves  
> $$\begin{cases}δ_1\cdot v_1(x_1) = v_1(y_1) \\ δ_2\cdot v_2(1-y_1) = v_2(1-x_1) \end{cases}$$
> which makes the players indifferent for every round by multiply both sides with $δ$'s

Since $δ_1 < 1$,  
$$\begin{aligned}δ_1\cdot v_1(x_1^*) &= v_1(y_1^*) \\
x_1^* > y_1^* \end{aligned}$$

1. Existence  
    From first equation, 
    $$\begin{aligned}δ_1\cdot v_1(x_1) &= v_1(y_1) \\
    v_1^{-1} \big(δ_1\cdot v_1(x_1)\big) &= v_1^{-1} \big( v_1(y_1)\big) \\
    y_1 &= v_1^{-1} \big(δ_1\cdot v_1(x_1)\big)\end{aligned}$$
    Plug into second equation,
    $$\begin{aligned}δ_2\cdot v_2(1-y_1) &= v_2(1-x_1) \\
    δ_2\cdot v_2\Big( 1 - v_1^{-1} \big(δ_1\cdot v_1(x_1)\big)\Big) &= v_2( 1 - x_1 ) \\
    δ_2\cdot v_2\Big( 1 - v_1^{-1} \big(δ_1\cdot v_1(x_1)\big)\Big) - v_2( 1 - x_1 ) &= 0 \\
    :&= f(x_1)\end{aligned}$$
    Plug in 0 and 1  
    $$\begin{aligned}f(0) &= δ_2\cdot v_2\Big( 1 - v_1^{-1} \big(δ_1\cdot v_1(0)\big)\Big) - v_2( 1 ) \\
    &= δ_2\cdot v_2\big( 1 - v_1^{-1} (0)\big) - 1 \\
    &= δ_2\cdot v_2( 1 - 0) - 1 \\
    &= δ_2 - 1 < 0\\
    f(1) &= δ_2\cdot v_2\Big( 1 - v_1^{-1} \big(δ_1\cdot v_1(1)\big)\Big) - v_2(0 ) \\
    &= δ_2\cdot v_2\big( 1 - \underbrace{v_1^{-1} (δ_1)}_{>0}\big) > 0\\\end{aligned}$$
    Therefore, by intermediate value theorem, exists $x_1^*\in [0, 1]$ s.t. $f(x_1^*) = 0$
2. Uniqueness  
:) $f(x_1)$ is increasing (omitted)

> Theorem (Rubinstein)  
> The Rubinstein bargaining game has an equilibrium in which player 1 always proposes $x_1^*$ and accepts any offer where he gets at least $y_1^*$,  
> and player 2 always proposes $y_2^*$ and accepts any division where he gets at least $x_2^*$.  
> Moreover, the equilibrium payoffs are the same in all SPNE.

0. Check continuous at infinity  
Consider two strategies $s_i, s_i'$ of player i  
that differs only after histories of length $T = 2k$  
$$\begin{aligned}&\phantom{\ggg}\big|u_i(s_i, s_{-i}) - u_i(s_i', s_{-i})\big| \\
&\leq |1\cdot δ_i^k - 0| \\
&= δ_i^k \end{aligned}$$
1. Check SPNE  
By one-step deviation principle,  
    a. When player 1 proposes,  
    If player 1 proposes any $x_1> x_1^*$, player 2 will reject and propose $y_1^*$ 
    $$\begin{aligned}δ_1\cdot v_1(x_1^*) &= v_1(y_1^*) \\
    v_1(x_1^*) &> v_1(y_1^*) \\
    &> δ_1\cdot v_1(y_1^*)\end{aligned}$$
    If player 1 propose any $x_1<x_1^*$, player 2 will accept, but player 1 is worse-off 
    $$\begin{aligned} v_1( x_1^*) > v_1(x_1) \end{aligned}$$
    b. When player 2 decides, equilibrium strategy is accepting $\iff 1-x_1\geq x_2^*$  
    If player 1 proposes $x_1$ then player 2 compares
    $$\begin{aligned}v_2(1-x_1) &<> δ_2\cdot v_2(y_2^*) \\
    &<> v_2(x_2^*) \end{aligned}$$
    c. When player 2 proposes,  
    If player 2 proposes any $y_2> y_2^*$, player 1 will reject and propose $x_1^*$ 
    $$\begin{aligned}δ_2\cdot v_2(y_1^*) > δ_2^2\cdot v_2(x_2^*)\end{aligned}$$
    If player 2 propose any $y_2< y_2^*$, player 1 will accept, but player 2 is worse-off 
    $$\begin{aligned}δ_2\cdot v_2( y_2^*) > δ_2^2\cdot v_2(y_2) \end{aligned}$$
    d. When player 1 decides, equilibrium strategy is accepting $\iff 1-y_2\geq y_1^*$  
    If player 2 proposes $y_2$ then player 1 compares
    $$\begin{aligned}δ_1 \cdot v_1(1-y_2) &<> δ_1^2\cdot v_1(x_1^*) \\
    v_1(1-y_2) &<> δ_1\cdot v_1(x_1^*) \\
    &<> v_1(y_1^*) \\
    1-y_2 &<> y_1^*\end{aligned}$$
2. Check uniqueness  
Assume $v_1(x) = v_2(x) = 1$  
Let $G_1$ be the original game where player 1 moves first,  
and $G_2$ be the same game where player 2 moves first.  
Let $M_i = \text{sup}\{ i$'s payoff in all SPNE's of $G_i\}$  
Let $m_i = \text{inf}\{ i$'s payoff in all SPNE's of $G_i\}$  
:) $m_1 = M_1$ and $m_2 = M_2$
    a. :) $M_1\leq 1 - δ_2\cdot m_2$  
    When player 2 decides, the game is $G_2$,  
    and he accept only when payoff is at least $δ_2\cdot m_2$  
    $\implies$ player 1 gets at most $1 - δ_2\cdot m_2$
    b. :) $M_2\leq 1 - δ_1\cdot m_1$  
    c. :) $m_1\geq 1-δ_2\cdot M_2$  
    When player 1 proposes, if the payoff is $x<1-δ_2\cdot M_2$,  
    she can be better-off by demending $x<x'< -δ_2\cdot M_2$  
    and still be accepted by player 2.
    d. :) $m_2\geq 1-δ_1\cdot M_1$  
    e. Summing up (a, b, c, d) gives
    $$\begin{aligned}M_1 + M_2 + 1-δ_2\cdot M_2 + 1-δ_1\cdot M_1 &\leq 1 - δ_2\cdot m_2 + 1 - δ_1\cdot m_1 + m_1 + m_2 \\
    (1-δ_1)\cdot M_1 + (1-δ_2)\cdot M_2 &\leq (1-δ_1)\cdot m_1 + (1-δ_2)\cdot m_2 \\
    (1-δ_1)(M_1-m_1) + (1-δ_2)(M_2 - m_2)&\leq 0 \end{aligned}$$
    Therefore, $m_1=M_1$, $m_2 = M_2$.

> Exercise (slideds P43)  
> Is the equilibrium Robinstein theorem proposes unique?

1. For player 2 
$$\begin{aligned}\text{Accept} && &v_2(1-x_1) \\
\text{Reject} && &δ_2 \cdot v_2(y_2^*) = v_2(1-x_1^*) \end{aligned}$$
$\implies$ Rejects if $x_1>x_1^*$ and accepts if $x_1\leq x_1^*$ 
2. For player 1  
Does not demand $x_1>x_1^*$ since player 2 will reject, and gets 
$$\begin{aligned}δ_1\cdot v_1(y_1^*) &= δ_1^2\cdot v_1(x_1^*) \\
&<v_1(x_1^*)\end{aligned}$$
Does not demand $x_1<x_1^*$ since then they are worse-off
3. So in SPNE, player 1 must demand $x_1^*$ and is accepted by player 2  
Therefore, the SPNE is unique

> Exercise (slides P50-51, OR 7.4.4)  
> Consider a model where impatience is not an issue; people don't care when they get the good as long as they get it.  
> But instead assume that each time player i rejects an offer, there is an exogenously given probability $1 - δ_i$ that the bargaining process breaks down and both players don't get anything.  
> Prove that nothing changes. 

1. For player 1,  
Does not demand $x_1<x_1^*$ since then they are worse-off  
Does player 1 want to demand $x_1>x_1^*$? 
$$\begin{aligned}\text{Propose }x_1^* && &v_1(x_1^*) \\
\text{Propose }x_1 && &\phantom{\ggg}(1-δ_2)\cdot 0 + δ_1\cdot v_1(y_1^*) \\
&& &= δ_2\cdot v_1(y_1^*) \\
&& &= δ_2\cdot d_1\cdot v_1(x_1^*) \\
&& &< v_1(x_1^*) \end{aligned}$$ 
$\implies$ player 1 does not demand $x_1>x_1^*$
2. For player 2,
$$\begin{aligned}\text{Accept} && &v_2(1-x_1) \\
\text{Reject} && &\phantom{\ggg}(1-δ_2)\cdot 0 + δ_2\cdot (1-y_1^*) \\
&& &= δ_2\cdot v_2(1-y_1^*) \\
&& &= v_2(1-x_1^*)\end{aligned}$$
$\implies$ player 2 accepts if $x_1\leq x_1^*$, rejects if $x_1>x_1^*$
3. Therefore, the results are the same in Theorem (Rubinstein)

> Exercise 1  
> In the Rubinstein bargaining game, imagine a modification of this game where player 1 after a rejection of player 2 is always allowed to make a second offer - only if this offer is rejected as well player 2 gets to make an offer.  
> In other words, if nobody accepts the sequence of players making an offer is: 1, 1, 2, 1, 1, 2, 1, 1, 2, 1, 1, etc.  
> 
> 1. Can you guess a strategy pair that is a SPNE of this game?
> 2. Use the 1-step deviation principle to show that the strategy pair you gave in (1) indeed is a SPNE.
> 3. Are the payoffs of player 1 in this game higher or lower than in the original Rubinstein game?  
> Do you have an intuition why this is the case?

1. $\big((x^*, y^*), z^*\big)$ that solves  
$$\begin{aligned}δ_1\cdot v_1(x_1) &= v_1(z_1) \\
δ_2^2\cdot v_2(1-z_1) &= δ_2\cdot v_2(1-y_1) = v_2(1-x_1) \end{aligned}$$
Equilibrium:  
P1 proposes $x^*$ in 1st round, proposes $y^*$ in second round, and accepts everything $\geq z_1^*$  
P2 always proposes $z^*$, accepts $\geq 1-x_1^*$ in P1's 1st round, and accepts $\geq 1-y_1^*$ in P1's 2nd round
2. By one-step deviation principle,
    a. When P1 proposes $x_1>x_1^*$ in their 1st round, P2 rejects  
    therefore, P1 proposes $y_1^*$ in their 2nd round  
    Since $δ_2<1$, 
    $$\begin{aligned}δ_2\cdot v_2(1-y_1^*) &= v_2(1-x_1^*) \\
    v_2(1-y_1^*) &> v_2(1-x_1^*) \\
    1-y_1^* &> 1-x_1^* \\
    y_1^* &< x_1^* \\
    v_1(y_1^*) &< v_1(x_1^*) \\
    δ_1\cdot v_1(y_1^*) &< v_1(x_1^*)\end{aligned}$$
    When P1 proposes $y_1>y_1^*$ in their 2nd round, P2 rejects and proposes $z_1^*$ s.t.
    $$\begin{aligned} δ_2^2\cdot v_2(1-z_1^*) &= δ_2\cdot v_2(1-y_1^*) \\
    v_2(1-z_1^*) &> v_2(1-y_1^*) \\
    1-z_1^* &> 1-y_1^* \\
    z_1^* &< y_1^* \\
    v_1(z_1^*) &< v_1(y_1^*) \\
    δ_1\cdot v_1(z_1^*) &< v_1(y_1^*)\end{aligned}$$
    b. When P2 decides in P1's 1st round, P2 compares  
    $$\begin{aligned}v_2(1-x_1) &<> δ_2\cdot v_2(1-y_1^*) \\
    &<> v_2(1-x_1^*) \end{aligned}$$
    therefore accepts anything $\geq 1-x_1^*$  
    When P2 decides in P1's 2nd round, P2 compares  
    $$\begin{aligned}v_2(1-y_1) &<> δ_2\cdot v_2(1-z_1^*) \\
    &<> v_2(1-y_1^*) \end{aligned}$$
    therefore accepts anything $\geq 1-y_1^*$
    c. When P2 proposes $z_1 < z_1^*$, P1 rejects and proposes $x_1^*$ s.t.
    $$\begin{aligned}v_2(1-x_1^*) &= δ_2^2\cdot v_2(1-z_1^*) \\
    v_2(1-x_1^*) &< v_2(1-z_1^*) \end{aligned}$$
    d. When P1 decides, P1 compares
    $$\begin{aligned}v_1(z_1) &<> δ_1\cdot v_1(x_1^*) \\
    &<> v_1(z_1^*) \end{aligned}$$
    therefore accepts anything $\geq z_1^*$
3. Rewrite the system as
$$\begin{aligned}δ_1\cdot v_1(x_1) &= v_1(z_1) \\
δ_2^2\cdot v_2(1-z_1) &= v_2(1-x_1) \end{aligned}$$
Therefore, compared to the original Rubinstein game,  
the discounting factor for P2 decreases, and stays the same for P1  
Since players with more patience receive more payoff, P1 is better-off and P2 is worse-off

### Rubinstein Game (Small Time Interval)

- Let $δ_i = δ_i(ΔT) = e^{-r_i\cdot ΔT}$, $δ_i^t(ΔT) = (e^{-r_i\cdot ΔT})^t = e^{-r_i\cdot T}$  
The system in lemma (OR Proposition 122.1) 
$$\begin{cases}δ_1\cdot v_1(x_1) = v_1(y_1) \\ δ_2\cdot v_2(1-y_1) = v_2(1-x_1)\end{cases}$$
becomes
$$\begin{cases}e^{-r_1\cdot ΔT}\cdot v_1(x_1) = v_1(y_1) \\ e^{-r_2\cdot ΔT}\cdot v_2(1-y_1) = v_2(1-x_1)\end{cases}\\
e^{ΔT} = \Big(\frac{v_1(y_1^*)}{v_1(x_1^*)}\Big)^{-\frac{1}{r_1}} \\
\phantom{e^{ΔT}} = \Big(\frac{v_2(y_2^*)}{v_2(x_2^*)}\Big)^{-\frac{1}{r_2}}$$
Let $ΔT\to 0$, $e^{ΔT}\to 0$, $δ_i(ΔT)\to 1$,  
$$\begin{aligned} v_1(y_1^*) &= v_1(x_1^*)\\
v_2(y_2^*) &= v_2(x_2^*)\end{aligned}$$
Therefore, the first mover advantage vanishes

## Nash Bargaining Problem

OR Ch15

- Bargaining problem: $\langle X, d\rangle\in B$
    - Set of all Nash bargaining problems: $B$
    - Set of players: $k = 2$
    - Set of payoff profiles: $X\subset \mathbb{R}^k$
    - Default payoff profile: $d\in X$
- Assumptions
    - $X$ is convex, closed, bounded above
    - If $x\in X$, then $x'\in X$ for all $x'\leq x$
- Bargaining solution: $F:B\to\mathbb{R}^k$
    - Payoff of each player
    - $F(X,d)\in X$
- Bargaining solution: $F: B\to \mathbb{R}^k$  
    - $F\big(\langle X, d\rangle\big)\in X$ for all $\langle X, d\rangle\in B$

> Example (ultimatum game)  
> $\langle X, d\rangle\in B$  
> $d = \big(v_1(0), v_2(0)\big)$  
> $X = \{(u_1,u_2)\in\mathbb{R}^2 : \exists x_1\in[0,1]$ s.t. $u_1\leq v_1(x_1)$ and $u_2\leq v_2(1-x_1)\}$

### Nash Axioms

1. Scale covariance (Invariant to Affine transformation)  
For $τ_k:\mathbb{R}\to\mathbb{R}$, $A_k>0$, $τ_k = A_k\cdot u + B_k$,  
for $τ:\mathbb{R}^k\to\mathbb{R}^k$, $τ(x) =\big(τ_1(x_1), τ_2(x_2), \dots, τ_k(x_k)\big)$,  
$\implies F\big(τ(X), τ(d)\big) = τ\big(F(X,d)\big)$
2. Pareto efficiency: For all $y\gg F(X,d)\implies y\not\in X$  
Individual rationality: $F(X,d)\geq d$
3. IIA (Independence of irrelevant alternatives)  
For $(X,d),(Y,d)\in B$, $Y\subset X$,  
$F(X,d)\in Y\implies F(X,d) = F(Y,d)$
4. Symmetry  
For $ρ:\mathbb{R}^k\to\mathbb{R}^k$, $ρ(x_1, x_2) = (x_2, x_1)$  
$\implies F\big(ρ(X), ρ(d)\big) = ρ\big(F(X,d)\big)$

### Nash Bargaining Solution (NBS)

- Generalized (asymmetric) NBS (definition 1)  
For $F:B\to\mathbb{R}^k$, exists $α,β\in[ 0,1]$, $α+β = 1$ s.t. $F(X,d)$ solves 
$$\begin{aligned}\max_{x\in X, x\geq d} && (x_1 - d_1)^α\cdot(x_2 - d_2)^β \end{aligned}$$
    - Holds for $α' =\frac{α}{α+β}$ and $β'=\frac{β}{α+β}$
    - Symmetric NBS: $α = β = \frac{1}{2}$
    - $F(X,d)\in X$ satisfies axioms 1-3 $\iff$ generalized NBS
    - $F(X,d)\in X$ satisfies axioms 1-4 $\iff$ symmetric NBS
- $F:B\to\mathbb{R}^k$ is an NBS if either (definition 2)
    1. Exists some player $i$ s.t. $F(X,d)$ always maximizes their payoff, or
    2. Exists $α,β\in[ 0,1]$, $α+β = 1$ s.t. $F(X,d)$ is on the boundary of $X$,  
    and
    $$\begin{aligned}r_s &= (\hat{x}_1,d_2)\\
    t_s &= (d_1,\hat{x}_2) \\
    s &= α\cdot r_s + β\cdot t_s \\
    &= (α\hat{x}_1 + βd_1, \ αd_2 + β\hat{x}_2) \\
    &= F(X,d)\end{aligned}$$

![](/post-img/notes-game-theory--nbs.png){width=537px}

> Lemma  
> Definitions 1 and 2 are equivalent

:) $s = α\cdot r_s + β\cdot t_s$ $\in\text{argmax}\ (x_1 - d_1)^α\cdot(x_2 - d_2)^β$  
$\Longleftarrow s\in\text{argmax}\ γ\cdot r_s + (1-γ）\cdot t_s$ for all $\hat{x}_1, \hat{x}_2$, $γ\in[0,1]$  
$$\begin{aligned}\max_γ && &\phantom{\ggg}γ\cdot r_s + (1-γ）\cdot t_s \\
&& &= \big(γ\cdot\hat{x}_1 + (1-γ)\cdot d_1, \ γ\cdot d_2 + (1-γ)\cdot\hat{x}_2\big) \\ \end{aligned}$$
Plug in $x = γ\cdot r_s + (1-γ）\cdot t_s$
$$\begin{aligned}\max_{x(γ)} && &\phantom{\ggg}(x_1 - d_1)^α\cdot(x_2 - d_2)^β \\
&& &= \big(γ\cdot\hat{x}_1 + (1-γ)\cdot d_1 - d_1\big)^α\cdot \big(γ\cdot d_2 + (1-γ)\cdot\hat{x}_2- d_2\big)^β \\
&& &= \big(γ\cdot\hat{x}_1 -γ\cdot d_1 \big)^α\cdot\big((γ-1)\cdot d_2 + (1-γ)\cdot\hat{x}_2\big)^β\\
&& &= γ^α\cdot (\hat{x}_1 - d_1)^α\cdot(1 - γ)^β\cdot (\hat{x}_2 - d_2)^β \end{aligned}$$
Therefore, it is sufficient to maximize
$$\begin{aligned}\max_γ && &\phantom{\ggg}γ^α\cdot (1 - γ)^β \\
\implies\max_γ&& &\phantom{\ggg}\ln \big( γ^α\cdot (1 - γ)^β \big) \\
&& &= α\cdot\ln γ + β\cdot\ln (1 - γ) \\
FOC && &\frac{α}{γ} - \frac{β}{1 - γ} = 0 \\
&& &\phantom{0000\ggg}\frac{α}{γ} = \frac{β}{1 - γ} \end{aligned}$$
Let $α = γ$ and $β = 1-γ$, (also holds for $γ = \frac{α}{α+β}$, $1-γ=\frac{β}{α+β}$)  
$(x_1 - d_1)^α\cdot(x_2 - d_2)^β$ is maximized at $s = α\cdot r_s + β\cdot t_s$.

> Prove:  
> $F(X,d)\in X$ satisfies axioms 1-3 $\iff$ it is a generalized NBS

slides P65, OR P307

> Exercise (slides P61)  
> Check that the NBS in Definition 2 is well defined,  
> i.e. that for any problem (X, d) and $α,β>0$ with $α+β = 1$,  
> there is a point on the boundary of $X$ that satisfies the conditions.

### eg) Cournot vs Collusion

- Profit function: $π_i(q_i, q_{-i}) = (K - q_i - q_{-i})\cdot q_i - c_i\cdot q_i$
    - $K>2 c_i$ for all $i$
- Cournot problem
$$\begin{aligned}\max_{q_i} && π_i(q_i, q_{-i}) = (K - q_i - q_{-i})\cdot q_i - c_i\cdot q_i \end{aligned}$$
    - NE: $q_i = \frac{1}{3}\cdot(K - 2c_i + c_{-i})$
    - Profit: $π_i = \frac{1}{9}\cdot(K - 2c_i + c_{-i})^2$
    - Disagreement payoff: 
    $$\begin{aligned}d_1 &= \frac{1}{9}\cdot(K - 2c_1 + c_2)^2 \\
    d_2 &= \frac{1}{9}\cdot(K - 2c_2 + c_1)^2 \end{aligned}$$
- No transfer
    - Agreement payoff:
    $$X = \{(u_1, u_2)\ |\ \text{Exists } q_1,q_2 \text{ s.t. }u_1\leq π_1(q_1,q_2), u_2\leq π_2(q_1,q_2)\}$$
    - Symmetric NBS: solving
    $$\begin{aligned}\max_{u_1,u_2} && &(u_1 - d_1)\cdot (u_2 - d_2) \\
    \iff\max_{q_1, q_2} && &\big(π_1(q_1,q_2) - d_1\big)\cdot\big(π_2(q_1,q_2) - d_2 \big) \\
    \text{s.t.} && &π_1(q_1,q_2)\geq d_1 \\
    && &π_2(q_1,q_2) \geq d_2\end{aligned}$$
- With transfer: monopoly
    - Assume $c_1< c_2$
    - Let firm 1 produce $q_1 = q$, firm 2 receives payment from firm 1
    - Monopolist's problem:
    $$\begin{aligned}\max_q && &(K-q)\cdot q - c_1\cdot q\\
    FOC && &q^* = \frac{K-c_1}{2}\end{aligned}$$
    - Monopolist profit: $π(q^*) = \frac{1}{4}\cdot(K-c_1)^2$
    - Agreement payoff:
    $$X = \{(u_1, u_2)\ |\ u_1+u_2 \leq\frac{1}{4}\cdot(K-c_1)^2\}$$
    - Symmetric NBS: solving
    $$\begin{aligned}\max_{u_1,u_2} && &\phantom{\ggg}(u_1 - d_1)\cdot (u_2 - d_2) \\
    && &= (u_1 - d_1)\cdot\Big[\Big(\frac{1}{4}\cdot(K-c_1)^2 - u_1\Big)\cdot d_2\Big] \\
    \text{s.t.} && &u_1\geq d_1 \\
    && &u_2 \geq d_2\end{aligned}$$
    gives
    $$\begin{aligned}u_1^* &= \frac{1}{2}\cdot\Big(\frac{1}{4}\cdot(K-c_1)^2-d_2+d_1 \Big)\\
    u_2^* &= \frac{1}{2}\cdot\Big(\frac{1}{4}\cdot(K-c_1)^2+d_2-d_1 \Big)\end{aligned}$$

> Exercise 2  
> There are two firms called 1 and 2 engaged in Bertrand competition.  
> If firms charge different prices, then the profits of the firm charging the higher price are 0, and the profits of the firm i charging the lower price are 
> $$π_i = (A - p_i)(p_i - c_i)$$
> If both firms charge the same price, we will assure that firm 1 captures the entire demand
> $$π_1 = (A - p_1)(p_1 - c_1)$$
> and firm 2 gets profits equal to 0.  
> Assume $c_1 = 1$, $c_2 = 2$, $A>0$ big enough.
> 
> 1. Find a pure strategy NE if both firms choose prices simultaneously.
> 2. Can you use the concepts we discussed in class to make some predictions about the case where firms are able to collude and can transfer money between each other?

1. NE: $p_1 = p_2 = c_2$  
Firm 1 does not deviate: increasing price loses market, decreasing price undercuts profit  
Firm 2 does not deviate: increasing price loses market, decreasing price gives negative profit  
Another NE: $c_1 < p_1 = p_2 < c_2$
2. Since $c_1 < c_2$, let firm 1 produce $A - p$  
Firm 1's problem:
$$\begin{aligned}\max_p && (A - p)(p - 1)& \\
FOC && A - 2p + 1 &\overset{!}{=} 0 \\
&& p &= \frac{A+1}{2} \end{aligned}$$
Total profit:
$$\begin{aligned}&\phantom{\ggg}(A - p)(p - 1) \\
&= \big(A - \frac{A+1}{2}\big)\big(\frac{A+1}{2} - 1\big) \\
&= \frac{2A - A -1}{2}\cdot\frac{A+1 - 2}{2} \\
&= \frac{1}{4}(A-1)^2\end{aligned}$$
Disagreement payoff is $π_1 = (A - 2)(2 - 1) = A-2$, $π_2 = 0$  
therefore, NBS yields 
$$\begin{aligned}\max_{u_1,u_2} && &(u_1 - A+2)(u_2 - 0) \\
s.t. && &u_1 + u_2 \leq \frac{1}{4}(A-1)^2 \end{aligned}$$
plug in 
$$\begin{aligned}\max_{u_1} && &\phantom{\ggg}\big(u_1 - (A - 2)\big)\cdot\big(\frac{1}{4}(A-1)^2 - u_1\big) \\
&& &= \frac{1}{4}(A-1)^2u_1 + (A - 2)u_1 - u_1^2 - (A-2)\cdot \frac{1}{4}(A-1)^2 \\
FOC && \frac{\partial}{\partial u_1} &=\frac{1}{4}(A-1)^2 + (A - 2) - 2u_1 \overset{!}{=} 0 \\
&& u_1^* &= \frac{1}{8}(A-1)^2 + \frac{1}{2}(A-2)\\
&& u_2^* &= \frac{1}{8}(A-1)^2 - \frac{1}{2}(A-2)\end{aligned}$$

### Kalai-Smorodinsky BS

- Disagreement payoff: $d\in Y\subset X$
- Axioms
    - Nash 1, 2, 4 (~~IIA~~)
    - Kalai-Smorodinsky: 
    $$\begin{cases}\bar{u}_1 = \max_{(x,d_2)\in X} \ x  \\ \bar{u}_2 = \max_{(d_1,x)\in X} \ x \end{cases}$$
    therefore, both players are better-off from more choice:
    $$\begin{aligned}F_1(X, d) &\geq F_1(Y, d) \\
    F_2(X,d) &\geq F_2(Y,d)\end{aligned}$$
- K-S BS: $K(X,d)$ 
    - Unique
    - Axioms Nash 1, 2, 4 and Kalai-Smorodinsky are satisfied

![](/post-img/notes-game-theory--ksbs.png){width=523px}

## Coalitional Game

### General Case (No Transfer)

- Game: $\big(N, V, X, (\succsim_i)_{i\in N}\big)$
- Coalitions
    - Set of players: $N$
    - Set of coalition: $S\subset N$, $S\neq\emptyset$
- Outcomes
    - Set of outcomes: $X$
    - Set of coalition outcomes: $V(S)\subset X$
- Preference relation: $\succsim_i$ defined on $X$
- Core
    - No transfer: $\big\{x\in V(N)\big\}$ s.t. no blocking coalitions exist
    - Blocking coalition: $S$ s.t. exists $y\in V(S)$, $y\succ_i x$ for all $i\in S$

### Analogy with [Walreasian Equilibrium](../../01/notes-micro/#general-equilibrium-exchange)

- Exchange economy
    - Set of consumers: $N$ 
    - Number of commodities: $l$
    - Individual endowment vector: $ω_n\in [0,\infty^l)$ s.t. $\sum_N ω_n \gg 0$
    - Utility function: $u_n: [0,\infty^l)\to \mathbb{R}$  
    non-decreasing, continuous, concave
- Allocation: $x_n\in [0,\infty^l)$ s.t. $\sum_N x_n = \sum_N ω_n$
    - Competitive allocation: $(x^*, p^*)$  
    s.t. $p^*\cdot x^*\leq p^*\cdot ω_n$  
    and $x^*\in\text{argmax} \ u_n(x_n)$ for all $n\in N$
- Coalitional game 
    1. Let $X$ be the set of all allocations,  
    2. $V(S) = \{ x\in X: \sum_S x_i = \sum_S ω_i$, and $x_i = ω_i$ for $i\in N\backslash S\}$  
    3. $x\succsim_i y\iff u_i(x)\geq u_i(y)$

> Exercise (slides P84)  
> Consider an exchange economy with two agents and two goods.  
> Utilities of both agents are $u_i(x^A,x^B) = x^A_i\cdot x^B_i$, $x^A_i$ and $x^B_i$ are the amount of good A and B consurned by agent i.  
> Assume agent 1 has 10 units of good A and 90 of good B and agent 2 has 90 units of good A and 10 of good B.  
> Calculate the core allocations for this economy.  
> Calculate the Walreasian equilibria for this econorny.

### With Transfer

OR 13.1

- Game: $\big(N, v, X, (\succsim_i)_{i\in N}\big)$
- Coalitions
    - Set of players: $N$
    - Set of coalition: $S\subset N$, $S\neq\emptyset$
- Outcomes
    - Set of outcomes: $X = \mathbb{R}^{|N|}$
    - Set of coalition outcomes: $V(S)\subset X$
    - Value function: $v: S\to\mathbb{R}_+$ 
    $$V(S) = \{ x\in X: \sum_S x_i = v(S)\}$$
- Preference relation: $x \succsim_i x\iff x_i > y_i$
- Core
    - With transfer: $\big\{x(S)\geq v(S)\big\}$ for every $S$

### eg) Exchange Economy

- Set of players: $N =\{c; 1, 2,\dots, w\}$
    - $|N|= w+1$
    - Capitalist: $c$
    - Workers: $\{1, 2,\dots, w\}$
- $v(S) = \begin{cases}f\big(|S|-1\big) & c\in S \\ 0 & c\not\in S \end{cases}$
    - $f(0) = 0$
    - $f'>0$, $f''\leq 0$

> Exercise (slides P90)  
> Show that the core of the production economy is 
> $$\Big\{ x\in X: 0\leq x_i\leq f(w) - f(w-1) , \ i\neq c, x_c = f(w) - \textstyle{\sum}_{i\neq c}x_i\Big\}$$

We know $v(S) = \begin{cases}f\big(|S|-1\big) & c\in S \\ 0 & c\not\in S \end{cases}$  
$\implies v(N) =\sum_i x_i = f(w)$  
<!-- 
$$\begin{aligned}\sum_S x_i &= f(w) - x_j \\
&\geq f(w) - \big( f(w) - f(w-1)\big) \\
&= f(w-1) \end{aligned}$$ -->
:) Check $\sum_S x_i\geq v(S)$ for all $s$  

1. If $c\not\subset S$, $\sum_S x_i\geq 0$
2. If $c\in S$  
Let $S = N - S'$, $c\not\in S'$, $v(S) = f(S-1)$  
Since $x_i\leq f(w) - f(w-1)$ for all $i\neq c$, 
$$\begin{aligned}\sum_S x_i &= f(w) - \sum_{S'} x_j \\
&\geq f(w) - |N-S|\cdot\big( f(w) - f(w-1)\big) \\
&= \underbrace{\big( f(w) - f(w-1)\big) + \big( f(w-1) - f(w-2) + \dots + \big( f(|S|) - f(|S|-1)\big)\big)}_{|N-S|\text{ terms}} \\
&\phantom{\ggg} -|N-S|\cdot\big( f(w) - f(w-1)\big) + f(|S|-1) \\
&\geq f(|S|-1) = v(S)\end{aligned}$$

<!-- 
&= f(|S|-1) + \big(1 - \underbrace{|N-S|}_{\geq 1}\big)\big( f(w) - f(w-1)\big) \\
&\phantom{\ggg}+ \big( f(w-1) - f(w-2)\big) + \dots + \big( f(|S|) - f(|S|-1)\big) \\
&= f(|S|-1) - \big(|N-S| - 1 \big)\big( f(w) - f(w-1)\big) + f(w-1) - f(|S|-1) \\
&= f(w-1) - \big(|N-S| - 1 \big)\cdot f(w) + \big(|N-S| - 1 \big)\cdot f(w-1) \\
&= |N-S|\cdot f(w-1) - \big(|N-S| - 1 \big)\cdot f(w)\\
&= f(w) + |N-S|\cdot f(w-1) - |N-S|\cdot f(w)\\
&= f(w) + |N-S|\cdot\big(f(w-1) - f(w)\big)
 -->

### Non-Emptiness of Core

OR 13.3

- Weight of coalition
    - Set of all coalitions in a game: $\mathcal{C}$
    - Collection of weights: for all $S\in\mathcal{C}$, $S\neq\emptyset$,
    $$\begin{aligned}(λ_S)_{S\in\mathcal{C}} &= (λ_{S_1}, λ_{S_2}\dots, λ_{S_k})\\
    λ_S &\in[0,1] \end{aligned}$$
    - Balanced collection of weights: for every $i$,
    $$\sum_{S_k\ni i}^{S_k\in\mathcal{C}} λ_{S_k} = 1 $$
- Balanced game: for every balanced $(λ_S)$, 
$$\sum_{S\in\mathcal{C}} λ_S\cdot v(S) \leq v(N)$$
- Bondareve-Shapley theorem (OR proposition 262.1)  
A coalitional game with transferable payoffs has a non-empty core  
$\iff$ it is balanced  

<!-- 
> Bondareve-Shapley theorem (OR proposition 262.1)  
> a coalitional game with transferable payoffs has a non-empty core  
> $\iff$ it is balanced  
> $\implies$ a coalitional game with transferable payoffs has empty core  
> $\iff$ it is not balanced  

1. ($\Longrightarrow$)  
Assume $x$ is in core, $v(N)>0$  
Let $y = \Big( \frac{x_1}{v(N)}, \frac{x_2}{v(N)}, \dots, \frac{x_n}{v(N)}\big)$  
Note that $\sum_i y_i = 1$  
$x\in$ core $\iff$ for all $S$, 
$$\begin{aligned}\sum_{i\in S} x_i &\geq v(S) \\
\sum_{i\in S} y_i \cdot v(N)&\geq v(S) \end{aligned}$$
Let $(λ_S)$ be a balanced collection of weights, $\sum_i λ_S = 1$  
For all $S$,  
$$\begin{aligned}v(S) &\leq \sum_{i\in S} y_i \cdot v(N)\\
\sum_S λ_S\cdot v(S) &\leq \sum_S\big(λ_S\cdot\sum_{i\in S} y_i \cdot v(N)\big) \\
&= v(N)\cdot\sum_S\sum_{i\in S} λ_S\cdot y_i \\
&= v(N)\cdot \sum_i \big(y_i\cdot\sum_{i\in S} λ_S\big) \\
&= v(N)\cdot \sum_i y_i\cdot 1 \\
&= v(N)\end{aligned}$$
2. ($\Longleftarrow$)  
Note: $x\in C(v)\iff \sum_{i\in S} x_i\geq v(S)$ for all S  
Note: Separating hyperplane theorem  
    a.
    Define $w_S\in\mathbb{R}^{|N|+1}$ as $w_S = \big(1_S, v(S)\big)$  
    where $1_S\in\mathbb{R}^{|N|}$, $1_{S,i}=\begin{cases}1 & i\in S \\ 0 & i\not\in S\end{cases}$  
    Since 
    $$\begin{aligned}(x,-1)\cdot w_S &\geq 0 \\
    \iff \sum_{i\in S}x_i - 1\cdot v(S) &\geq 0 \\
    \iff \sum_{i\in S} x_i &\geq v(S) \end{aligned}$$
    Therefore,
    $$\begin{aligned}(x,-1)\cdot w_S &\geq 0 &&\text{for all }S \\
    \iff x &\in C(v) \end{aligned}$$
    Let 
    $$\begin{aligned}A &= \{(1_N, \ v(N) + ε): ε>0 \} \\
    B &= \{ y\in\mathbb{R}^{|N|+1} : y= \textstyle{\sum_S}\, λ_S\cdot w_S, λ_S\geq 0\}\end{aligned}$$
    b. Show $A\cap B =\emptyset$  
    Assume exists $(1_N, v(N)+ε)\in B$ for some $ε>0$  
    $\implies (1_N, v(N)+ε) = \sum_S\, λ_S\cdot w_S$ for some $λ_S\geq 0$  
    Therefore, $1 = \sum_{S:i\in S}\, λ_S$ for all $i\in [1, |N|]$  
    and $v(N)+ε = \sum_{S}\, λ_S\cdot v(S)$  
    Since $λ_S$ is balanced, $\sum_S λ_S\cdot v(S) \leq v(N)$, contradiction
    c. By separating hyperplane theorem,  
    exists $v\neq 0$ s.t. $v\cdot b\geq v\cdot a$ for all $b\in B$ and $a\in A$  
    Define $α_N$ s.t. $v =(α_Ν, α)$  
    FSOC assume exists $b\in B$ s.t. $v\cdot b <0$,  
    Since $B$ is a cone, $v\cdot\underbrace{K\cdot b}_{\in B}$ can be arbitrarily small, contradiction  
    $\implies\min_{b\in B}\ v\cdot b = 0$  
    $\implies v\cdot b\geq 0\geq v\cdot a$  
    Since 
    $$\begin{aligned} (α_Ν, α)\cdot \big(1_N, v(N)\big) &\geq (α_Ν, α)\cdot \big(1_N, v(N)+ ε\big) \\
    0&\geq (α_Ν, α)\cdot (0,0,\dots,0,ε) \\
    &\geq ε\cdot α\end{aligned}$$
    $\implies α\leq 0$  
    FSOC assume $α_{N,i}<0$ for some i,  
    $\implies$
    $$\begin{aligned}(α_N, α)\cdot w_{S=\{i\}} &= (α_N, α)\cdot (0, 0,\dots, \underbrace{1}_{\text{i-th}}, \dots,0) \\
    &= α_{N,i} + α\cdot v(S=\{i\}) < 0\end{aligned}$$
    But $w_{S=\{i\}}\in B$, contradiction
    $\implies α_N\geq 0$  
    FSOC assume $α=0$,  
    $$\begin{aligned}(α_N, α)\cdot \big(w_N + (0,\dots,0,ε)\big) &= \sum_i (α_N)_i \\
    &> 0 \end{aligned}$$
    contradiction  
    $\implies α< 0$  
    Let $x=\frac{α_N}{-α}$, for all $a\in A$ and $b\in B$, 
    $$\begin{aligned}(x, -1 )\cdot b &\geq 0 \geq (x,-1)\cdot a\\
    \frac{α_N + α}{-α}\cdot b &\geq 0 \\
    (α_N + α) \cdot b &\geq 0 \end{aligned}$$
    d. Check $x$ is an allocation  
    Since $x\geq 0$,  
    $$\begin{aligned}0 &\geq (x,-1)\cdot \big(1,\dots, 1,v(N)+ε\big) \\
    &= \sum_i x_i - v(N) - ε \\
    0 &\geq (x,-1)\cdot \big(1,\dots, 1,v(N)\big) \\
    &= \sum_i x_i - v(N) \\
    v(N) &\geq \sum_i x_i \end{aligned}$$
 -->

### eg) Majority Game

- Set of players: $N =\{B, S1, S2\}$
    - Big party: $B$, 90 seats
    - Small parties: $S1, S2$, 10 seats each
- $v(S) = \begin{cases}1 & B\in S \\ 0 & B\not\in S \end{cases}$
- Core: $\{1, 0, 0\}$

> Exercise (slides P91)  
> Now imaagine party B is still the biggest party but controls only 35 seats and each of other 5 parties has 13 seats.  
> $v(S) = 1$ if $S$ contains either the big party and 2 small ones or 4 small parties, $v(S) = 0$ otherwise.  
> Is the core empty?

Let $N = \{B, S1, S2, S3, S4, S5\}$  

1. Find balanced weights  
For B, 
$$\begin{aligned}\sum_{i\in S} λ_S &= 5\cdot 4\cdot λ_{(B,Si,Sj)} = 1 \\
λ_{(B,Si,Sj)} &= \frac{1}{20}\end{aligned}$$
For Si, 
$$\begin{aligned}\sum_{i\in S} λ_S &= 4\cdot λ_{(B,Si,Sj)} + 4\cdot λ_{(B,Sj,Si)} + λ_{(S1, S2, S3, S4, S5)} = 1 \\
&= 8\cdot \frac{1}{20} + λ_{(S1, S2, S3, S4, S5)} \\
λ_{(S1, S2, S3, S4, S5)} &= \frac{12}{20} = \frac{3}{5} \end{aligned}$$
2. Check if game is balanced  
$$\begin{aligned} \sum_S λ_S\cdot v(S) &= 5\cdot 4\cdot λ_{(B,Si,Sj)}\cdot 1 + \frac{3}{5}\cdot 1 \\
&= 1 + \frac{3}{5} \\
&> v(N) = 1\end{aligned}$$
therefore, the game is unbalanced, and the core is empty

> Exercise (slides P95)  
> An expedition of $n$ pirates has found a huge number of treasure chests.  
> Each pair can carry one chest.  
> A coalitional game modeling this situation is given by 
> $$v(S) = \begin{cases}\frac{|S|}{2} & |S| \text{ is even} \\\frac{|S|-1}{2} & |S| \text{ is odd} \end{cases}$$
> Assume $n\geq 4$.  
> Show that if $n$ is even, then the core consists of a single payoff profile $\big( \frac{1}{2},\frac{1}{2},\dots, \frac{1}{2})$, and if $n$ is odd, the core is empty.

Let $n=5$, $v(N) = 2$,  
$λ_{(1,2)} = λ_{(2,3)} =λ_{(1,3)} =\frac{1}{2}$, $λ_{(4,5)} = 1$, $λ_S = 0$ otherwise.  

1. Check weights are balanced  
For 1, $\sum_{i\in S} λ_S = λ_{(1,2)} + λ_{(1,3)} = 1$  
For 2, $\sum_{i\in S} λ_S = λ_{(1,2)} + λ_{(2,3)} = 1$  
For 3, $\sum_{i\in S} λ_S = λ_{(1,3)} + λ_{(2,3)} = 1$  
For 4 and 5, $\sum_{i\in S} λ_S = λ_{(4,5)} = 1$  
2. Check the game is balanced
$$\begin{aligned} \sum_S λ_S\cdot v(S) &= λ_{(1,2)}\cdot 1 + λ_{(2,3)}\cdot 1 + λ_{(1,3)}\cdot 1 + λ_{(4,5)}\cdot 1 \\
&= \frac{1}{2} + \frac{1}{2} + \frac{1}{2} + 1 \\
&= \frac{5}{2} \\
&> v(N) = 2\end{aligned}$$
Therefore, the game is not balanced  
$\implies$ the core is empty

> Exercise 7  
> Consider a Parliament with the following distribution of seats:  
> CDU: 33, SPD: 20, Greens: 20, Linke: 15, FDP: 12  
> Imagine that the parties have to decide by simple majority how to divide 10 billion Euros among 5 special interest groups.  
> Imagine moreover, that each party supports a different special interest group and is only interested in how much money that interest group gets.
> 
> 1. Model the above situation as a coalitional game with transferable payoffs.
> 2. What does the Bondavera-Shapley Theorem say? What is a balanced game?
> 3. Is the core of the above game non-empty?  
> If so, what can you say about the core allocations? If not, prove that it is empty.

1. $v(S) = \begin{cases}1 & |S|\geq 80 \\ 0 & \text{Otherwise}\end{cases}$  
2. Bondavera-Shapley Theorem: a coalitional game with transferable payoffs has a non-empty core  
Balanced game: for every balanced collection of weights $(λ_S)$, $\sum_S λ_S\cdot v(S) \leq v(N)$
3. Since a simple majority is formed when four-party-coalition is formed,  
Let $λ_{-F} = λ_{-L} = λ_{-G} = λ_{-S} = λ_{-C} = \frac{1}{4}$  
$λ_s = 0$ for all other $s$  
$$\begin{aligned}\sum_s λ_s\cdot v(s) &= 5\cdot \frac{1}{4}\cdot 1 \\
&= \frac{5}{4} > 1 = v(N)\end{aligned}$$
Therefore, the game is not balanced, and the core is empty

### Shapley Value 

OR 14.4 <!-- 20190714-1904 now here -->

- Value function 
$$φ(v) = \big(φ_1(v), \dots, φ_{|N|}(v)\big)\in\mathbb{R}^{|N|}$$
    - Game: $(N, v)$
    - Coalition: $S$
    - Assigns __unique + feasible__ payoff profile to every coalition game w/ transfer
- Shapley value  
$$ψ_i(v) = \frac{1}{|N|!}\sum_{γ\in Γ} v^i\big(S_i(γ)\big)$$
    - $\iff$ Average marginal contribution
    - Marginal contribution: $v^i(S) = v(S\cup\{i\}) - v(S)$
    - Ordering of players: $γ: N\to N$, $Γ = (γ_1, \dots, γ_{|N|})$, $|Γ|= |N|!$
    - Coalition before i joins: $S_i(γ)$
- Axioms
    1. Efficiency / Feasibility: $\sum_{i\in N} ψ_i(v) = v(N)$
    2. Symmetry: let $π: N\to N$, $w(S) = v\big(π(S)\big)$ $\implies$ $ψ^i(w) = ψ^{π(i)}(v)$
    3. Dummy: $v^i(S) = 0$ $\implies$ $ψ_i(v) = 0$
    4. Additivity: for $v$ and $w$ with same players, $ψ_i(v+w) = ψ_i(v) + ψ_i(w)$
- OR Proposition 291.3:  
Shapley value is the unique value function s.t. axioms 1-4 are satisfied
- Young (1985) Axioms
    1. Efficiency
    2. Symmetry
    3. Marginal contribution: if $v^i(S) = w^i(S)$ for all $S$ not containing $i$, then $ψ_i(v) = ψ_i(w)$
- Theorem (Young):  
Shapley value is the unique function $ψ(v)$ s.t. Young axioms 1-3 are satisfied

<!-- 
> Lemma  
> For any game $v$ with $N$ can be written as  
> $$v = \sum_{T\neq\emptyset, T\subset N} α_T\cdot v_T$$
> where $α_T\in\mathbb{R}$, and there is unique $(α_T)$ for each game

Let $v_T(S) =\begin{cases}1 & T\subset S \\ 0 &\text{Otherwise} \end{cases}$  
Rewrite the game $v$: 
$$\begin{aligned}v &= \big( v(S_1), v(S_2),\dots, v(S_{2^{|N|}-1}) \\
&\in \mathbb{R}^{2^{|N|}-1} \end{aligned}$$
:) $B = \{ v_T: T\neq\emptyset, T\subset N\}$ is a basis for vector space $\mathbb{R}^{2^{|N|}-1}$  
$\iff B$ are linearly independent  
$\iff \sum_T β_T\cdot v_T = 0$ $\implies β_T = 0$ for all $T$  
FSOC let $\sum_S β_S\cdot v_S = 0$, where $β_T \neq 0$ for some $T$  
Let $S$ be s.t. for all $S\subsetneq S'$, $β_{S'} = 0$  
$$\begin{aligned}0 &= \sum_T β_T\cdot v_T(S) \\
&= \sum_{T\subsetneq S} \underbrace{β_T}_{!= 0}\cdot \underbrace{v_T(S)}_{= 1} + \underbrace{β_S}_{!\neq 0}\cdot\underbrace{v_S(S)}_{=1} + \sum_{T\not\subset S} β_T\cdot \underbrace{v_T(S)}_{0} \\
&\neq 0\end{aligned}$$
Contradiction! 
 -->

> Example  
> Let $N =\{1,2,3\}$, $v(\{1,2,3\}) = 1$, $v(\{1,2\}) = \frac{2}{3}$, $v(S)=0$ otherwise  
> Find out 1, 2, 3's Shapley values

1. Approach 1  
Consider member 1  
1's marginal contribution:
$$v^1\big(S_1(γ)\big) = \begin{cases} 0 & γ = (1,\dots) \\ \frac{2}{3} & γ = (2,1,\dots) \\ 0 & γ = (3,1,\dots) \\ 1 & γ = (x, y,1)\end{cases}$$
1's Shapley value:
$$\begin{aligned}ψ_1 &= \frac{1}{|N|!} \sum_γ v^1\big( S_1 (γ)\big) \\
&= \frac{1}{3\cdot 2}\big(0 + \frac{2}{3} + 0 + 2\cdot 1\cdot 1\big)\\
&= \frac{1}{6}\cdot\frac{8}{3} \\
&= \frac{4}{9} \end{aligned}$$
By symmetry, $ψ_2 = ψ_1 = \frac{4}{9}$  
$ψ_3 = v(N) - ψ_1 - ψ_2 = \frac{1}{9}$
2. Approach 2  
Consider member 3  
3's marginal contribution:
$$v^3\big(S_3(γ)\big) = \begin{cases} 0 & γ = (3,\dots) \\ 0 & γ = (x, 3,\dots) \\ \frac{1}{3} & γ = (x,y, 3)\end{cases}$$
3's Shapley value:
$$\begin{aligned}ψ_3 &= \frac{1}{|N|!} \sum_γ v^3\big( S_3 (γ)\big) \\
&= \frac{1}{3\cdot 2}\big(0 + 0 + 0 + 2\cdot 1\cdot \frac{1}{3}\big)\\
&= \frac{1}{6}\cdot\frac{2}{3} \\
&= \frac{1}{9} \end{aligned}$$
By symmetry, $ψ_1 = ψ_2 = \frac{1}{2}\big(v(N) - ψ_3\big) = \frac{4}{9}$  

<!-- 
> Exercise 4  
> Write down the axioms for the Shapley value.  
> Clearly (!) and briefly (!!!) explain the economic meaning of each of the axioms.

1. Efficiency / Feasibility  
Meaning: nothing in the total value is wasted
2. Symmetry  
Meaning: changing the number or name of player will not change their value
3. Dummy  
Meaning: if someone contributes 0, their value is 0
4. Additivity  
Meaning: for games with the same players, the values can be summed up
 -->

> Exercise 5  
> There are 4 identical workers.  
> A coalition of $n$ workers can produce $1 − \frac{1}{N}$ widgets.  
> Each widget can be sold for 40 dollars.
> 
> 1. Use a cooperative solution concepts from class to predict how many widgets will get produced and what the reward of each worker will be.
> 2. Two of the workers fall in love with each other and from now on take all decisions jointly.  
> Use a cooperative solution concept from class to predict how many widgets will get produced and what the reward of each worker will be.

1. Since they are identical, each worker gets
$$\begin{aligned}\frac{1}{4}\cdot\big(1-\frac{1}{4}\big) &= \frac{3}{16} \\
\frac{3}{16}\cdot 40 &= \frac{15}{2} \end{aligned}$$
<!-- correct but too complicated  
Let the workers be {A, B, C, D}  
Since they are identical, consider A's contribution:  
$$v^A\big( S_A (γ)\big) = \begin{cases}0 & γ = (A,\dots) \\\frac{1}{2} & γ = (x, A,\dots) \\\frac{1}{6} & γ=(x,y,A,\dots) \\\frac{1}{12} & γ=(x,y,z,A)\end{cases}$$
A's Shapley value: 
$$\begin{aligned}ψ_A(v) &= \frac{1}{|N|!} \sum_γ v^A\big( S_A (γ)\big) \\
&= \frac{1}{4!}\big(3\cdot 2\cdot 1\cdot 0 + 3\cdot 2\cdot 1\cdot\frac{1}{2} + 3\cdot 2\cdot 1\cdot\frac{1}{6} + 3\cdot 2\cdot 1\cdot\frac{1}{12} \big) \\
&= \frac{1}{4!}\cdot 3\cdot 2\cdot\big(\frac{1}{2} + \frac{1}{6} + \frac{1}{12} \big) \\
&= \frac{3}{16}\end{aligned}$$ -->
2. Let the couple be (A, B), C and D are identical  
AB's marginal contribution:
$$v^{AB}\big( S_{AB} (γ)\big) = \begin{cases}\frac{1}{2} & γ = (AB,\dots) \\\frac{2}{3} & γ = (x, AB, \dots) \\\frac{1}{4} & γ=(x,y,AB)\end{cases}$$
AB's Shapley value: 
$$\begin{aligned}ψ_{AB}(v) &= \frac{1}{|N|!} \sum_γ v^{AB}\big( S_{AB} (γ)\big) \\
&= \frac{1}{3!}\big( 2\cdot 1\cdot\frac{1}{2} + 2\cdot 1\cdot\frac{2}{3} + 2\cdot 1\cdot\frac{1}{4}\big) \\
&= \frac{1}{3!}\cdot 2\cdot\big(\frac{1}{2} + \frac{2}{3} + \frac{1}{4}\big) \\
&= \frac{17}{36}\end{aligned}$$
AB get $\frac{17}{36}\cdot 40 = \frac{170}{9}$  
Therefore, C and D each gets
$$\begin{aligned}\big(1-\frac{1}{4}\big) - \frac{17}{36} &= \frac{5}{18} \\
\frac{5}{18}\cdot\frac{1}{2}\cdot 40 &= \frac{50}{9}\end{aligned}$$
<!-- correct but too complicated  
C's contribution:
$$v^C\big( S_C (γ)\big) = \begin{cases}0 & γ = (C,\dots) \\\frac{1}{2} & γ = (D, C, \dots) \\\frac{1}{6} & γ=(AB, C, \dots) \\ \frac{1}{12} & γ=(\dots, C)\end{cases}$$
C's Shapley value: 
$$\begin{aligned}ψ_C(v) &= \frac{1}{|N|!} \sum_γ v^C\big( S_C (γ)\big) \\
&= \frac{1}{3!}\big( 2\cdot 1\cdot 0 + 1\cdot 1\cdot\frac{1}{2} + 1\cdot 1\cdot\frac{1}{6} + 2\cdot 1\cdot\frac{1}{12} \big) \\
&= \frac{1}{3!}\big(\frac{1}{2} + \frac{1}{6} + 2\cdot\frac{1}{12} \big)\\
&= \frac{5}{36}\end{aligned}$$
 -->

> Exercise (slides P102)  
> Calculate the Shapley value for games with transferable payoffs.

Majority game:  
100 seats in parliament, decision by 51 seats  
party 1 has 35 seats, party 2-6 has 13 seats each  
$v(S) = \begin{cases}1 & S \text{ has seats}\geq 51 \\ 0 & \text{Otherwise}\end{cases}$  
Consider party 1:  
$$\begin{aligned}v^1\big( S_1 (γ)\big) &= \begin{cases}0 & γ = (1,\dots) \\0 & γ = (a, 1,\dots) \\1 & γ=(a,b,1,\dots) \\1 & γ=(a,b,c,1,\dots) \\ 0 & γ=(a,b,c,d,1,\dots) \\ 0 & γ=(a,b,c,d,e,1)\end{cases} \\
ψ_1(v) &= \frac{1}{|N|!} \sum_γ v^1\big( S_1 (γ)\big) \\
&= \frac{1}{|N|!} \sum_{\text{Party 1 is 3rd or 4th}} 1 \\
&= \frac{1}{|N|!}\cdot\big( (|N|-1)\cdot (|N|-2)\cdot 1 \cdot (|N|-3)\cdot(|N|-4)\cdot (|N|-5) \\
&\phantom{\ggg}+ (|N|-1)\cdot (|N|-2)\cdot (|N|-3)\cdot 1 \cdot (|N|-4)\cdot (|N|-5)\big) \\
&= \frac{2\cdot (|N|-1)!}{|N|!} \\
&= \frac{2}{|N|} \\
&= \frac{1}{3}\end{aligned}$$
Since symmetric, consider party 2-6:
$$\begin{aligned}ψ_{-1}(v) &= \Big( 1-\frac{1}{3})\cdot\frac{1}{5} \\
&= \frac{2}{15} \end{aligned}$$

> Example (OR P??)  
> $N = \{1,2,\dots, 15\}$  
> $v(S) = \begin{cases}1 & S\supset\{1,2,3,4,5\} \text{ and } |S|\geq 9 \\ 0 & \text{Otherwise}\end{cases}$  
> Calculate the Shapley value

We know that $5\cdot ψ_1 + 10\cdot ψ_6 = 1$  
For $i=6$, $v^6=1\iff$ he is the 9-th member of the coalition
$$\begin{aligned}ψ_6 &= \frac{1}{|N|!}\sum_{γ\in Γ} v^6\big(S_6(γ)\big) \\
&= \frac{1}{15!}\begin{pmatrix}9 \\ 3\end{pmatrix}\cdot \underbrace{8!}_{\text{8 before}}\cdot \underbrace{6!}_{\text{6 after}} \\
&= \frac{1}{15!}\cdot \frac{9!}{3!\cdot 6!}\cdot 8!\cdot 6! \end{aligned}$$

## Repeated Game

### Stage Game (Normal-Form)

OR 8.3

- Stage (constituent) game:
$$G = \big\langle N, (A_i)_{i\in N}, (g_i)_{i\in N}\big\rangle$$
- Set of players: $N$, $|N| = n$
    - Player function: $P: (H\backslash Z) \to N$
- Action in $G$
    - Player i's action: $a_i\in A_i$
    - Set of player i's actions: $A_i$
    - Action profile: $a = (a_1,\dots, a_n)\in A$
    - Set of action profiles: $A = \prod_{i\in N} A_i$
- Strategy in $G$
    - Player i's strategy : $s_i(a) \in S_i$
    - Set of player i's (possible) strategy: $S_i$
    - Strategy profile: $s = (s_1, s_2,\dots, s_n)\in S$
    - Set of strategy profiles: $S = \prod_{i\in N} S_i$
- Utility function: $g_i: A\to\mathbb{R}$

### δ-Discounted Repetition

OR 8.3

- Infinitely repeated game:
$$G^{\infty}(δ) = \big\langle N, (S_i)_{i\in N}, (u_i)_{i\in N}\big\rangle$$
- Action in $G^{\infty}$
    - Set of action series for player i: $A_i$
    - Set of action series: $A = \{ a \ | \ (h,a)\in H\} = \prod_{i\in N} A_i$
    - Action profile in round $t$:
    $$\begin{aligned}a^t &= \big( s_1(a^1,a^2,\dots,a^{t-1}),\dots, s_n(a^1,a^2,\dots,a^{t-1})\big) \\
    &= \big(s_1(h^t),\dots, s_n(h^t)\big) \\
    &= s(h^t)\end{aligned}$$
    - Set of sequences of action profiles: $A^t = \{ (a^τ)^t_{τ=1}\}$
- History
    - Set of histories: $H = \{\emptyset\}\cup\big(\cup_{t=1}^{\infty} A^t\big) \cup A^{\mathbb{N}}$
    - Initial history (node): $h^1 = \emptyset$
    - A history of length t: 
    $$\begin{aligned}h^t &= (a^τ)^{t-1}_{τ=1} \in A^{t-1} \\ h^{t+1} &= (h^t, a^t)\end{aligned}$$
<!--     $h^t$ occurs in the beginning of period $t$:
    $$\begin{aligned}h^t &= \Big(h^{t-1},\big( s_1(h^{t-1},\dots, s_n(h^{t-1}) \big)\Big) \\
    &= (h^{t-1}, a^{t-1}) \\
    &= (a^1, a^2,\dots, a^{t-1})\end{aligned}$$ -->
- Strategy in $G^{\infty}$
    - Player i's strategy : $s_i(h^t): (H\backslash Z) \to A_i$, $s_i\in S_i$
    - Set of player i's strategy: $S_i$
    - Strategy profile: $s = (s_1, s_2,\dots, s_n)$  
    $s(h^t) = \big( s_1(h^t),\dots, s_n(h^t)\big)$
<!-- - Set of strategy profiles: $S = \prod_{j\in N} S_j$ -->
<!-- - Preference & Utility
    - $\succsim_i$ defined on $Z$
    - Weak separability  
    if some $(a^t)\in A^{\mathbb{N}}$, $a,a'\in A$, then for all $t$,
    $$\begin{aligned}a &\succsim_i a'\\ u_i(a) &> u_i(a') \\
    (a^1, \dots, a^{t-1}, a, a^{t+1},\dots) &\succsim_i^* (a^1, \dots, a^{t-1}, a', a^{t+1},\dots) \\
    \big(g_i(a^1, \dots, a^{t-1}, a, a^{t+1},\dots)\big &> \big(g_i(a^1, \dots, a^{t-1}, a', a^{t+1},\dots)\big\end{aligned}$$ -->
- Payoff
    - Discount rate: $δ\in (0,1)$
    - Discounted (cumulative) payoff:
    $$\begin{aligned}\hat{u}_i(s_i, s_{-i}) &= \sum_{t=1}^{\infty} δ^{t-1}\cdot g_i\big( s_i(h^t), s_{-i}(h^t)\big) \\
    &= \sum_{t=1}^{\infty} δ^{t-1}\cdot g_i\big(s(h^t)\big)\end{aligned}$$
    - Average discounted payoff: 
    $$\begin{aligned}u_i(s_i, s_{-i}) &= \frac{1}{1+δ+δ^2+\dots}\cdot \sum_{t=1}^{\infty} δ^{t-1}\cdot g_i\big( s_i(h^t), s_{-i}(h^t)\big)\\
    &= (1-δ)\cdot \sum_{t=1}^{\infty} δ^{t-1}\cdot g_i\big(s(h^t)\big) \\
    &= \sum_{t=1}^{\infty} (1-δ)\cdot δ^{t-1}\cdot g_i\big(s(h^t)\big)\end{aligned}$$
- $s$ is NE  
$\iff$ for all $i\in I$, for all $s_i'$ for player i, $u_i(s)\geq u_i(s_i', s_{-i})$

### Perfect Folk Theorems

OR 8.5, 8.8, 8.9  
[Folk theorem \- Wikipedia](https://en.wikipedia.org/wiki/Folk_theorem_(game_theory)#Summary_of_folk_theorems)

- Game: $G^{\infty}(δ) = \big\langle N, (S_i)_{i\in N}, (u_i)_{i\in N}\big\rangle$
- The set of (SP)NE outcomes of an infinitely repeated game  
includes outcomes that are not repetitions of NE of the stage game  
that cannot be established without punishment
    - Trigger strategy: deviation leads to a punitive action that lasts forever
    - All players uses trigger strategy
- Feasible payoff (OR 8.3)
    - Payoff profile: exists $a$ s.t. $v = \big( g_1(a),\dots, g_n(a) \big)$
    - Feasible payoff profiles: $v\in V$  
    (not necessarily actual payoff profiles)
    - Set of feasible payoffs of $G$ (convex hull of payoff profiles)
    $$V = \Big\{α\cdot\big( g_1(a),\dots, g_n(a) \big) : a\in A, \textstyle{\sum}_n α_i =1 \Big\}$$
    - Average discounted payoff $\in V$
    $$\begin{aligned}\big(u_1(s),\dots,u_n(s)\big) &= \sum_{t=1}^{\infty} \overbrace{δ^{t-1} (1-δ)}^{\sum = 1}\cdot \big(g_1(a^t) ,\dots, g_n(a^t)\big) \\
    &\in V \end{aligned}$$
- Minmax payoff (OR 8.5)  
the lowest payoff that other players can force upon player i (punishment)
$$\underline{v}_i = \min_{a_{-i}\in A_{-i}} \ \max_{a_i\in A_i} \ g_i(a_{-i}, a_i)$$
break down: 
$$\begin{aligned}g_i^*(a_{-i}) &= \max_{a_i\in A_i} \ g_i(a_{-i}, a_i) \\
\underline{v}_i &= \min_{a_{-i}\in A_{-i}} \ g_i^*(a_{-i})\end{aligned}$$
    - OR Proposition 144.1: any NE of $G^{\infty}(δ)$ gives player i $u_i\geq \underline{v}_i$  
    $\iff$ player i receives $u_i\in V^*$
    - Set of enforceable payoff profiles: 
    $$\begin{aligned}V^* &= \{ v\in V:v_i \geq\underline{v}_i \}\\
    V^* &\subset V \end{aligned}$$
    - Enforceable outcome: $a\in A$ is an outcome of G, $u(a)\in V^*$
<!-- - Nash folk theorem (discounting, infinite) (OR Proposition 145.2) -->
- Perfect folk theorem (discounting, infinite) (Fudenberg, Levine, Maskin 1994, OR Proposition 151.1) 
    - Game: $G^{\infty}$
    - Assumption: $\dim (V^*) = |I| = n$  
    - For any $v\in V^*$ and $ε>0$, exists $\underline{δ}<1$ s.t. for all $δ>\underline{δ}$, $G^{\infty}(δ)$ has an SPNE with $u = \hat{v}$ s.t. $\hat{v}\in B_ε(v)$
- One-step deviation principle (OR Lemma 153.1)  
A strategy profile is a SPNE of $G^{\infty}(δ)$  
$\iff$ no player can gain by deviating in a single period after any history

### Finitely Repeated Game

- Stage game: $$G = \big\langle N, (A_i)_{i\in N}, (g_i)_{i\in N}\big\rangle$$
- Repeated game:
$$\begin{aligned}G^T(δ) &= \big\langle N, (S_i)_{i\in I}, (u_i)_{i\in I}\big\rangle \\
H &= \{\emptyset\}\cup\big(\cup_{t=1}^T A^t\big)\end{aligned}$$
- Perfect folk theorem (discounting, finite) (Benoit, Krishna 1986, OR Proposition 159.1)
    - Game: $G^T$
    - Average payoff: $\bar{p} = \frac{1}{T}\sum_{t=1}^T g(a^t)$ ($δ=1$)
    - Assumptions: $\dim (V^*) = |I| = n$; exists __2 NEs__ of the stage game for each i
    - Let $v\in V^*$, for all $ε>0$, exists $T'$ s.t. for all $T>T'$, $G^T$ has a SPNE with $\bar{p} = \hat{v}$ s.t. $\hat{v}\in B_ε(v)$

Quote from [Introduction to Game Theory Lecture 5](https://sites.duke.edu/niou/files/2011/05/Lecture-5-Repeated-Games.pdf) (P11):

- An infinitely repeated game usually has more SPNEs than a finitely repeated game, and it may have multiple SPNEs even if the stage game has a unique NE.
- Playing NE in each stage game, regardless of history, is still a SPNE in the infinitely repeated game.

Quote from [Game Theory with Engineering Applications Lecture 16](https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-254-game-theory-with-engineering-applications-spring-2010/lecture-notes/MIT6_254S10_lec16.pdf) (P7-8):

- The idea is to use the assumption on the dimension of $V^*$ ($\dim (V^*) = |I| = n$) to ensure that each player i can be singled out for punishment in the event of a deviation, and then use rewards and punishments for other players to ensure that the deviator can be held down to her minmax payoff.
- Finitely-repeated games with unique stage equilibrium do not allow corporation or any other outcome than the repetition of this unique equilibrium.

### eg) Battle of Sexes (BoS)

|      | F        | O        |
| ---- | -------- | -------- |
| F    | __\*3, 1\*__ | 0, 0     |
| O    | 0, 0     | __\*1, 3\*__ |

> Exercise 6  
> Two players play a repeated game with discount rate $δ$.  
> Assume that players can perfectly monitor each others actions (i.e. they see what others did in earlier periods), and care only about their expected discounted monetary payoff.  
> The stage game: 
> 
> |      |      | P2    |      |
> | ---- | ---- | ----- | ---- |
> |      |      | A     | B    |
> | P1   | A    | 1, 10 | 0, 0 |
> |      | B    | 0, 0  | 5, 5 |
> 
> 1. What can you say about the set of payoffs that can be achieved in a SPNE as the discount rate $δ$ gets close to 1?
> 2. Imagine, again for the case $δ$ being close to 1, that the players sit down together before the game starts and can can discuss which equilibrium they should play.  
> What is the problem with this bargaining situation if you would want to use the Nash Bargaining solution or the Kalai-Smorodinsky solution to make a prediction about the outcome?
> 3. In the context of (2), imagine that players just leave if no agreement is reached (in which case both get a payoff of 0).  
> What outcome of the bargaining does the Kalai-Smorodinsky solution predict?

1. SPNE  
According to Folk Theorem,  
Set of feasible payoffs: $V = Hull\{(5,5), (1,10), (0,0) \}$  
$\underline{v}_1 = 1$, $\underline{v}_2 = 5$,  
Set of enforceable payoff profiles:  
$V^* = Hull\{(1,5), (5,5), (1,10)\}$, $\dim(V^*) = 2 = |N|$  
2. Which equilibrium is to be realized is not clear
3. Kalai-Smorodinsky solution:

![](/post-img/notes-game-theory--ex-7.png){width=507px}

### eg) Prisoner's Dilemma (PD)

|      | C       | D           |
| ---- | ------- | ----------- |
| C    | 0, 0    | -2, 1\*     |
| D    | \*1, -2 | __\*-1, -1\*__  |

- Strictly dominant strategy: D
- Strictly dominated strategy: C
- Unique NE: (D, D)
- Preposition: for $T\in\mathbb{N}$, in any NE of repeated PD $G^T$, only (D, D) is played along the equilibrium path $(a^1,a^2,\dots,a^T)$
- Preposition: for sufficiently large $δ\in[0,1)$, for infinitely repeated PD $G^{\infty}$, exists an SPNE where (C, C) is played along the equilibrium path
    - Set of feasible payoffs:  
    ![](/post-img/notes-game-theory--pd-1.png){width=501px}  
    - Minmax payoffs:
    $$\begin{aligned}P1 && \underline{v}_1 &= \min_{a_{2}\in A_{2}} \ \max_{a_1\in A_1} \ g_i(a_{2}, a_1) \\
    && &= \min_{a_{2}\in A_{2}} \ \big\{(D,C),(D,D)\big\} \\
    && &= -1 \\
    P2 && \underline{v}_2 &= \min_{a_{1}\in A_{1}} \ \max_{a_2\in A_2} \ g_i(a_{1}, a_2) \\
    && &= \min_{a_{1}\in A_{1}} \ \big\{(C,D), (D,D)\big\} \\
    && &= -1 \end{aligned}$$
    - Kalai-Smorodinsky solution: (C, C) as SPNE  
    ![](/post-img/notes-game-theory--pd-2.png){width=495px}

> Exercise (slides P119)  
> In the above derivation we did not use the one-step deviation principle.  
> How would the argument simplify if we had used it?

### eg) Price Wars

[Rotemberg and Saloner (1986)](https://www.jstor.org/stable/pdf/1813358.pdf)

- Players: $n>1$ firms
- Time: $t=1,2,3,\dots, T$
- Set of state of the world: $S$
    - State of the world in period t: $s^t\in S$
    - Probability that $s$ occurs: $q(s)$
    - Aggregate demand
- Strategy: $p_i^t\in[ 0, s^t]$
    - Market price: $p^t = \min\ \{p_1^t, p_2^t,\dots, p_n^t\}$
    - Aggregate trade: $s^t - p^t$
    - Divided equally by all firms i with $p_i^t = p^t$
- Aggregate profit: $p^t\cdot (s^t - p^t)$
- Discounting factor: $δ$
- Observatiton
    - NE of stage game: $p_i = 0$ for all i
    - SPNE of repeated game: $p_i^t = 0$ for all i, all t
    - Aggregate profit maximization: $p_s = \frac{s^t}{2}$
- Symmetric SPNE (maximize profit)
    - Average discounted payoff: $\hat{v}$
    - Price at first period in $s$: $p^*(s)$
    - Payoff for a firm in equilibrium: $v^*$
    - Strategy: if all else haven't deviated, charge $p_i = \frac{s^t}{2}$  
    if someone has deviated, charge $p_i = 0$  
    - In order for the SPNE to sustain, it must be
    $$\underbrace{(1-δ)\cdot\frac{1}{n}\cdot p^*(s)\cdot\big(s-p^*(s)\big)}_{\text{Cooperate}} + δ\cdot v^* \geq \underbrace{(1-δ)\cdot 1\cdot \big(p^*(s)-ε\big)\cdot\big(s-p^*(s)+ε\big)}_{\text{Deviate}} + \underbrace{δ\cdot 0}_{\text{Punishment}}$$
    when $ε\to 0$,
    $$\begin{aligned}(1-δ)\cdot\frac{1}{n}\cdot p^*(s)\cdot\big(s-p^*(s)\big) + δ\cdot v^* &\geq (1-δ)\cdot p^*(s)\cdot\big(s-p^*(s)\big) + δ\cdot 0 \\
    \frac{1}{n}\cdot p^*(s)\cdot\big(s-p^*(s)\big) + \frac{δ}{1-δ}\cdot v^* &\geq p^*(s)\cdot\big(s-p^*(s)\big)\end{aligned}$$
    <!--
    - Considering average discounted payoff,
    $$\begin{aligned}&\phantom{\ggg}(1-δ)\cdot\sum_{t=1} δ^{t-1} g_i(a^t) \\
    &= (1-δ)\cdot g_i(a^1) + (1-δ)\cdot\sum_{t=2} δ^{t-1} g_i(a^t) \\
    &= (1-δ)\cdot g_i(a^1) + (1-δ)\cdot\sum_{t'=1} δ^{t'} g_i(a^{t'+1}) \\
    &= (1-δ)\cdot g_i(a^1) + δ\cdot (1-δ)\cdot\sum_{t'=1} δ^{t'-1} g_i(a^{t'+1}) \\\end{aligned}$$
    therefore,  average discounted equilibrium payoff should be larger than ?? -->
    - On the other hand, $v^*$ cannot be larger than average discounted payoff
    $$\begin{aligned}v^* &\leq (1-δ)\cdot\sum_S \frac{1}{n}\cdot q(s)\cdot p^*(s)\cdot\big(s-p^*(s)\big) + δ\cdot v^* \\
    (1-δ)v^* &\leq (1-δ)\cdot\sum_S \frac{1}{n}\cdot q(s)\cdot p^*(s)\cdot\big(s-p^*(s)\big) \\
    v^* &\leq \frac{1}{n}\cdot\sum_S q(s)\cdot p^*(s)\cdot\big(s-p^*(s)\big)\end{aligned}$$
    - Firm coalition's (reduced) problem:
    $$\begin{aligned}\max_{v,p:S\to\mathbb{R}} && &v \\
    s.t. && &\frac{1}{n}\cdot p(s)\cdot\big(s-p(s)\big) + \frac{δ}{1-δ}\cdot v \geq p(s)\cdot\big(s-p(s)\big) \\
    && &v \leq \frac{1}{n}\cdot\sum_S q(s)\cdot p(s)\cdot\big(s-p(s)\big)\end{aligned}$$
    let the solution be $v^{**}>v^*$, $p^{**}$  
    when $δ\to 1$, 
    $$\begin{aligned}p^{**} &= \frac{s}{2} \\
    v^{**} &= \sum_S \frac{1}{n}\cdot q(s)\cdot p^{**}(s)\cdot\big(s-p^{**}(s)\big)\end{aligned}$$
    - When $δ$ is small, for some $s$, the second constraint becomes
    $$\begin{aligned}\frac{1}{n}\cdot p(s)\cdot\big(s-p(s)\big) + \frac{δ}{1-δ}\cdot v &\geq p(s)\cdot\big(s-p(s)\big)\\
    \frac{δ}{1-δ}\cdot v &\geq \Big(1-\frac{1}{n}\Big) p(s)\cdot\big(s-p(s)\big) \\
    \frac{δ}{1-δ}\cdot v &\geq \frac{n-1}{n} p(s)\cdot\big(s-p(s)\big) \\
    \frac{δvn}{(1-δ)(n-1)} &\geq p(s)\cdot\big(s-p(s)\big)\end{aligned}$$
    Plug in $p= \frac{s}{2}$, if holds, then $p^{**}(s)= \frac{s}{2}$ for this $s$
    $$\begin{aligned}\frac{δ}{1-δ}\cdot v^{**} &\geq\frac{n-1}{n}\cdot\frac{s}{2}\cdot\Big(s-\frac{s}{2}\Big) \\
    \frac{δ\cdot n}{(1-δ)(n-1)}\cdot v^{**} &\geq\frac{s}{2}\cdot\Big(s-\frac{s}{2}\Big) \end{aligned}$$
    when $δ$ is too small, $p^{**}$ is s.t.
    $$\frac{δ\cdot n}{(1-δ)(n-1)}\cdot v^{**} = p^{**}\cdot(s-p^{**})$$
    ![](/post-img/notes-game-theory--price-war-1.png){width=422}  
    ![](/post-img/notes-game-theory--price-war-2.png){width=414}

### eg) Time Inconsistency in Public Good

- P1: government
    - Tax rate: $t\in[0,1]$
    - Tax revenue: $t\cdot R(1-c)$
    - Public good: $G = γ\cdot t\cdot R(1-c)$
    - Technology: $R-1< γ<R$
- P2's: a continuum of consumers
    - Consumption: $c$
    - Investment: $1-c$
    - Investment return: $R(1-c)(1-t)$
    - Stage utility function: $$u = c + R(1-c)(1-t) + 2\sqrt{G}$$
- P2s' choice
    - Expected tax rate: $t$
    - Treat $G$ as constant
    - P2s' problem:
    $$\begin{aligned}\max_c && u &= c + R(1-c)(1-t) + 2\sqrt{G}\\
    && &= c\cdot\big( 1-R\cdot(1-t)\big) + R(1-t) + 2\sqrt{G}\\
    FOC && \frac{du}{dc} &= 1-R\cdot(1-t)\end{aligned}$$
    $c^* = 1$ when 
    $$\begin{aligned}1-R\cdot(1-t)&>0 \\
    R\cdot(1-t) &< 1 \\
    t &> \frac{R-1}{R} \end{aligned}$$
    $c^* = 0$ when 
    $$\begin{aligned}1-R\cdot(1-t)&<0 \\
    t &< \frac{R-1}{R} \end{aligned}$$
- P1's problem
    - When $c<1$,
    $$\begin{aligned}\max_t && u &= c + R(1-c)(1-t) + 2\sqrt{γ\cdot t\cdot R(1-c)} \\
    FOC && \frac{du}{dt} &= R(1-c)(-1) + 2\cdot\frac{1}{2}\cdot\big(γ\cdot t\cdot R(1-c)\big)^{-\frac{1}{2}}\cdot γ\cdot R(1-c)\\
    && &= -R(1-c) + \big(γ\cdot t\cdot R(1-c)\big)^{-\frac{1}{2}}\cdot γ\cdot R(1-c)\\
    && &= -R(1-c) + \sqrt{γ\cdot R(1-c)}\cdot\frac{1}{\sqrt{t}} \overset{!}{=} 0 \\
    && R(1-c) &= \sqrt{γ\cdot R(1-c)}\cdot\frac{1}{\sqrt{t}} \\
    && t^* &= \frac{γ}{R(1-c)} \end{aligned}$$
    therefore, $t^* = \min\ \Big\{1, \frac{γ}{R(1-c)}\Big\}$  
    - When $c=1$, $u = c = 1$, $t$ is irrelevant
- Unique NE of stage game

![](/post-img/notes-game-theory--time-inconsis.png){width=392px}

- P1's trigger strategy in repetition
    1. Charges $t^{**} = \frac{R-1}{R}$ in the  first round
    2. Charges $t^{**}$ for all histories where all $t = t^{**}$
    3. Charges $t=1$ for histories where some $t\neq t^{**}$
- P2s' BR
    a. When (2) happens, $c=0$
    b. When (3) happens, $c=1$
- $\implies$ SPNE if  $δ$ is close enough to 1
-