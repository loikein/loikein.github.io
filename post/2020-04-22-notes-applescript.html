
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>#-
title: “Notes on AppleScript”
author: “loikein”
date: “2020-04-22”
slug: “notes-applescript”
tags: [“Programming”,“AppleScript”]
output:
blogdown::html_page:
toc: true
#-</p>
<p>Version of macOS: 10.15.4 (19E266)<br />
Editor: Script Editor.app</p>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li><a href="https://segmentfault.com/a/1190000011273388">AppleScript 脚本入门 - 从前端到全栈 - SegmentFault 思否</a></li>
<li><a href="https://en.wikibooks.org/wiki/AppleScript_Programming">AppleScript Programming - Wikibooks, open books for an open world</a></li>
<li><a href="https://sspai.com/post/46912">AppleScript 入门：探索 macOS 自动化 - 少数派</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html">Introduction to AppleScript Language Guide</a></li>
</ul>
</div>
<div id="basics" class="section level2">
<h2>Basics</h2>
<div id="hello-world" class="section level3">
<h3>Hello World</h3>
<pre class="perl"><code>beep

beep 5</code></pre>
<pre class="perl"><code>display dialog &quot;hello, world&quot; 
-- &quot;OK&quot; and &quot;Cancel&quot; buttons
-- In case you missed, this is a comment
# this too!

display alert &quot;hello, world&quot;
# &quot;OK&quot; button and icon of alert

say &quot;hello, world!&quot;
# audio message

get &quot;hello, world!&quot;
# log to console</code></pre>
</div>
<div id="variables" class="section level3">
<h3>Variables</h3>
<pre class="perl"><code>set x to &quot;hello world&quot;
say x
# &quot;hello world&quot;</code></pre>
<pre class="perl"><code>set x to 25
say x
# &quot;twenty-five&quot;</code></pre>
</div>
<div id="types" class="section level3">
<h3>Types</h3>
<pre class="perl"><code>set x to 16 as number
get x
# 16

set y to 12 as text
# or
set y to 12 as string
get y
# &quot;12&quot;</code></pre>
</div>
<div id="string-operation" class="section level3">
<h3>String Operation</h3>
<pre class="perl"><code>set a to &quot;hello&quot;
set b to &quot;world&quot;
say a &amp; b
# &quot;hello&quot; &quot;world&quot;

set c to 2
set d to 5
say c &amp; d
# Error!
get c &amp; d
# {2, 5} (list)

set e to &quot;2&quot;
set f to &quot;5&quot;
say e &amp; f
# &quot;twenty-five&quot;</code></pre>
<pre class="perl"><code>set len to the length of &quot;hello world&quot;
display alert len
# 11</code></pre>
</div>
<div id="list" class="section level3">
<h3>List</h3>
<pre class="perl"><code>set list1 to 1 &amp; 2 &amp; 3
get list1
# {1, 2, 3}

set new_item to 6
set list2 to list1 &amp; new_item
get list2
# {1, 2, 3, 6}

get the length of list2
# 4

get item 1 of list2
# 1 (!!!)

get last item of list2
# or
get item -1 of list2
# 6

get some item of list2
# random item

set item 4 of list2 to 200
get list2
# {1, 2, 3, 200}</code></pre>
<pre class="perl"><code>set list3 to {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;}

set short_list to items 2 through 5 of list3
get short_list
# {&quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;}

set list3_rev to reverse of list3
get list3_rev
# {&quot;f&quot;, &quot;e&quot;, &quot;d&quot;, &quot;c&quot;, &quot;b&quot;, &quot;a&quot;}</code></pre>
</div>
<div id="type-conversion" class="section level3">
<h3>Type Conversion</h3>
<pre class="perl"><code>set x to &quot;16&quot;
get x as number
# 16

set y to 12
get y as text
# &quot;12&quot;</code></pre>
<pre class="perl"><code>set list3 to {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;}
get list3 as text
# &quot;abcdef&quot;</code></pre>
<pre class="perl"><code>set list4 to every character of &quot;hello world&quot;
get list4
# {&quot;h&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot;, &quot; &quot;, &quot;w&quot;, &quot;o&quot;, &quot;r&quot;, &quot;l&quot;, &quot;d&quot;}</code></pre>
<pre class="perl"><code>set sen_str to &quot;this is a beautiful world&quot;

set keep_delim to AppleScript&#39;s text item delimiters
set AppleScript&#39;s text item delimiters to &quot; &quot;

set sen_list to every text item of sen_str
set AppleScript&#39;s text item delimiters to keep_delim

get sen_list
# {&quot;this&quot;, &quot;is&quot;, &quot;a&quot;, &quot;beautiful&quot;, &quot;world&quot;}

get AppleScript&#39;s text item delimiters
# {&quot;&quot;}</code></pre>
<blockquote>
<p>Ref: <a href="https://macscripter.net/viewtopic.php?id=24422">MacScripter / What are AppleScript’s Text Item Delimiters and how are they used?</a></p>
<p>It’s a good practice to capture the state of AppleScript’s text item delimiters at the beginning and restore them at the end,<br />
as once they are changed they will globally affect the running environment until the process is quit and restarted!<br />
(eg, the script editor, or your script running as standalone application)</p>
</blockquote>
</div>
<div id="dictionary" class="section level3">
<h3>Dictionary</h3>
<pre class="perl"><code>set dict1 to {hello:&quot;world&quot;, dict:&quot;tionary&quot;}

set x to hello of dict1
set y to dict of dict1

get x &amp; y
# &quot;worldtionary&quot;</code></pre>
</div>
</div>
<div id="tell-application" class="section level2">
<h2>Tell Application</h2>
<pre class="perl"><code>tell application &quot;Safari&quot;
    activate
end tell</code></pre>
</div>
