<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.52" />


<title>Notes on Econometrics - Theory Part - loikein</title>
<meta property="og:title" content="Notes on Econometrics - Theory Part - loikein">



  








<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">
<link rel="stylesheet" href="/css/clumsy-toc.css" media="all">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
<link rel="stylesheet" href="/css/clumsy-findme.css" media="all">




  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/loikein-logo.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/">Posts</a></li>
    
    <li><a href="/tags/">Tags</a></li>
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="https://github.com/loikein/loikein.github.io">GitHub</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">29 min read</span>
    

    <h1 class="article-title">Notes on Econometrics - Theory Part</h1>

    
    <span class="article-date">2019/01/11</span>
    
    
    
    <span class="tags">
    
    
    Tags:
    
    <a href='/tags/notes'>notes</a>
    
    <a href='/tags/r'>R</a>
    
    <a href='/tags/stat'>stat</a>
    
    
    
    </span>
    

    <div class="article-content">
      

<div id="TOC">
<ul>
<li><a href="#tests-statistics">Tests &amp; Statistics</a><ul>
<li><a href="#r2"><span class="math inline">\(R^2\)</span></a></li>
<li><a href="#t-test">t-test</a></li>
<li><a href="#f-test-joint-test">F-test (Joint Test)</a></li>
<li><a href="#wald-test">Wald Test</a></li>
<li><a href="#bic-aic-nested-model">BIC &amp; AIC (Nested Model)</a></li>
<li><a href="#j-test-non-nested-model">J Test (Non-Nested Model)</a></li>
<li><a href="#pe-test-linear-vs-log">PE Test (Linear vs Log)</a></li>
<li><a href="#chow-breakpoint-test">Chow (Breakpoint) Test</a></li>
<li><a href="#durbin-watson-test-autocorrelation">Durbin-Watson Test (Autocorrelation)</a></li>
<li><a href="#goldfeld-quandt-test-heteroskedasticity">Goldfeld-Quandt Test (Heteroskedasticity)</a></li>
<li><a href="#breusch-pagan-test-heteroskedasticity">Breusch-Pagan Test (Heteroskedasticity)</a></li>
<li><a href="#breusch-godfrey-test-autocorrelation">Breusch-Godfrey Test (Autocorrelation)</a></li>
<li><a href="#box-pierce-test-autocorrelation">Box-Pierce Test (Autocorrelation)</a></li>
<li><a href="#sargan-test-give-overidentification">Sargan Test (GIVE Overidentification)</a></li>
<li><a href="#durbin-wu-hausman-test-endogeneity">Durbin-Wu-Hausman Test (Endogeneity)</a></li>
<li><a href="#read-regression-table">Read Regression Table</a></li>
</ul></li>
<li><a href="#gauss-markov-assumptions">Gauss-Markov Assumptions</a></li>
<li><a href="#ols-error">OLS Error</a><ul>
<li><a href="#normality-of-">Normality of <span class="math inline">\(ε\)</span></a></li>
<li><a href="#unbiasedness-of-s2">Unbiasedness of <span class="math inline">\(s^2\)</span></a></li>
<li><a href="#consistency-of-s2">Consistency of <span class="math inline">\(s^2\)</span></a></li>
</ul></li>
<li><a href="#ols-estimator">OLS Estimator</a><ul>
<li><a href="#derive-ols">Derive OLS</a></li>
<li><a href="#normality-of-b">Normality of <span class="math inline">\(b\)</span></a></li>
<li><a href="#unbiasedness-of-b">Unbiasedness of <span class="math inline">\(b\)</span></a></li>
<li><a href="#consistent-of-b-asymptotic">Consistent of <span class="math inline">\(b\)</span> (Asymptotic)</a></li>
<li><a href="#efficienty">Efficienty</a></li>
<li><a href="#blue-best-linear-unbiased-estimator">BLUE (Best Linear Unbiased Estimator)</a></li>
<li><a href="#can-consistent-and-asymptotically-normal">CAN (Consistent and Asymptotically Normal)</a></li>
</ul></li>
<li><a href="#ols-model">OLS Model</a><ul>
<li><a href="#converge-in-probability-mean-square">Converge in Probability &amp; Mean Square</a></li>
<li><a href="#lln-law-of-large-numbers">LLN (Law of Large Numbers)</a></li>
<li><a href="#loglinear-model">Loglinear Model</a></li>
<li><a href="#elasticity">Elasticity</a></li>
</ul></li>
<li><a href="#iv-instrument-variable">IV (Instrument Variable)</a><ul>
<li><a href="#derive-iv">Derive IV</a></li>
<li><a href="#iv-estimator-hat_iv">IV Estimator <span class="math inline">\(\hat{β}_{IV}\)</span></a></li>
<li><a href="#give-generalized-iv-estimator">GIVE (Generalized IV Estimator)</a></li>
</ul></li>
<li><a href="#heteroskedasticity-autocorrelation">Heteroskedasticity &amp; Autocorrelation</a><ul>
<li><a href="#white-hetero-consistent-standard-error">White (Hetero-Consistent) Standard Error</a></li>
<li><a href="#hac-robust-standard-error">HAC (Robust) Standard Error</a></li>
</ul></li>
<li><a href="#maximum-likelihood-model">Maximum Likelihood Model</a></li>
<li><a href="#time-series">Time Series</a><ul>
<li><a href="#types-of-process">Types of Process</a></li>
<li><a href="#lag-operator">Lag Operator</a></li>
<li><a href="#stationary">Stationary</a></li>
</ul></li>
</ul>
</div>

<p>Warning: under proofreading</p>
<p>All I wanted was a clear &amp; complete guidance (for upcoming exams).<br />
Textbook: <a href="http://93.174.95.27/book/index.php?md5=744048ECF4C4A865F45A5877AA7C2BD5">A Guide to Modern Econometrics</a></p>
<div id="tests-statistics" class="section level2">
<h2>Tests &amp; Statistics</h2>
<div id="r2" class="section level3">
<h3><span class="math inline">\(R^2\)</span></h3>
<p>(textbook P21, slide 3 P4)<br />
<span class="math display">\[\begin{aligned}  &amp;&amp; &amp;R^2 = 1 - \frac{\sum^N_{i=1} e_i^2}{\sum^N_{i=1} (y_i-\bar{y})^2} \\
\text{adjusted:} &amp;&amp; &amp;\bar{R^2} = 1 - \frac{\frac{1}{N-K}\sum^N_{i=1} e_i^2}{\frac{1}{N-1}\sum^N_{i=1} (y_i-\bar{y})^2}\end{aligned}\]</span> ~</p>
<blockquote>
<p>PS2.Q1<br />
Consider two linear regression models:<br />
<span class="math display">\[\begin{aligned} y &amp;= X_1 b_{11} + e_1 \\
y &amp;= X_1 b_{21} + X_2 b_{22} + e_2\end{aligned}\]</span><br />
The solution to the minimization problem of the first model is given by <span class="math inline">\(b_{11}\)</span> and for the second model by <span class="math inline">\(b_{21}\)</span> for the regressors in <span class="math inline">\(X_1\)</span> and <span class="math inline">\(b_{22}\)</span> for the regressors in <span class="math inline">\(X_2\)</span>.<br />
<span class="math inline">\(e_1\)</span> and <span class="math inline">\(e_2\)</span> denote the residuals.<br />
Denote the <span class="math inline">\(R^2\)</span> for the first model by <span class="math inline">\(R^2_1\)</span> and for the second model by <span class="math inline">\(R^2_2\)</span>.<br />
Show that <span class="math inline">\(R^2_2 ≥ R^2_1\)</span> (<span class="math inline">\(R^2\)</span> always increases if we increase the number of regressors in models with intercept)</p>
</blockquote>
<p>According to the models,<br />
<span class="math display">\[\begin{aligned} R^2_1 &amp;= 1- \frac{e_1&#39;e_1}{\sum_{i=1}^N (y_i - \bar{y})^2} \\
R^2_2 &amp;= 1- \frac{e_2&#39;e_2}{\sum_{i=1}^N (y_i - \bar{y})^2}\end{aligned}\]</span><br />
Note for model 2, <span class="math inline">\(b_{21}\)</span> and <span class="math inline">\(b_{22}\)</span> are s.t.<br />
<span class="math display">\[S(\mathbf{\tilde{b_2}}) = \sum^N_{i=1} (y_i - x_i&#39; \mathbf{\tilde{b_2}})\]</span><br />
is minimized. Therefore,<br />
<span class="math display">\[\begin{aligned} \sum^N_{i=1} \big(y_i - x_i&#39; (b_{21},b_{22})&#39; \big) &amp;\leq \sum^N_{i=1} \big(y_i - x_i&#39; (b_{1}, 0)&#39; \big) \\
e_2&#39;e_2 &amp;\leq e_1&#39;e_1 \\ 
R^2_2 &amp;\geq R^2_1 \end{aligned}\]</span> ~</p>
</div>
<div id="t-test" class="section level3">
<h3>t-test</h3>
<p>(textbook P26, slide 3 P16)<br />
<span class="math display">\[t = \frac{\hat{β} - β_0}{se(\hat{β})}\]</span><br />
<span class="math inline">\(H_0: t ∼ t_{N-K} ∼^a \mathcal{N}(0,1)\)</span><br />
<span class="math inline">\(N\)</span> is the number of observations, <span class="math inline">\(K\)</span> is the number of <span class="math inline">\(β\)</span> 's.</p>
<blockquote>
<p>PS4.Q2.9<br />
T/F?<br />
When testing multiple restrictions, a t-test cannot be used.</p>
</blockquote>
<p>True.</p>
<blockquote>
<p>PS4.Q2.8<br />
T/F?<br />
When testing a single restriction, a t-test must be used as an F-test cannot be computed for <span class="math inline">\(J = 1\)</span>.</p>
</blockquote>
<p>False.<br />
When testing a single restriction, F-test is equivalent to t-test squared.<br />
Check this complete proof by <a href="https://jmcanovas.netlify.com/2018/10/29/when-does-the-f-test-reduce-to-t-test/">Juan Manuel</a>.</p>
</div>
<div id="f-test-joint-test" class="section level3">
<h3>F-test (Joint Test)</h3>
<p>(textbook P26, slide 3 P18)<br />
<span class="math display">\[F = \frac{\frac{1}{J} \cdot (R^2_1 - R^2_0)}{\frac{1}{N-K} \cdot (1-R^2_1)}\]</span><br />
<span class="math inline">\(H_0: F ∼ F_{N-K}^J\)</span><br />
<span class="math inline">\(N\)</span> is the number of observations, <span class="math inline">\(K\)</span> is the number of <span class="math inline">\(β\)</span> 's, and <span class="math inline">\(J\)</span> is the number of <span class="math inline">\(β\)</span> 's to be tested (<span class="math inline">\(= 0\)</span>), <span class="math inline">\(F \geq J + 1\)</span>.</p>
</div>
<div id="wald-test" class="section level3">
<h3>Wald Test</h3>
<p>(textbook P30, slide 3 P17)</p>
<ul>
<li><p>Wald statistic:
<span class="math display">\[ξ = \frac{1}{σ^2} (Rb - q)&#39; \big[R(X&#39; X)^{-1} R&#39; \big](Rb - q)\]</span><br />
<span class="math inline">\(H_0: ξ ∼ Χ^2_J\)</span><br />
<span class="math inline">\(K\)</span> is the number of <span class="math inline">\(β\)</span> 's, <span class="math inline">\(J\)</span> is the number of <span class="math inline">\(β\)</span> 's to be tested, <span class="math inline">\(R\)</span> is a <span class="math inline">\(J\times K\)</span> matrix, <span class="math inline">\(Rβ - q = 0\)</span>.</p></li>
<li>F-statistic:<br />
<span class="math display">\[F = \frac{1}{J \cdot s^2} (Rb - q)&#39; \big[R(X&#39; X)^{-1} R&#39; \big](Rb - q)\]</span><br />
<span class="math inline">\(H_0: F ∼ F^J_{N-K}\)</span><br />
</li>
<li><p>Note: Wald statistic and F-statistic are always two-sided</p></li>
</ul>
<blockquote>
<p>PS3.Q1.2<br />
For model <span class="math inline">\(\log{Y_t} = \log τ + β_1\log K_t + β_2\log L_t (+ ε_t)\)</span>, consider the regression output:<br />
<img src="/post-img/notes-stat1--PS3Q1.png" width="406" /><br />
<span class="math inline">\((X&#39; X)^{-1} = \begin{pmatrix} 5649.38 &amp;&amp; 307.02 &amp;&amp; \\ &amp;&amp; 16.85 &amp;&amp; -29.39 \\ -540.33 &amp;&amp; &amp;&amp; 51.68\end{pmatrix}\)</span><br />
3. Test the hypothesis of constant returns to scale at <span class="math inline">\(5\%\)</span> level.</p>
</blockquote>
<p>Constant return to scale <span class="math inline">\(\implies β_1 + β_2 = 1\)</span><br />
Let <span class="math inline">\(R = \begin{pmatrix} 0 &amp;&amp; 1 &amp;&amp; 1\end{pmatrix}\)</span>, <span class="math inline">\(β = \begin{pmatrix} \log τ \\ β_1 \\ β_2 \end{pmatrix}\)</span>, <span class="math inline">\(q = 1 \implies J = 1\)</span>.<br />
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(Rβ = q\)</span><br />
<span class="math display">\[F = \frac{1}{J \cdot s^2} (Rb - q)&#39; \big[R(X&#39; X)^{-1} R&#39; \big](Rb - q)\]</span><br />
Since <span class="math inline">\(X&#39;X\)</span> is symmetric, <span class="math inline">\((X&#39; X)^{-1} = \begin{pmatrix} 5649.38 &amp;&amp; 307.02 &amp;&amp; -540.33 \\ 307.02 &amp;&amp; 16.85 &amp;&amp; -29.39 \\ -540.33 &amp;&amp; -29.39 &amp;&amp; 51.68\end{pmatrix}\)</span><br />
Calculate F-statistics:</p>
<pre class="r"><code>matrix_x &lt;- matrix(c(5649.38, 307.02, -540.33, 307.02, 16.85, -29.39, -540.33, -29.39, 51.68), nrow = 3, byrow = TRUE)
matrix_r &lt;- matrix(c(0,1,1), nrow = 1, byrow = TRUE)
matrix_b &lt;- matrix(c(-5.9395, 0.3593, 0.8045), nrow = 3)
scalar_q &lt;- 1

# parts

result_1 &lt;- 1 / 0.0381^2
result_2 &lt;-matrix_r %*% matrix_b - scalar_q
result_3 &lt;- matrix_r %*% matrix_x %*% t(matrix_r)

# calculate F-statistics

result_1 * t(result_2) * result_3^(-1) * result_2
##          [,1]
## [1,] 1.895716</code></pre>
<p>Calculate critical value at <span class="math inline">\(5\%\)</span> level, for one restriction and <span class="math inline">\(df = 40\)</span>:</p>
<pre class="r"><code>qf( 0.95, 1, 40)
## [1] 4.084746</code></pre>
<p>Therefore, <span class="math inline">\(H_0\)</span> is not rejected.</p>
</div>
<div id="bic-aic-nested-model" class="section level3">
<h3>BIC &amp; AIC (Nested Model)</h3>
<p>(textbook P69, slide 5 P10)<br />
BIC is asymptotically consistent:
<span class="math display">\[\min \ I(K) = \log\left(\frac{e&#39;e}{N}\right) + \frac{K\cdot\log(N)}{N}\]</span><br />
<span class="math inline">\(N\)</span> is the number of observations, <span class="math inline">\(K\)</span> is the number of <span class="math inline">\(β\)</span> 's, and <span class="math inline">\(e\)</span> is vector of residual.<br />
If replace <span class="math inline">\(\log(N)\)</span> with <span class="math inline">\(2\)</span>, becomes AIC (inconsistent for large sample)</p>
</div>
<div id="j-test-non-nested-model" class="section level3">
<h3>J Test (Non-Nested Model)</h3>
<p>(textbook P72, slide 5 P11)<br />
<span class="math display">\[\begin{aligned} \text{Model A: } y_i &amp;= x_i&#39; β + ε_i \\
\text{Model B: } y_i &amp;= z_i&#39; γ + v_i \\
\text{Test Model: } y_i &amp;= \underbrace{(1-δ)x_i&#39; β}_{\text{Model A}} + \underbrace{δ z_i&#39; γ }_{\text{Model B}} + u_i \\
&amp;=^{H_0} x_i&#39; + δ \hat{y}_{i,B} + u_i \end{aligned}\]</span><br />
<span class="math inline">\(H_0: \ t_{δ} = \frac{δ}{se(δ)} ∼ t\)</span></p>
</div>
<div id="pe-test-linear-vs-log" class="section level3">
<h3>PE Test (Linear vs Log)</h3>
<p>(textbook P72, slide 5 P13)<br />
<span class="math display">\[\begin{aligned}\text{Linear Model: }&amp;\hat{y_i} = \dots \\ \text{Log Model: }&amp;\log\tilde{y_i} = \dots \end{aligned}\]</span> ~<br />
<span class="math display">\[\begin{aligned}\text{Test Models: }\phantom{\log} y_i &amp;= x_i&#39; β + δ_{Lin} (\log \underbrace{\hat{y_i}}_{\text{Linear Model}} - \underbrace{\log\tilde{y_i}}_{\text{Log Model}}) + u_i \\
\log y_i &amp;= (\log x_i)&#39; γ + δ_{Log} \big(\overbrace{\hat{y_i}} - \exp(\overbrace{\log\tilde{y_i}})\big) + u_i \end{aligned}\]</span> ~
<span class="math display">\[\begin{aligned}H_0\text{&#39;s: } &amp;t_{δ_{Lin}} ∼ t \implies\text{linear model is preferred} \\
&amp;t_{δ_{Log}} ∼ t \implies\text{log model is preferred}\end{aligned}\]</span><br />
If both <span class="math inline">\(H_0\)</span>’s are rejected, should consider more general models.</p>
<blockquote>
<p>PS4.Q2.5<br />
T/F?<br />
The PE test cannot be applied to compare a linear to an exponential specification.</p>
</blockquote>
<p>False.<br />
Just <span class="math inline">\(\log\)</span> both of them.</p>
</div>
<div id="chow-breakpoint-test" class="section level3">
<h3>Chow (Breakpoint) Test</h3>
<p>(textbook P75, slide 5 P17)<br />
<span class="math display">\[\begin{aligned}\text{Pooled Model: } y_i &amp;= x_i&#39; β + g_i x_i&#39; γ + ε_i \\ S_R &amp;= e&#39;e \\
\text{Split Models: } y_i &amp;=  x_i&#39;β_1 + ε_i &amp;&amp; i = 1, \dots, T^* \\
y_i &amp;=  x_i&#39;β_2 + ε_i &amp;&amp; i = T^*+1, \dots, n \\
S_{UR} &amp;= e_1&#39; e_1 + e_2&#39; e_2\end{aligned}\]</span><br />
<span class="math inline">\(H_0: \frac{\frac{1}{K} S_R - S_{UR}}{\frac{1}{N-2K}S_{UR}} ∼ F_{N-2K}^K\)</span><br />
<span class="math inline">\(N\)</span> is the number of observations, <span class="math inline">\(K\)</span> is the number of <span class="math inline">\(β\)</span> 's, and <span class="math inline">\(T^*\)</span> is the hypothetical breakpoint.<br />
Note: Chow test can also test two or more breakpoints / groups.</p>
<blockquote>
<p>PS4.Q2.6<br />
T/F?<br />
The Chow test cannot be applied in a cross-sectional regression.</p>
</blockquote>
<p>False.<br />
Chow test can also be used to detach groups in a cross-sectional regression.</p>
</div>
<div id="durbin-watson-test-autocorrelation" class="section level3">
<h3>Durbin-Watson Test (Autocorrelation)</h3>
<p>(textbook P120, slide 7 P7)</p>
<ul>
<li>(A2) all errors and independent variables are independent</li>
<li>Non-zero intercept</li>
<li>No lagged dependent variable (<span class="math inline">\(y_i\)</span>)</li>
</ul>
</div>
<div id="goldfeld-quandt-test-heteroskedasticity" class="section level3">
<h3>Goldfeld-Quandt Test (Heteroskedasticity)</h3>
<p>(slide 6 P20)</p>
</div>
<div id="breusch-pagan-test-heteroskedasticity" class="section level3">
<h3>Breusch-Pagan Test (Heteroskedasticity)</h3>
<p>(textbook P109, slide 6 P20)</p>
</div>
<div id="breusch-godfrey-test-autocorrelation" class="section level3">
<h3>Breusch-Godfrey Test (Autocorrelation)</h3>
<p>(slide 7 P12)</p>
</div>
<div id="box-pierce-test-autocorrelation" class="section level3">
<h3>Box-Pierce Test (Autocorrelation)</h3>
<p>(slide 7 P12)<br />
For <span class="math inline">\(ε_t = ρε_{t-1} + v_t\)</span>:<br />
<span class="math display">\[Q_m =T\cdot\sum_{j=1}^m \hat{ρ_j}^2\]</span><br />
<span class="math inline">\(H_0\)</span>: <span class="math inline">\(Q_m ∼^a χ^2_m\)</span><br />
<span class="math inline">\(T\)</span> is number of observations, <span class="math inline">\(m\)</span> is number of lags, and <span class="math inline">\(ρ\)</span> 's are parameters.</p>
</div>
<div id="sargan-test-give-overidentification" class="section level3">
<h3>Sargan Test (GIVE Overidentification)</h3>
<p>(textbook P168, slide 9-2 P14)</p>
</div>
<div id="durbin-wu-hausman-test-endogeneity" class="section level3">
<h3>Durbin-Wu-Hausman Test (Endogeneity)</h3>
<p>(textbook P154, slide 9-2 P15)</p>
</div>
<div id="read-regression-table" class="section level3">
<h3>Read Regression Table</h3>
<blockquote>
<p>PS3.Q1.2<br />
For model <span class="math inline">\(\log{Y_t} = \log τ + β_1\log K_t + β_2\log L_t (+ ε_t)\)</span>, consider the regression output:<br />
<img src="/post-img/notes-stat1--PS3Q1.png" width="406" /><br />
1. Test the significance of the elasticities at <span class="math inline">\(5\%\)</span> level.</p>
</blockquote>
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(β_1 = 0\)</span>, <span class="math inline">\(β_2 = 0\)</span><br />
<span class="math inline">\(H_1\)</span>: <span class="math inline">\(β_1 &gt; 0\)</span>, <span class="math inline">\(β_2 &gt;0\)</span><br />
Calculate critical value at <span class="math inline">\(5\%\)</span> and <span class="math inline">\(1\%\)</span> level, <span class="math inline">\(df = 40\)</span>:</p>
<pre class="r"><code>qt( 0.95, 40 )
## [1] 1.683851
qt( 0.99, 40 )
## [1] 2.423257</code></pre>
<p>Therefore, <span class="math inline">\(K\)</span> is significant at <span class="math inline">\(5\%\)</span> level, and <span class="math inline">\(L\)</span> is significant at <span class="math inline">\(1\%\)</span> level.</p>
<blockquote>
<p>PS3.Q1.2<br />
For model <span class="math inline">\(\log{Y_t} = \log τ + β_1\log K_t + β_2\log L_t (+ ε_t)\)</span>, consider the regression output:<br />
<img src="/post-img/notes-stat1--PS3Q1.png" width="406" /><br />
2. Conduct a test of explanatory power (all coefficients are zero except the intercept).</p>
</blockquote>
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(R^2_U = 0\)</span><br />
Calculate critical value at <span class="math inline">\(5\%\)</span> level, for two restrictions and <span class="math inline">\(df = 40\)</span>:</p>
<pre class="r"><code>qf( 0.95, 2, 40)
## [1] 3.231727</code></pre>
<p>As <span class="math inline">\(F = 1936 &gt;\)</span> 3.231727, <span class="math inline">\(H_0\)</span> is rejected.</p>
</div>
</div>
<div id="gauss-markov-assumptions" class="section level2">
<h2>Gauss-Markov Assumptions</h2>
<p>(A1) ~ (A4): textbook P15, slide 2 P23 = BLUE<br />
(A5): textbook P19, slide 2 P29 ~~~~~ = (A1) + (A3) + (A4) + normal<br />
(A6): textbook P34, slide 4 P10<br />
(A7): textbook P35, slide 4 P11 ~~~ <span class="math inline">\(\Longleftarrow\)</span> (A1), (A2) or (A8)<br />
(A8): textbook P37 ~~~~~~~~~~~~~ <span class="math inline">\(\Longleftarrow\)</span> (A2)</p>
<p>(A1): <span class="math inline">\(E[ε_i] = 0\)</span><br />
(A2): <span class="math inline">\(\{ε_1, \dots , ε_n\}\)</span> and <span class="math inline">\(\{x_1, \dots , x_N\}\)</span> are independent<br />
(A3): <span class="math inline">\(Var(ε_i) = σ^2\)</span><br />
(A4): <span class="math inline">\(Cov(ε_i, ε_j) = 0\)</span> for all <span class="math inline">\(i\neq j\)</span></p>
<p>(A5): <span class="math inline">\(ε ∼ \mathcal{N} (0, σ^2I_N) \iff ε_i ∼ NID (0, σ^2)\)</span><br />
(A6): <span class="math inline">\(\frac{1}{N} \sum^N_{i=1} x_ix_i&#39; \to^p \exists Σ_{xx}\)</span><br />
(A7): <span class="math inline">\(E[ε_i x_i] = 0\)</span><br />
(A8): <span class="math inline">\(ε_i\)</span> and <span class="math inline">\(x_i\)</span> are independent for all <span class="math inline">\(i\)</span></p>
<blockquote>
<p>PS2.Q2<br />
Consider the linear regression model:<br />
<span class="math display">\[y_t = β x_t + ε_t\]</span><br />
where <span class="math inline">\(ε_t ∼ N(0,σ_ε^2)\)</span>, <span class="math inline">\(x_t ∼ N(0,σ_x^2)\)</span>, and <span class="math inline">\(ε_t\)</span> and <span class="math inline">\(x_t\)</span> are independent.<br />
1. What does the independence imply for <span class="math inline">\(E[x_t ε_t]\)</span>?</p>
</blockquote>
<p>Since <span class="math inline">\(ε_t\)</span> and <span class="math inline">\(x_t\)</span> are independent, they are not correlated
<span class="math display">\[\begin{aligned} Corr(x_t, ε_t) = \frac{Cov(x_t, ε_t)}{\sqrt{Var(x_t) Var(ε_t)}} &amp;= 0 \\
Cov(x_t ε_t) &amp;= 0 \\ &amp;= E[x_t ε_t] - E[x_t] E[ε_t] \\ &amp;= E[x_t ε_t]\end{aligned}\]</span><br />
<span class="math inline">\(\implies E[x_t ε_t] = 0\)</span></p>
</div>
<div id="ols-error" class="section level2">
<h2>OLS Error</h2>
<div id="normality-of-" class="section level3">
<h3>Normality of <span class="math inline">\(ε\)</span></h3>
</div>
<div id="unbiasedness-of-s2" class="section level3">
<h3>Unbiasedness of <span class="math inline">\(s^2\)</span></h3>
<blockquote>
<p>PS1.Q2<br />
Consider the linear regression model:<br />
<span class="math display">\[\begin{aligned} y_i =x^′_i β+ε_i &amp;&amp; i=1, \dots ,N\end{aligned}\]</span><br />
with <span class="math inline">\(εi ∼ NID(0,σ2)\)</span>.<br />
Denote by K the number of regressors including the intercept.<br />
Show that <span class="math inline">\(\tilde{s}^2 = \frac{1}{N-1} \sum^N_{i=1} e_i^2\)</span> is a biased estimator, and <span class="math inline">\(s^2 = \frac{1}{N-K} \sum^N_{i=1} e_i^2\)</span> an unbiased estimator for <span class="math inline">\(σ^2\)</span>.<br />
Hint: Treat <span class="math inline">\(X\)</span> as fixed or deterministic (or alternatively, think of working conditionally on outcomes <span class="math inline">\(X\)</span>).<br />
~~~~ <span class="math inline">\(tr(AB) = tr(BA)\)</span> and <span class="math inline">\(tr(A + B) = tr(A) + tr(B)\)</span>.</p>
</blockquote>
<p>Rewrite the model in matrix form:<br />
<span class="math display">\[\mathbb{y} = X β + ε\]</span><br />
Let <span class="math inline">\(P_X \equiv X(X&#39; X)^{-1} X&#39;\)</span>, <span class="math inline">\(M_X = I_N - P_X\)</span>,<br />
<span class="math display">\[\begin{aligned} M_X X &amp;= \big( I_N − X (X&#39; X)^{-1} X&#39;\big) \cdot X \\
&amp;= X − X (X&#39; X)^{-1} X&#39; X \\ &amp;= X − X \\ &amp;= 0\end{aligned}\]</span><br />
Therefore,<br />
<span class="math display">\[\begin{aligned} \mathbb{e} &amp;= M_X \cdot \mathbb{y} \\ &amp;= M_X (X β + ε) \\ &amp;= M_X Xβ + M_X ε \\ &amp;= M_X ε\end{aligned}\]</span><br />
Sum of squared error:<br />
<span class="math display">\[\begin{aligned} \sum^N_{i=1} e_i^2 &amp;= \mathbb{e}&#39;\mathbb{e} \\ &amp;= tr(\mathbb{e}&#39;\mathbb{e}) \\
&amp;= tr(ε&#39; M_X&#39; M_X ε) \\ &amp;= tr(ε&#39; M_X ε) \\ &amp;= tr(M_X ε ε&#39;)\end{aligned}\]</span><br />
Take expectation of both sides<br />
<span class="math display">\[\begin{aligned} \mathbb{E} [\mathbb{e}&#39;\mathbb{e}] &amp;= tr \big( M_X \mathbb{E} (ε ε&#39;) \big) \\
&amp;= σ^2 \cdot tr(M_X) \\ &amp;= σ^2 \cdot tr \big( I_N - X(X&#39; X)^{-1} X&#39; \big) \\
&amp;= σ^2 \cdot tr(I_N) - σ^2 \cdot tr \big( X(X&#39; X)^{-1} X&#39; \big) \\
&amp;= σ^2 \cdot tr(I_N) - σ^2 \cdot tr \big( X&#39; X(X&#39; X)^{-1} \big) \\
&amp;= σ^2 \cdot tr(I_N) - σ^2 \cdot tr(I_K) \\ &amp;= σ^2(N - K)\end{aligned}\]</span><br />
Therefore,<br />
<span class="math display">\[\begin{aligned} E[s^2] &amp;= \frac{1}{N-K} \cdot E \left[ \sum^N_{i=1} e_i^2 \right] \\
&amp;= \frac{1}{N-K} \cdot σ^2(N - K) \\ &amp;= σ^2\end{aligned}\]</span><br />
<span class="math inline">\(\implies s^2\)</span> is unbiased.<br />
And <span class="math inline">\(E[\tilde{s}^2] = \frac{N-K}{N-1} \cdot σ^2 \implies \tilde{s}^2\)</span> is biased for small <span class="math inline">\(N\)</span>’s.</p>
</div>
<div id="consistency-of-s2" class="section level3">
<h3>Consistency of <span class="math inline">\(s^2\)</span></h3>
<ul>
<li>The least square estimator <span class="math inline">\(s^2\)</span> for error variance <span class="math inline">\(σ^2\)</span> is consistent if: (textbook P35)<br />
<span class="math display">\[\begin{cases} V(ε_i) = σ^2 &amp;&amp; \text{(A3)} \\ \frac{1}{N} \sum^N_{i=1} x_ix_i&#39; \to^p \exists Σ_{xx} &amp;&amp; \text{(A6)} \\ E[ε_i x_i] = 0 &amp;&amp; \text{(A7)}  \end{cases}\]</span> ~</li>
</ul>
</div>
</div>
<div id="ols-estimator" class="section level2">
<h2>OLS Estimator</h2>
<div id="derive-ols" class="section level3">
<h3>Derive OLS</h3>
<blockquote>
<p>PS1.Q1.3<br />
Consider the linear model <span class="math inline">\(y = Xβ + ε\)</span>.<br />
The OLS estimator minimizes the sum of squared residuals:<br />
<span class="math display">\[S(\tilde{β}) = ε′ε = (y − X\tilde{β})&#39; (y − X\tilde{β})\]</span><br />
1. Derive the first order condition of <span class="math inline">\(S(\tilde{β})\)</span>.<br />
~~ Find the solution of the minimization problem and state all needed assumptions.<br />
2. Check whether the solution in (1) is a minimum. Do you need any further assumption to verify that?</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Solve minimization problem<br />
<span class="math display">\[\begin{aligned} S(β) &amp;= (y − Xβ)&#39; (y − Xβ) \\
&amp;= (y&#39; - β&#39;X&#39;)(y − Xβ) \\ &amp;= y&#39;y - y&#39;Xβ -β&#39; X&#39; y + β&#39; X&#39; Xβ \\
&amp;= y&#39;y -2β&#39; X&#39; y + β&#39;X&#39;Xβ\end{aligned}\]</span><br />
FOC<br />
<span class="math display">\[\begin{aligned} \frac{\partial S(β)}{\partial β} = -2 X&#39; y + 2X&#39;X \hat{β} &amp;= 0 \\
X&#39;X \hat{β} &amp;= X&#39; y \\ \hat{β} &amp;= (X&#39;X)^{-1} X&#39; y\end{aligned}\]</span><br />
Assuming <span class="math inline">\(X&#39;X\)</span> is invertible <span class="math inline">\(\Longleftarrow X\)</span> is full-rank.<br />
</li>
<li>Check whether is minimum<br />
SOC<br />
<span class="math display">\[\frac{\partial ^2 S(β)}{\partial β \partial β&#39;} = 2X&#39; X\]</span><br />
<span class="math inline">\(\implies\)</span> the solution is a minimum if <span class="math inline">\(X&#39; X\)</span> is positive semi-definite.<br />
Take arbitrary <span class="math inline">\(a\neq 0\)</span>, let<br />
<span class="math display">\[\begin{aligned} q &amp;= a&#39; X&#39; Xa \\ &amp;= \sum^N_{i=0} x_i^2 a_i^2 \\ &amp;\geq 0\end{aligned}\]</span><br />
<span class="math inline">\(\implies\)</span> For all <span class="math inline">\(a\neq 0\)</span>, <span class="math inline">\(q &gt; 0\)</span>, <span class="math inline">\(X&#39; X\)</span> is positive semi-definite, no further assumptions needed.</li>
</ol>
<blockquote>
<p>PS2.Q2<br />
Consider the linear regression model:<br />
<span class="math display">\[y_t = β x_t + ε_t\]</span><br />
where <span class="math inline">\(ε_t ∼ N(0,σ_ε^2)\)</span>, <span class="math inline">\(x_t ∼ N(0,σ_x^2)\)</span>, and <span class="math inline">\(ε_t\)</span> and <span class="math inline">\(x_t\)</span> are independent.<br />
2. Verify that the OLS estimator can be written as<br />
<span class="math display">\[b = β + \left[ \sum_{t=1}^N x_t^2 \right] ^{-1} \sum_{t=1}^N x_t ε_t\]</span> ~</p>
</blockquote>
<p><span class="math display">\[\begin{aligned} b &amp;= (X′X)^{−1} X′ y \\
&amp;= β + (X&#39;X)^{-1} X&#39;ε \\
&amp;= β + \left[ \sum_{t=1}^N x_t^2 \right] ^{-1} \sum_{t=1}^N x_t ε_t \end{aligned}\]</span> ~</p>
</div>
<div id="normality-of-b" class="section level3">
<h3>Normality of <span class="math inline">\(b\)</span></h3>
<ul>
<li>OLS estimator is normally distributed with <span class="math inline">\(b ∼ \mathcal{N}\big(β, σ^2(X&#39;X)^{-1} \big)\)</span></li>
<li>Obtained if: (slide 2 P30)<br />
<span class="math display">\[\begin{cases} \{ε_1, \dots , ε_n\} \text{ and } \{x_1, \dots , x_N\} \text{ are independent} &amp;&amp; \text{(A2)} \\ε ∼ \mathcal{N} (0, σ^2I_N) &amp;&amp; \text{(A5)} \end{cases}\]</span> ~</li>
</ul>
<blockquote>
<p>PS4.Q2.2<br />
T/F?<br />
Under heteroskedastiticity and/or autocorrelation of the errors, the covariance matrix of the OLS estimator does not change in comparison to the case of homoscedasticity and absence of autocorrelation.</p>
</blockquote>
<p>False.<br />
Under heteroskedastiticity or autocorrelation,<br />
the covariance of the errors is different from benchmark case,<br />
thus the covariance matrix of OLS estimator also changes.</p>
<blockquote>
<p>PS2.Q2<br />
Consider the linear regression model:<br />
<span class="math display">\[y_t = β x_t + ε_t\]</span><br />
where <span class="math inline">\(ε_t ∼ N(0,σ_ε^2)\)</span>, <span class="math inline">\(x_t ∼ N(0,σ_x^2)\)</span>, and <span class="math inline">\(ε_t\)</span> and <span class="math inline">\(x_t\)</span> are independent.<br />
3. Use the LLN to find the appropriate scaling factor <span class="math inline">\(k\)</span> in <span class="math inline">\(\frac{1}{N^k} \sum^N_{t=1} x_t^2\)</span>.<br />
~~ What does <span class="math inline">\(\frac{1}{N^k} \sum^N_{t=1} x_t^2\)</span> converge to?<br />
Hint: Find <span class="math inline">\(E[x_t]\)</span> to characterize the object to which the scaled sum converges.</p>
</blockquote>
<p>LLN suggests <span class="math inline">\(k=1\)</span><br />
Since <span class="math inline">\(x_t ∼ N(0,σ_x^2)\)</span>, <span class="math inline">\(E[x_t] = 0\)</span>, <span class="math inline">\(Var(x_t) = σ_x^2\)</span><br />
<span class="math display">\[\begin{aligned} \frac{1}{N} \sum^N_{t=1} x_t^2 &amp;\to^p E[x_t^2] \\
&amp;= σ_x^2\end{aligned}\]</span> ~</p>
<blockquote>
<p>PS2.Q2<br />
Consider the linear regression model:<br />
<span class="math display">\[y_t = β x_t + ε_t\]</span><br />
where <span class="math inline">\(ε_t ∼ N(0,σ_ε^2)\)</span>, <span class="math inline">\(x_t ∼ N(0,σ_x^2)\)</span>, and <span class="math inline">\(ε_t\)</span> and <span class="math inline">\(x_t\)</span> are independent.<br />
4. To find the appropriate scaling factor <span class="math inline">\(k\)</span> in <span class="math inline">\(N^{−k} \sum^N_{t=1} x_t ε_t\)</span>, first find the variance of <span class="math inline">\(N^{−k} \sum^N_{t=1} x_t ε_t\)</span>.<br />
For which unique choice of <span class="math inline">\(k\)</span> does this variance neither approach zero, nor explode?<br />
Hence, find the value for <span class="math inline">\(k\)</span> which stabilizes the variance.</p>
</blockquote>
<p><span class="math display">\[\begin{aligned}Var\left( N^{−k} \textstyle{\sum}^N_{t=1} x_t ε_t \right) &amp;= (N^{-k})^2 \cdot Var\left( \textstyle{\sum}^N_{i=1} x_t ε_t \right) \\
&amp;= N^{-2k} \cdot Var\left( \textstyle{\sum}^N_{i=1} x_t ε_t \right)\\
Var\left( \textstyle{\sum}^N_{i=1} x_t ε_t \right) &amp;= Var(x_1 ε_1 + x_2 ε_2 + \cdots +x_N ε_N) \\
&amp;= \textstyle{\sum}^N_{i=1} Var(x_t ε_t ) \\
&amp;= \textstyle{\sum}^N_{i=1} \left[ Var(x_t) \cdot Var( ε_t ) \right] \\
&amp;= \textstyle{\sum}^N_{i=1} σ^2_x σ^2_ε  \\
&amp;= N \cdot σ^2_x σ^2_ε \\
Var\left( N^{−k} \textstyle{\sum}^N_{t=1} x_t ε_t \right) &amp;= N^{-2k} \cdot N \cdot σ^2_x σ^2_ε \\
&amp;= N^{1-2k} \cdot σ^2_x σ^2_ε\end{aligned}\]</span><br />
Set <span class="math inline">\(1 - 2k = 1\)</span>, <span class="math inline">\(k = \frac{1}{2}\)</span><br />
<span class="math display">\[\frac{1}{\sqrt{N}}\sum^N_{t=1} x_t ε_t \to^p σ^2_x σ^2_ε\]</span> ~</p>
<blockquote>
<p>PS2.Q2<br />
Consider the linear regression model:<br />
<span class="math display">\[y_t = β x_t + ε_t\]</span><br />
where <span class="math inline">\(ε_t ∼ N(0,σ_ε^2)\)</span>, <span class="math inline">\(x_t ∼ N(0,σ_x^2)\)</span>, and <span class="math inline">\(ε_t\)</span> and <span class="math inline">\(x_t\)</span> are independent.<br />
5. Consider the difference <span class="math inline">\(b − β\)</span>.<br />
Combine (3) and (4) to find the implied appropriate scaling (i.e. the convergence rate) of <span class="math inline">\(b − β\)</span>.</p>
</blockquote>
<p>We know<br />
<span class="math display">\[b-β = \left(\sum^N_{i=1} x_t^2 \right)^{-1} \sum^N_{i=1}x_t ε_t\]</span><br />
From (3) and (4):<br />
<span class="math display">\[\begin{aligned} \frac{1}{N} \sum^N_{t=1} x_t^2 &amp;\to^p σ_x^2 \\
\frac{1}{\sqrt{N}}\sum^N_{t=1} x_t ε_t &amp;\to^p σ_x^2 σ_ε^2 \end{aligned}\]</span><br />
Assume <span class="math inline">\(N^k(b-β)\)</span> converges in distribution, therefore<br />
<span class="math display">\[\begin{aligned} N^k(b-β) &amp;= N^k \cdot \left(\sum^N_{i=1} x_t^2 \right)^{-1} \sum^N_{i=1} x_t ε_t \\
&amp;= \left(\frac{1}{N}\sum^N_{i=1} x_t^2 \right)^{-1} \frac{1}{\sqrt{N}}\sum^N_{i=1} x_t ε_t \\
N^k &amp;= N \cdot \frac{1}{\sqrt{N}} \\
k &amp;= \frac{1}{2}\end{aligned}\]</span><br />
Therefore <span class="math inline">\(\sqrt{N}\)</span> is the implied convergence rate of <span class="math inline">\(b − β\)</span>.<br />
<span class="math display">\[\sqrt{N}(b − β) \to^d \mathcal{N} \big(0, (σ_x^2 σ_ε^2)(σ_x^2)^{-1} \big)\]</span><br />
Note that under standard notation, <span class="math inline">\(σ^2 \equiv σ_x^2 σ_ε^2\)</span>, <span class="math inline">\(Σ_{xx} \equiv σ_x^2\)</span><br />
<span class="math inline">\(\implies \sqrt{N}(b − β) \to^d \mathcal{N} (0, σ^2 Σ_{xx}^{-1})\)</span></p>
</div>
<div id="unbiasedness-of-b" class="section level3">
<h3>Unbiasedness of <span class="math inline">\(b\)</span></h3>
<ul>
<li>OLS estimator is unbiased when <span class="math inline">\(E(b) = β\)</span></li>
<li>Obtained if: (textbook P16, slide 2 P24)<br />
<span class="math display">\[\begin{cases} E[ε_i] = 0 &amp;&amp; \text{(A1)} \\ \{ε_1, \dots , ε_n\} \text{ and } \{x_1, \dots , x_N\} \text{ are independent} &amp;&amp; \text{(A2)}\end{cases}\]</span> ~</li>
</ul>
<blockquote>
<p>PS4.Q2.1<br />
T/F?<br />
Under heteroskedastiticity and/or autocorrelation of the errors, the OLS estimator is still unbiased.</p>
</blockquote>
<p>True.<br />
Unbiasedness is only conditional on the average of errors and independence between error and <span class="math inline">\(x\)</span>'s.</p>
</div>
<div id="consistent-of-b-asymptotic" class="section level3">
<h3>Consistent of <span class="math inline">\(b\)</span> (Asymptotic)</h3>
<ul>
<li>See the whole section: <a href="#ols-model">#OLS Model</a></li>
<li>OLS estimator is consistent when <span class="math inline">\(\lim P\{ |b_k - β_k| &gt; δ \} = 0​\)</span> for all <span class="math inline">\(δ &gt; 0​\)</span></li>
<li>Obtained if: (textbook P35)<br />
<span class="math display">\[\begin{cases} \frac{1}{N} \sum^N_{i=1} x_ix_i&#39; \to^p \exists Σ_{xx} &amp;&amp; \text{(A6)} \\ E[ε_i x_i] = 0 &amp;&amp; \text{(A7)}  \end{cases}\]</span> ~</li>
</ul>
<blockquote>
<p>PS5.Q4<br />
Consider the model with a latent (unobserved) variable <span class="math inline">\(y_i^*\)</span>:<br />
<span class="math display">\[y_i^∗ = x&#39;_i β + ε_i\]</span><br />
where <span class="math inline">\(ε_i ∼^{iid} N(0,σ^2_ε)\)</span> and is independent of <span class="math inline">\(x_i\)</span>, and <span class="math inline">\(x_i ∼^{iid} N(μ,σ^2_x)\)</span>.<br />
The dependent variable is observed with measurement error, i.e., <span class="math inline">\(y_i = y_i^∗ + v_i\)</span>,<br />
where <span class="math inline">\(v_i ∼^{iid} N(0,σ^2_v)\)</span> is independent of both <span class="math inline">\(x_j\)</span> and <span class="math inline">\(ε_j ∀j\)</span>.<br />
(The unobserved <span class="math inline">\(y_i\)</span> is sometimes called a latent variable.)<br />
Regress <span class="math inline">\(y_i\)</span> on <span class="math inline">\(x_i\)</span> to obtain an OLS estimate <span class="math inline">\(\tilde{β}\)</span>.<br />
1. Is <span class="math inline">\(\tilde{β}\)</span> a consistent estimator of <span class="math inline">\(β\)</span> ?</p>
</blockquote>
<p>Rewrite the model:<br />
<span class="math display">\[\begin{aligned} y_i - v_i &amp;= x_i&#39; β + ε_i \\ y_i &amp;= x_i&#39; β + ε_i + v_i\end{aligned}\]</span><br />
where <span class="math inline">\(ε_i\)</span> and <span class="math inline">\(v_i\)</span> are uncorrelated.<br />
Let <span class="math inline">\(ε_i + v_i = u_i \implies u_i ∼^{iid}N(0, σ^2_ε + σ^2_v)\)</span><br />
OLS estimator can be written as:<br />
<span class="math display">\[\begin{aligned} \tilde{β} &amp;= \left(\frac{1}{N}\sum^N_{i=1} x_i x_i&#39; \right) ^{-1} \frac{1}{N} \sum^N_{i=1} x_i y_i \\
&amp;= β + \left(\frac{1}{N}\sum^N_{i=1} x_i x_i&#39; \right) ^{-1} \frac{1}{N}\sum^N_{i=1} x_i u_i \\
\tilde{β} - β &amp;= \left(\frac{1}{N}\sum^N_{i=1} x_i x_i&#39; \right) ^{-1} \frac{1}{N}\sum^N_{i=1} x_i u_i \end{aligned}\]</span><br />
Apply LLN:
<span class="math display">\[\begin{aligned} \tilde{β} - β &amp;\to^p \text{plim}(\tilde{β} - β) \\
&amp;= \frac{\text{plim}\left(\frac{1}{N}\sum^N_{i=1} x_i u_i \right)}{\text{plim}\left(\frac{1}{N}\sum^N_{i=1} x_i x_i&#39; \right)} \\
&amp;= \frac{E[x_i u_i]}{Σ_{xx}}\end{aligned}\]</span></p>
<p>where <span class="math inline">\(x&#39;x \to Σ_{xx}\)</span> (A6).<br />
As long as <span class="math inline">\(E[x_i u_i] = 0\)</span> (A7), <span class="math inline">\(\tilde{β}\)</span> is consistent.</p>
<blockquote>
<p>PS5.Q4<br />
Consider the model<br />
<span class="math display">\[y^∗_i = x&#39;_i β + ε_i\]</span><br />
2. What happens to the consistency of <span class="math inline">\(\tilde{β}\)</span> if <span class="math inline">\(ε_i\)</span> and <span class="math inline">\(v_i\)</span> are correlated?</p>
</blockquote>
<p>Variance of <span class="math inline">\(u_i\)</span> changes as follows:<br />
<span class="math display">\[Var(u_i) = σ^2_ε + ε^2_v + 2Cov(ε_i, v_i)\]</span><br />
<span class="math inline">\(\implies u_i ∼^{iid}N \left( 0, σ^2_ε + ε^2_v + 2Cov(ε_i, v_i) \right)\)</span><br />
While everything remaining is unchanged, therefore the consistency of <span class="math inline">\(\tilde{β}\)</span>.</p>
</div>
<div id="efficienty" class="section level3">
<h3>Efficienty</h3>
<blockquote>
<p>PS1.Q4<br />
Assume that all Gauss-Markov assumptions are valid, and treat the regressor matrix as fixed.<br />
Consider the linear and unbiased OLS estimator:<br />
<span class="math display">\[b = (X′X)^{−1} X′y = Cy\]</span><br />
And another linear and unbiased estimator:<br />
<span class="math display">\[\tilde{b} = Wy, \ W = W(X)\]</span><br />
1. Verify that <span class="math inline">\(W X = I\)</span> holds due to unbiasedness (similar to <span class="math inline">\(CX = I\)</span>).</p>
</blockquote>
<p>Take expectation<br />
<span class="math display">\[\begin{aligned} E[\tilde{b}] &amp;= E[Wy] \\ &amp;= E\big[ W(Xβ + ε)\big] \\
&amp;= WXβ + W \cdot E[ε] \\ &amp;= WXβ\end{aligned}\]</span><br />
Since <span class="math inline">\(\tilde{b}\)</span> is unbiased,<br />
<span class="math display">\[\begin{aligned} E[\tilde{b}] = WXβ &amp;= β \\ WX &amp;= I\end{aligned}\]</span> ~</p>
<blockquote>
<p>PS1.Q4<br />
Consider the linear and unbiased OLS estimator:<br />
<span class="math display">\[b = (X′X)^{−1} X′y = Cy\]</span><br />
And another linear and unbiased estimator:<br />
<span class="math display">\[\tilde{b} = Wy, \ W = W(X)\]</span><br />
2. Find the covariance matrix of <span class="math inline">\(\tilde{b}\)</span>, i.e. <span class="math inline">\(V(\tilde{b})\)</span>.</p>
</blockquote>
<p><span class="math display">\[\begin{aligned} V(\tilde{b}) &amp;= E \big[ (\tilde{b} - β)(\tilde{b} - β)&#39; \big] \\
&amp;= E \big[ (WXβ + Wε - β)(WXβ + Wε - β)&#39; \big] \\ &amp;= E \big[ (Iβ + Wε - β)(Iβ + Wε - β)&#39; \big] \\ &amp;= E[ Wε ε&#39; W&#39;] \\
&amp;= W \cdot E[ε ε&#39;] \cdot W&#39; \\ &amp;= σ^2 WW&#39; \end{aligned}\]</span> ~</p>
<blockquote>
<p>PS1.Q4<br />
Consider the linear and unbiased OLS estimator:<br />
<span class="math display">\[b = (X′X)^{−1} X′y = Cy\]</span><br />
And another linear and unbiased estimator:<br />
<span class="math display">\[\tilde{b} = Wy, \ W = W(X)\]</span><br />
3. Compare the covariance matrices of <span class="math inline">\(\tilde{b}\)</span> and <span class="math inline">\(b\)</span> by building their difference <span class="math inline">\(V (\tilde{b}) − V (b)\)</span>.<br />
~~ Show in the final step that the difference between the covariance matrices is positive semi-definite.</p>
</blockquote>
<p><span class="math display">\[\begin{aligned} V (\tilde{b}) − V (b) &amp;= σ^2 WW&#39; - σ^2 (X&#39;X)^{-1} \\
&amp;= σ^2 \big[ WW&#39; - (X&#39;X)^{-1} \big] \\
&amp;= σ^2 \big[ WW&#39; - WX \cdot (X&#39;X)^{-1}\cdot (WX)&#39; \big] \\
&amp;= σ^2 \big[ WW&#39; - WX \cdot (X&#39;X)^{-1} \cdot X&#39;W&#39; \big] \\
&amp;= σ^2 \left\{ W \big[ I - X(X&#39;X)^{-1}X&#39; \big] W&#39; \right\} \\
&amp;= σ^2 W M_X W&#39;\end{aligned}\]</span><br />
Take arbitrary <span class="math inline">\(a \neq 0\)</span><br />
<span class="math display">\[\begin{aligned} a&#39; (σ^2 W M_X W&#39;) a &amp;= σ^2 a&#39; W M_X W&#39; a \\
&amp;= σ^2 a&#39; W M_X M_X W&#39; a \\
&amp;= σ^2 (M_X W&#39; a)&#39; (M_X W&#39; a) \\ &amp;\geq 0\end{aligned}\]</span><br />
Therefore, the difference <span class="math inline">\(V (\tilde{b}) − V (b)\)</span> is positive semi-definite.<br />
<span class="math inline">\(\implies\)</span> Any unbiased linear estimator cannot offer a variance smaller than the OLS estimator.</p>
</div>
<div id="blue-best-linear-unbiased-estimator" class="section level3">
<h3>BLUE (Best Linear Unbiased Estimator)</h3>
<ul>
<li>OLS estimator is BLUE when <span class="math inline">\(V(\tilde{b}) \geq V(b) \iff V(\tilde{b}) - V(b)\)</span> is positive semi-definite</li>
<li>Obtained if (A1) ~ (A4) are all satisfied (textbook P17, slide 2 P26)</li>
</ul>
</div>
<div id="can-consistent-and-asymptotically-normal" class="section level3">
<h3>CAN (Consistent and Asymptotically Normal)</h3>
<ul>
<li>OLS estimator is CAN when <span class="math inline">\(\sqrt{N} (b-β) \to^a \mathcal{N}(0, σ^2 Σ_{xx}^{-1})\)</span></li>
<li>Obtained if (A1) ~ (A4) + (A6) are satisfied (textbook P36, slide 4 P13)</li>
<li><span class="math inline">\(\sqrt{N}\)</span> is called the rate of convergence</li>
</ul>
</div>
</div>
<div id="ols-model" class="section level2">
<h2>OLS Model</h2>
<div id="converge-in-probability-mean-square" class="section level3">
<h3>Converge in Probability &amp; Mean Square</h3>
<ul>
<li>Vector sequence <span class="math inline">\(\{x_n\}\)</span> converges in p when <span class="math inline">\(\mathbb{P}\{ \|x_n - x\| &gt; \exists δ\} \to 0\)</span> as <span class="math inline">\(N \to \infty\)</span></li>
<li>Also: <span class="math inline">\(x_n \to^p x\)</span> or <span class="math inline">\(\text{plim } x_n = x\)</span></li>
<li><span class="math inline">\(x_n \to^p x \implies g(x_n) \to^p g(x)\)</span> for all continuous function <span class="math inline">\(g\)</span></li>
</ul>
<p>~</p>
<ul>
<li>Scalar sequence <span class="math inline">\(\{x_n\}\)</span> converges in ms when <span class="math inline">\(E\big[ (x_n - x)^2 \big] \to 0\)</span> as <span class="math inline">\(N \to \infty\)</span></li>
<li>Also: <span class="math inline">\(x_n \to^{ms} x\)</span></li>
<li><span class="math inline">\(x_n \to^{ms} x \implies x_n \to^p x\)</span></li>
<li><span class="math inline">\(x_n \to^{ms} α \implies E[x_n] \to α\)</span> and <span class="math inline">\(Var(x_n) \to 0\)</span></li>
</ul>
</div>
<div id="lln-law-of-large-numbers" class="section level3">
<h3>LLN (Law of Large Numbers)</h3>
<ul>
<li><span class="math inline">\(\frac{1}{N}\sum^N_{i=1} x_n \to^p E[x]\)</span> as <span class="math inline">\(N \to \infty\)</span>, if <span class="math inline">\(\{x_n\}\)</span> are <span class="math inline">\(i.i.d\)</span> copies of <span class="math inline">\(\mathbb{x}\)</span></li>
<li>(A6) + (A7) + LLN = <a href="#consistent-of-b-asymptotic">Asymptotic Consistency of OLS estimator</a></li>
</ul>
<p>Under LLN:<br />
<span class="math display">\[\begin{aligned}\frac{1}{N} \sum^N_{i=1} x_i x_i&#39; \to^p Σ_{xx}^{-1} &amp;&amp; \text{(A6)}\end{aligned}\]</span><br />
and<br />
<span class="math display">\[\begin{aligned} \frac{1}{N}\sum x_i ε_i &amp;\to^p E[x_i ε_i] \\
b - β = \left( \frac{1}{N} \sum x_i x_i’ \right)^{-1} \left( \frac{1}{N} \sum x_i ε_i \right) &amp;\to^p Σ_{xx}^{-1} \cdot E[x_i ε_i] \end{aligned}\]</span><br />
If <span class="math inline">\(E[x_i ε_i]\)</span> (A7), then <span class="math inline">\(b - β \to 0\)</span></p>
<blockquote>
<p>PS4.Q2.7<br />
T/F?<br />
The LLN states that sample moments converge in probability to their population counterparts.</p>
</blockquote>
<p>True.<br />
According to LLN:<br />
<span class="math display">\[\begin{aligned} \frac{1}{N}\sum x_i ε_i &amp;\to^p E[x_i ε_i] \\
\implies \frac{1}{N}\sum y_i^2 &amp;\to^p E[y_i^2]\end{aligned}\]</span><br />
~</p>
</div>
<div id="loglinear-model" class="section level3">
<h3>Loglinear Model</h3>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th>Dependent Var</th>
<th>Independent Var</th>
<th><span class="math inline">\(β\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>level-level</td>
<td><span class="math inline">\(y\)</span></td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(Δy = β Δx\)</span></td>
</tr>
<tr class="even">
<td>level-log</td>
<td><span class="math inline">\(y\)</span></td>
<td><span class="math inline">\(\log x\)</span></td>
<td><span class="math inline">\(Δy = \frac{β}{100}\% Δx\)</span></td>
</tr>
<tr class="odd">
<td>log-level</td>
<td><span class="math inline">\(\log y\)</span></td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\% Δy = (100\cdot β)Δx\)</span></td>
</tr>
<tr class="even">
<td>log-log</td>
<td><span class="math inline">\(\log y\)</span></td>
<td><span class="math inline">\(\log x\)</span></td>
<td><span class="math inline">\(\% Δy = β\% Δx\)</span></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Mock.Q1.1<br />
Consider the following nonlinear relationship between two economic variables <span class="math inline">\(y_t&gt;0\)</span> and <span class="math inline">\(x_t\)</span>, <span class="math inline">\(α&gt;0\)</span> and <span class="math inline">\(γ&gt;0\)</span> are parameters:<br />
<span class="math display">\[y_t = α \exp(γ\cdot x_t)\]</span><br />
1. Linearize the relationship and state a corresponding linear regression model with parameters <span class="math inline">\(β_1\)</span> and <span class="math inline">\(β_2\)</span>.<br />
2. Explain whether your regression model is a (i) level-level, (ii) level-log, (iii) log-level or (iv) log-log specification.<br />
3. How should the slope parameter in your derived regression model be interpreted?</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\log y_t = β_1 + β_2\cdot x_t + ε_t\)</span>, where <span class="math inline">\(β_1 = \log α\)</span> and <span class="math inline">\(β_2 = γ\)</span><br />
</li>
<li>This is a log-level model, since the dependent variable is in <span class="math inline">\(\log\)</span> form and the independent variable is not.<br />
</li>
<li><span class="math display">\[\begin{aligned} Δ\log y_t &amp;= Δ x_t\cdot β_2 \\
β_2 &amp;= \frac{Δ\log y_t}{Δ x_t}\end{aligned}\]</span><br />
Therefore, <span class="math inline">\(β_2\)</span> can be interpreted as the expected percentage change of <span class="math inline">\(y_t\)</span> given one unit change of <span class="math inline">\(x_t\)</span>, held everhthing else constant</li>
</ol>
<blockquote>
<p>Mock.Q1.2<br />
Consider the following nonlinear relationship between two economic variables <span class="math inline">\(y_t&gt;0\)</span> and <span class="math inline">\(x_t\)</span>, <span class="math inline">\(α&gt;0\)</span> and <span class="math inline">\(γ&gt;0\)</span> are parameters:<br />
<span class="math display">\[y_t = α \exp(γ\cdot x_t)\]</span><br />
1. Which assumptions on the error term in your regression model are needed s.t. <span class="math inline">\(s^2(X&#39;X)^{-1}\)</span> be an appropriate estimator for the covariance matrix of the OLS estimator <span class="math inline">\(b\)</span> for <span class="math inline">\((β_1, β_2)&#39;\)</span>?<br />
(<span class="math inline">\(X\)</span> denotes the full-rank regressor matrix in your regression model, and <span class="math inline">\(s^2\)</span> is an unbiased estimator of the residual variance <span class="math inline">\(σ^2\)</span>.)<br />
2. Explain the influence of the variation in (i) the residuals and (ii) the regressor matrix on the precision of the OLS estimator based oh the covariance matrix <span class="math inline">\(σ^2(X&#39;X)^{-1}\)</span></p>
</blockquote>
<ol style="list-style-type: decimal">
<li>When <span class="math inline">\(s^2(X&#39;X)^{-1}\)</span> is an appropriate estimator for <span class="math inline">\(b\)</span>, all four Gauss-Markov assumptions are needed.<br />
<span class="math inline">\(E[ε_t] = 0\)</span>, <span class="math inline">\(Var(ε_t) = σ^2\)</span>, <span class="math inline">\(Cov(ε_t, ε_t&#39;) = 0\)</span> for normal errors, and independence between <span class="math inline">\(ε\)</span> and <span class="math inline">\(x\)</span>.<br />
</li>
<li>Larger variance in residuals causes larger variance (less precise) of the OLS estimator,<br />
while larger variance in the regressors causes the OLS estimator to be more precise.</li>
</ol>
<blockquote>
<p>Mock.Q1.3<br />
Consider the following nonlinear relationship between two economic variables <span class="math inline">\(y_t&gt;0\)</span> and <span class="math inline">\(x_t\)</span>, <span class="math inline">\(α&gt;0\)</span> and <span class="math inline">\(γ&gt;0\)</span> are parameters:<br />
<span class="math display">\[y_t = α \exp(γ\cdot x_t)\]</span><br />
Suppose that you are unsure whether to include an additional regressor <span class="math inline">\(z_t\)</span> to your linear regression model.<br />
1. Describe three valid procedures to decide whether the additional regressor shall be included or not.<br />
2. Give two conditions under which the omission of <span class="math inline">\(z_t\)</span> is unproblematic for the OLS estimator in your linearized model (excluding <span class="math inline">\(z_t\)</span>).</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><ol style="list-style-type: decimal">
<li>Regress the model <span class="math inline">\(\log y_t = β_1 + β_2\cdot x_t + β_3\cdot z_t + ε_t\)</span>, and test with <span class="math inline">\(H_0\)</span>: <span class="math inline">\(β_3=0\)</span><br />
</li>
<li>Compare <span class="math inline">\(\bar{R^2}\)</span> of the two specifications<br />
</li>
<li>Compare AIC or BIC of the two specifications<br />
</li>
</ol></li>
<li>If <span class="math inline">\(β_3=0\)</span> is not rejected, or AIC / BIC is not decreased by the inclusion of <span class="math inline">\(z_t\)</span>, then it is ok to omit it.</li>
</ol>
<blockquote>
<p>Mock.Q1.4<br />
Consider the following nonlinear relationship between two economic variables <span class="math inline">\(y_t&gt;0\)</span> and <span class="math inline">\(x_t\)</span>, <span class="math inline">\(α&gt;0\)</span> and <span class="math inline">\(γ&gt;0\)</span> are parameters:<br />
<span class="math display">\[y_t = α \exp(γ\cdot x_t)\]</span><br />
As an alternative to linearization, one may directly consider the nonlinear regression model <span class="math inline">\(y_t = α \exp(γ\cdot x_t)+ε_t\)</span> with the additional assumption that <span class="math inline">\(ε_t∼^{iid} \mathcal{N}(0,σ^2)\)</span><br />
1. Outline two appropriate estimntors for <span class="math inline">\((α,γ)&#39;\)</span> other than the OLS estimator (maximal 4 sentences)<br />
2. For a comparison between your linear regression specification and the given nonlinear one, would it be correct to consider the (adjusted) <span class="math inline">\(R^2\)</span> values?</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Maximum likelihood model (does not assume the errors are normal)<br />
Non-linear model: <span class="math inline">\(y_t = α \exp(γ\cdot x_t) + ε_t\)</span><br />
</li>
<li>No, because <span class="math inline">\(R^2\)</span> is conditional on the form of <span class="math inline">\(y_t\)</span></li>
</ol>
</div>
<div id="elasticity" class="section level3">
<h3>Elasticity</h3>
<ul>
<li>Elasticity measures the relative change in the dependent variable owing to a relative change in one of the <span class="math inline">\(x_i\)</span> variables.<br />
</li>
<li>For <span class="math inline">\(\log y_i = (\log x_i)&#39; γ + v_i\)</span>, elasticity:<br />
<span class="math display">\[\begin{aligned} \frac{\partial E[y_i|x_i] / E[y_i|x_i]}{\partial x_{ik} / x_{ik}} &amp;= \frac{\partial E[y_i|x_i]}{\partial x_{ik}} \cdot \frac{\partial x_{ik}}{E[y_i|x_i]} \\
&amp;\approx \frac{\partial E[\log y_i | \log x_i]}{\partial \log x_{ik}} \\ &amp;= γ_k \end{aligned}\]</span><br />
</li>
<li>For <span class="math inline">\(y_i = x_i&#39; β + ε_i\)</span>, elasticity:<br />
<span class="math display">\[\begin{aligned} \frac{\partial E[y_i|x_i] / E[y_i|x_i]}{\partial x_{ik} / x_{ik}} &amp;= \frac{\partial E[y_i|x_i]}{\partial x_{ik}} \cdot \frac{\partial x_{ik}}{E[y_i|x_i]} \\
&amp;= β_k \cdot \frac{x_{ik}}{x_i&#39; β} \end{aligned}\]</span> ~</li>
</ul>
<blockquote>
<p>PS3.Q1.1<br />
Consider the Cobb-Douglas production function:<br />
<span class="math display">\[Y =F(K,L)=τK^{β_1}L^{β_2}\]</span><br />
where <span class="math inline">\(F\)</span> is the production function, <span class="math inline">\(K\)</span> capital and <span class="math inline">\(L\)</span> labor.<br />
Technology is assumed to be constant and represented by <span class="math inline">\(τ\)</span>.<br />
1. Which coefficients are elasticities?</p>
</blockquote>
<p>For <span class="math inline">\(K\)</span>:<br />
<span class="math display">\[\begin{aligned} \frac{\partial Y}{\partial K}\cdot\frac{K}{Y} &amp;= τβ_1K^{β_1-1}L^{β_2} \cdot \frac{K}{Y} \\
&amp;= \frac{τβ_1K^{β_1}L^{β_2}}{τK^{β_1}L^{β_2}} \\
&amp;= β_1\end{aligned}\]</span><br />
For <span class="math inline">\(L\)</span>:<br />
<span class="math display">\[\begin{aligned} \frac{\partial Y}{\partial L}\cdot\frac{L}{Y} &amp;= τβ_2K^{β_1}L^{β_2-1} \cdot \frac{K}{Y} \\
&amp;= \frac{τβ_2K^{β_1}L^{β_2}}{τK^{β_1}L^{β_2}} \\
&amp;= β_2\end{aligned}\]</span><br />
Therefore, <span class="math inline">\(β_1\)</span> and <span class="math inline">\(β_2\)</span> are the elasticities.</p>
<blockquote>
<p>PS3.Q1.1<br />
2. Specify the econometric model you think is appropriate to estimate the coefficients of the production function.</p>
</blockquote>
<p>Take log:<br />
<span class="math display">\[\log{Y_t} = \log τ + β_1\log K_t + β_2\log L_t (+ ε_t)\]</span> ~</p>
<blockquote>
<p>PS2.Q3<br />
Consider the wage regressions from slide 5 (text P86).<br />
<img src="/post-img/notes-stat1--PS2Q3-6.png" width="393" /><br />
6. Find the estimated elasticities for the effect of experience for males and females.<br />
At which conventional level is the gender effect of experience significant?<br />
Is the gender effect (measured by the male dummy coefficient) significant at <span class="math inline">\(10 \%\)</span> or <span class="math inline">\(5 \%\)</span> level when using a one-sided alternative (namely, positive coefficient)?</p>
</blockquote>
<p>Elasticity for female: <span class="math inline">\(0.207\)</span><br />
Elasticity for male: <span class="math inline">\(0.207 + 0.041 = 0.248\)</span><br />
Gender effect: <span class="math inline">\(0.041\)</span><br />
t-ratio: <span class="math inline">\(1.891\)</span></p>
<pre class="r"><code># calculate critical value
qnorm( 0.90 )
## [1] 1.281552
qnorm( 0.95 )
## [1] 1.644854</code></pre>
<p>Therefore, <span class="math inline">\(H_0\)</span> is rejected at <span class="math inline">\(10 \%\)</span> level, but not rejected at <span class="math inline">\(5 \%\)</span> level.</p>
</div>
</div>
<div id="iv-instrument-variable" class="section level2">
<h2>IV (Instrument Variable)</h2>
<div id="derive-iv" class="section level3">
<h3>Derive IV</h3>
<p>(textbook P150, slide 9-1)<br />
Consider model<br />
<span class="math display">\[y_i = x_{1i}&#39; β_1 + x_{2i} β_2 + ε_i\]</span><br />
Moment (expectation) conditions:<br />
<span class="math display">\[\begin{aligned} E[ε_i x_{1i}] &amp;= E\left[ (y_i - x_{1i}&#39; β_1 + x_{2i} β_2) x_{1i}\right] = 0 &amp;&amp; \text{(1)}\\
E[ε_i x_{2i}] &amp;= E\left[ (y_i - x_{1i}&#39; β_1 + x_{2i} β_2) x_{2i}\right] = 0 &amp;&amp; \text{(2)}\end{aligned}\]</span><br />
If <span class="math inline">\(E[ε_i x_{2i}] \neq 0\)</span>, OLS gives inconsistent estimator of <span class="math inline">\(β_2\)</span>, need to find instrument variable <span class="math inline">\(z_{2i}\)</span> s.t. (exogeneity)<br />
<span class="math display">\[\begin{aligned} E[ε_i z_{2i}] = E\left[ (y_i - x_{1i}&#39; β_1 + x_{2i} β_2) z_{2i}\right] = 0  &amp;&amp; \text{(3)} \end{aligned}\]</span><br />
Solving (1) and (3) gives consistent estimator <span class="math inline">\(\hat{β}_{IV}\)</span>.</p>
<p>Test relavance of <span class="math inline">\(z_{2i}\)</span>:<br />
<span class="math display">\[\text{Auxiliary Regression: }x_{2i} = x_{1i}&#39; π_1 + z_{2i} π_2 + v_i\]</span><br />
should yield <span class="math inline">\(π_2 \neq 0\)</span>.</p>
</div>
<div id="iv-estimator-hat_iv" class="section level3">
<h3>IV Estimator <span class="math inline">\(\hat{β}_{IV}\)</span></h3>
<blockquote>
<p>PS5.Q1<br />
Show that <span class="math inline">\(\hat{β}_{IV} =(X&#39;ZW_N Z′X)^{−1}X&#39;ZW_N Z&#39;y\)</span> minimizes<br />
<span class="math display">\[\begin{aligned} Q_N(β) &amp;= \left[ \frac{1}{N}\sum_{i=1}^N (y_i - x_i&#39; β)z_i \right]&#39; W_N \left[ \frac{1}{N}\sum_{i=1}^N (y_i - x_i&#39; β)z_i \right] \\
&amp;= \left[ \frac{1}{N}Z&#39; (y - X β) \right]&#39; W_N \left[ \frac{1}{N}Z&#39; (y - X β) \right] \end{aligned}\]</span> ~</p>
</blockquote>
<p><span class="math display">\[\begin{aligned} Q_N(β) &amp;=  \frac{1}{N^2}\left[ (y&#39; - β&#39;X&#39;)Z W_N (Z&#39;y - Z&#39;X β) \right]
\\ &amp;= \frac{1}{N^2}\left[ y&#39;ZW_NZ&#39;y - y&#39;ZW_N Z&#39;Xβ - β&#39;X&#39;Z W_N Z&#39;y + β&#39;X&#39; Z W_N Z&#39;yβ \right] \\
&amp;= \frac{1}{N^2}\left[ y&#39;ZW_NZ&#39;y - 2\left( β&#39;X&#39;Z W_N Z&#39;y \right)  + β&#39;X&#39; Z W_N Z&#39;yβ \right] \end{aligned}\]</span><br />
FOC<br />
<span class="math display">\[\begin{aligned}\frac{\partial Q}{\partial β} &amp;= -2 X&#39;ZW_N Z&#39;y + 2X&#39;ZW_N Z&#39;Xβ = 0  \\ \hat{β} &amp;= (X&#39;ZW_N Z&#39;X)^{-1} (X&#39;ZW_N Z&#39;y) \end{aligned}\]</span> ~</p>
<blockquote>
<p>PS5.Q2<br />
In model <span class="math inline">\(y = Xβ+ε\)</span>,<br />
Derive the covariance matrix of IV estimator <span class="math inline">\(\hat{β}_{IV} = (Z&#39;X)^{−1}Z&#39;y\)</span> with homoskedastic and serially uncorrelated errors.<br />
Argue why the correlation between instruments and regressors matter for the precision of the IV estimator.<br />
What happens in the limiting case when this correlation approaches zero?</p>
</blockquote>
<p><span class="math display">\[\begin{aligned}\hat{β}_{IV} &amp;= (Z&#39;X)^{−1}Z&#39;y \\
&amp;= (X&#39;ZZ&#39;X)^{-1}X&#39;ZZ&#39;y \\
&amp;= (Z&#39;X)^{-1}(X&#39;Z)^{-1}(X&#39;Z)^{-1}Z&#39;y \\
&amp;= (Z&#39;X)^{-1}Z&#39;y \\
&amp;= (Z&#39;X)^{-1}Z&#39;(Xβ+ε) \\
&amp;= (Z&#39;X)^{-1}Z&#39;Xβ + (Z&#39;X)^{-1}Z&#39;ε \\
&amp;= β + (Z&#39;X)^{-1}Z&#39;ε\end{aligned}\]</span><br />
Derive <span class="math inline">\(V(\hat{β}_{IV})\)</span>:<br />
<span class="math display">\[\begin{aligned}V(\hat{β}_{IV}) &amp;= E\left[ (\hat{β}_{IV} - β)^2 \right] \\
&amp;= E \left[ \left( (Z&#39;X)^{-1}Z&#39;ε \right)^2 \right] \\
&amp;= σ^2 (Z&#39;X)^{-1}Z&#39;Z(X&#39;Z)^{-1}\end{aligned}\]</span> ~</p>
</div>
<div id="give-generalized-iv-estimator" class="section level3">
<h3>GIVE (Generalized IV Estimator)</h3>
<p>(textbook P166, slide 9-2 P8)<br />
Also known as: 2SLS (two-stage least squares) estimator</p>
<blockquote>
<p>PS5.Q3<br />
Derive the GIVE.<br />
1. Start with the first stage regression <span class="math inline">\(X = Zγ + v\)</span> and obtain its fitted values <span class="math inline">\(\hat{X}\)</span>.<br />
~~ Show that the first stage fit <span class="math inline">\(\hat{X}\)</span> is given by <span class="math inline">\(P_ZX\)</span> with <span class="math inline">\(P_Z = Z(Z′Z)^{−1}Z′\)</span>.<br />
2. Consider OLS estimator in the second stage, based on fitted values <span class="math inline">\(\hat{X}\)</span>: <span class="math inline">\(y = \hat{X} β + ε\)</span>.<br />
~~ Show that the resulting estimator equals the GIVE.<br />
3. Derive the covariance matrix of the GIVE under homoskedasticity and absence of autocorrelation.<br />
~~ Compare the results with PS5.Q2.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><p>First stage regression: <span class="math inline">\(X = Zγ + v\)</span><br />
According to OLS, <span class="math inline">\(\hat{γ} = (Z&#39;Z)^{-1}Z&#39;X\)</span><br />
Fitted values:<br />
<span class="math display">\[\begin{aligned}\hat{X} &amp;= Z \cdot\hat{γ} \\&amp;= Z(Z&#39;Z)^{-1}ZX \\ &amp;= P_Z X\end{aligned}\]</span><br />
<span class="math inline">\(P_Z\)</span> is symmetric:<br />
<span class="math display">\[\begin{aligned} P_Z&#39; &amp;= \left[Z(Z&#39;Z)^{-1}Z&#39; \right]&#39; \\ &amp;= Z(Z&#39;Z)^{-1}Z&#39; \\ &amp;= P_Z\end{aligned}\]</span><br />
<span class="math inline">\(P_Z\)</span> is idopotent:<br />
<span class="math display">\[\begin{aligned} P_ZP_Z &amp;= Z(Z&#39;Z)^{-1}Z&#39; \cdot Z(Z&#39;Z)^{-1}Z&#39; \\
&amp;= Z(Z&#39;Z)^{-1}Z \\
&amp;= P_Z\end{aligned}\]</span> ~</p></li>
<li><p>Second stage regression: <span class="math inline">\(y = \hat{X}β+ ε\)</span><br />
According to OLS, <span class="math inline">\(b = \big(\hat{X}&#39;\hat{X}\big)^{-1} \hat{X}&#39;y\)</span><br />
Therefore<br />
<span class="math display">\[\begin{aligned} \hat{X} &amp;= P_Z X \\
\hat{X}&#39; &amp;= X&#39;P_Z&#39; \\
&amp;= X&#39;P_Z\end{aligned}\]</span><br />
<span class="math display">\[\begin{aligned}b &amp;= (X&#39;P_Z P_ZX)^{-1} X&#39;P_Z y \\
&amp;= (X&#39;P_ZX)^{-1} X&#39;P_Z y \\
&amp;= \big( X&#39;Z(Z&#39;Z)^{-1}ZX\big)^{-1} X&#39;Z(Z&#39;Z)^{-1}Z&#39; y \end{aligned}\]</span> ~</p></li>
<li><p>Variance: (needs check)<br />
<span class="math display">\[\begin{aligned}V(b) &amp;= σ^2 (\hat{X}&#39; \hat{X})^{-1} \\
&amp;= σ^2 (X&#39;P_Z X)^{-1} \\
&amp;= σ^2 (X&#39;Z(Z&#39;Z)^{-1}Z&#39; X)^{-1} \\
&amp;= σ^2 (Z&#39;X)^{-1}Z&#39;Z(X&#39;Z)^{-1}\end{aligned}\]</span> ~</p></li>
</ol>
</div>
</div>
<div id="heteroskedasticity-autocorrelation" class="section level2">
<h2>Heteroskedasticity &amp; Autocorrelation</h2>
<div id="white-hetero-consistent-standard-error" class="section level3">
<h3>White (Hetero-Consistent) Standard Error</h3>
<p>(slide 6 P18)</p>
<blockquote>
<p>PS4.Q2.4<br />
T/F?<br />
When applying White robust standard errors under heteroskedasticity, the t-statistics change in comparison to the case of regular standard errors assuming homoskedasticity.</p>
</blockquote>
<p>True.</p>
</div>
<div id="hac-robust-standard-error" class="section level3">
<h3>HAC (Robust) Standard Error</h3>
<p>(textbook P128, slide 7 P14)</p>
<blockquote>
<p>PS4.Q2.3<br />
T/F?<br />
When applying robust standard errors, the <strong>OLS point estimates</strong> (estimators) do not change.</p>
</blockquote>
<p>True.</p>
</div>
</div>
<div id="maximum-likelihood-model" class="section level2">
<h2>Maximum Likelihood Model</h2>
</div>
<div id="time-series" class="section level2">
<h2>Time Series</h2>
<div id="types-of-process" class="section level3">
<h3>Types of Process</h3>
<ul>
<li>White Noise: <span class="math inline">\(ε_t\)</span>
<ul>
<li>Zero mean, homoskedastic (<span class="math inline">\(σ^2\)</span>), no autocorrelation</li>
</ul></li>
<li>MA(1): <span class="math inline">\(Y_t = μ + ε_t + αε_{t-1}\)</span> (always stationary)
<ul>
<li><span class="math inline">\(E[Y_t] = μ\)</span></li>
<li><span class="math inline">\(Var(Y_t) = (1 + α^2)σ^2\)</span></li>
<li><span class="math inline">\(Cov(Y_t,Y_{t-k}) = \begin{cases} ασ^2 &amp; k=1\\ 0 &amp; k\geq 2\end{cases}\)</span></li>
</ul></li>
<li>AR(1): <span class="math inline">\(Y_t = δ + θ Y_{t-1} + ε_t\)</span>
<ul>
<li><span class="math inline">\(E[Y_t] = δ + θ E[Y_{t-1}] = \frac{δ}{1-θ} = μ\)</span> (when stationary)</li>
<li><span class="math inline">\(Var(Y_t) = θ^2Var(Y_{t-1}) + Var(ε_t) = \frac{σ^2}{1-θ^2}\)</span> (when stationary)</li>
<li><span class="math inline">\(Cov(Y_t,Y_{t-k}) = θ^k\frac{σ^2}{1-θ^2}\)</span> (when stationary)</li>
<li>Let <span class="math inline">\(y_t \equiv Y_t - μ\)</span>, <span class="math inline">\(y_t = θy_{t-1} + ε_t\)</span></li>
</ul></li>
<li>MA(q): <span class="math inline">\(Y_t = ε_t + α_1 ε_{t-1} +\cdots + α_q ε_{t-q}\)</span></li>
<li>AR(p): <span class="math inline">\(Y_t = θ_1Y_{t-1} +\cdots + θ_pY_{t-p} + ε_t\)</span>
<ul>
<li><span class="math inline">\(y_t = θ_1y_{t-1} -\cdots - θ_py_{t-p} + ε_t\)</span></li>
</ul></li>
<li>ARMA(p,q): <span class="math inline">\(Y_t = θ_1Y_{t-1} +\cdots + θ_pY_{t-p} + ε_t + α_1 ε_{t-1} +\cdots + α_q ε_{t-q}\)</span></li>
</ul>
</div>
<div id="lag-operator" class="section level3">
<h3>Lag Operator</h3>
<ul>
<li><span class="math inline">\(L^0=1\)</span>, <span class="math inline">\(Ly_t = y_{t-1}\)</span>, <span class="math inline">\(L^2 y_t = y_{t-2}\)</span>, …</li>
<li>Characteristic equation: <span class="math inline">\(1-θz = 0\)</span></li>
<li>Characteristic root: <span class="math inline">\(|z|=\left|\frac{1}{θ}\right|\)</span> <span class="math inline">\(\begin{cases}\leq 1 &amp; \text{explosive} \\ &gt; 1 &amp; \text{stationary}\end{cases}\)</span></li>
<li>For AR(1):
<ul>
<li><span class="math inline">\(1-θL\)</span> is invertible if <span class="math inline">\(|θ|&lt;1\)</span>
<span class="math display">\[\begin{aligned} y_t &amp;= θLy_t + ε_t \\ (1-θL) y_t &amp;= ε_t \end{aligned}\]</span><br />
</li>
</ul></li>
<li>For AR(p):
<ul>
<li>Lag Polynomial: <span class="math inline">\(θ(L) = 1 - θ_1L - θ_2L^2 -\cdots - θ_pL^p\)</span>
<span class="math display">\[\begin{aligned} y_t &amp;= θ_1Ly_t -\cdots - θ_p L^p y_t + ε_t \\ θ(L) y_t &amp;= ε_t \\ \end{aligned}\]</span> ~</li>
</ul></li>
</ul>
</div>
<div id="stationary" class="section level3">
<h3>Stationary</h3>
<ul>
<li>Weakly (Covariance) Stationary
<span class="math display">\[\begin{cases} E[Y_t] = μ &lt; \infty \\ Var(Y_t) = Var(Y_{t&#39;}) = γ_0 &lt; \infty \\ Cov(Y_t, Y_{t-k}) = γ_k\end{cases}\]</span><br />
</li>
<li>ACF (AutoCorrelation Function): <span class="math inline">\(ρ_k = \frac{Cov(Y_t,Y_{t-k})}{Var(Y_t)} = \frac{γ_k}{γ_0}\)</span></li>
<li>AR(1) is stationary <span class="math inline">\(\iff\)</span> <span class="math inline">\(1-θL\)</span> is invertible <span class="math inline">\(\iff\)</span> characteristic root <span class="math inline">\(|z| &gt; 1\)</span></li>
</ul>
<blockquote>
<p>Mock.Q2.1<br />
Consider the following regression model with a lagged dependent variable only:<br />
<span class="math display">\[y_t = βy_{t-1} + ε_t\]</span><br />
Provide a simple condition for consistency of the OLS estimator for <span class="math inline">\(β\)</span></p>
</blockquote>
<p>The general condition for the OLS estimator for <span class="math inline">\(β\)</span> is <span class="math inline">\(E[x_tε_t] = 0\)</span>,<br />
here can be written as <span class="math inline">\(E[y_{t-1}ε_t] = 0\)</span></p>
<blockquote>
<p>Mock.Q2.2<br />
Consider the following regression model with a lagged dependent variable only:<br />
<span class="math display">\[y_t = βy_{t-1} + ε_t\]</span><br />
Suppose that the error term <span class="math inline">\(ε_t\)</span> follows the process <span class="math inline">\(ε_t = ρ ε_{t-1} + v_t\)</span> where <span class="math inline">\(v_t∼^{iid} \mathcal{N}(0,σ_v^2)\)</span><br />
1. How is the process for <span class="math inline">\(ε_t\)</span> called?<br />
2. For which values of <span class="math inline">\(ρ\)</span> is <span class="math inline">\(ε_t\)</span> positively autocorrelated? (No derivation needed.)<br />
3. For which values of <span class="math inline">\(ρ\)</span> is <span class="math inline">\(ε_t\)</span> stationary? Derive! (Maximal 5 lines).</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>AR(1)<br />
</li>
<li><span class="math inline">\(ACF = ρ\)</span> <span class="math inline">\(\implies\)</span> <span class="math inline">\(ρ &gt; 0\)</span><br />
</li>
<li>Rewrite <span class="math inline">\(ε_t = ρ ε_{t-1} + v_t\)</span> with lag operater:<br />
<span class="math display">\[\begin{aligned} ε_t &amp;= ρ Lε_t + v_t \\
(1-ρL) ε_t &amp;= v_t\end{aligned}\]</span><br />
Characteristic equation:<br />
<span class="math display">\[\begin{aligned} 1-ρz &amp;= 0 \\
|z| &amp;= \left| \frac{1}{ρ}\right|\end{aligned}\]</span><br />
Condition for <span class="math inline">\(ε_t\)</span> to be stationary:<br />
<span class="math display">\[\begin{aligned} |z| &amp;&gt; 1 \\
|ρ| &amp;&lt; 1\end{aligned}\]</span> ~
<!-- Therefore,  
$$\begin{aligned} Var(ε_t) &= Var(ε_{t-1}) \\
Var(ρ ε_{t-1} + v_t) &= Var(ε_{t-1}) \\
ρ\cdot Var(ε_{t-1}) + Var(v_t) &= Var(ε_{t-1}) \\
Var(ε_{t-1}) &= \frac{σ_v^2}{1-ρ} > 0 \\
ρ &< 1\end{aligned}$$ ~  --></li>
</ol>
<blockquote>
<p>Mock.Q2.3<br />
Consider the following regression model with a lagged dependent variable only:<br />
<span class="math display">\[y_t = βy_{t-1} + ε_t\]</span><br />
One can show that<br />
<span class="math display">\[\text{plim }b = \frac{β+ρ}{1+βρ}\]</span><br />
where <span class="math inline">\(b\)</span> denotes the OLS estimator for <span class="math inline">\(β\)</span> obtained from the regression model.<br />
Suppose that the true <span class="math inline">\(β\)</span> equals $0.54 and that <span class="math inline">\(ρ\in (0,1)\)</span>.<br />
1. Explain whether the OLS estimator <span class="math inline">\(b\)</span> is biased and if so in which direction?<br />
2. What happens in the limiting cases where <span class="math inline">\(ρ\to 0\)</span> or <span class="math inline">\(ρ\to 1\)</span>?<br />
3. Would the endogeneity bias be circumvented by estimating the following alternative regression?<br />
<span class="math inline">\(y_t = β_1 y_{t-1} + β_2 y_{t-2} + β_3 y_{t-3} + w_t\)</span></p>
</blockquote>
<ol style="list-style-type: decimal">
<li>Yes.<br />
<span class="math display">\[\begin{aligned} \text{plim }b &amp;= \frac{β+ρ}{1+βρ} \\
&amp;= \frac{1+\frac{ρ}{β}}{\frac{1}{β}+ρ} \\
&amp;= \frac{1+\frac{ρ}{β}+ βρ - βρ}{\frac{1}{β}+ρ} \\
&amp;= \frac{1+ βρ}{\frac{1}{β}+ρ} + \frac{\frac{ρ}{β}- βρ}{\frac{1}{β}+ρ} \\
&amp;= β + \frac{\frac{1}{β}- β}{\frac{1}{β}+ρ}\cdot ρ \end{aligned}\]</span><br />
</li>
<li>When <span class="math inline">\(ρ\to 0\)</span>, <span class="math inline">\(\text{plim }b\to β\)</span> (unbiasedness)<br />
When <span class="math inline">\(ρ\to 1\)</span>, <span class="math inline">\(\text{plim }b\to 1\)</span><br />
</li>
<li>Yes, yet with efficiency loss if include <span class="math inline">\(t-3\)</span> term.<br />
Rewrite the original model with lag operater:<br />
<span class="math display">\[\begin{aligned} y_t &amp;= βL y_t + ε_t \\
(1-βL) y_t &amp;= ε_t \end{aligned}\]</span><br />
Therefore, two lags will be sufficient.</li>
</ol>
<blockquote>
<p>Mock.Q2.4<br />
Consider the following regression model with a lagged dependent variable only:<br />
<span class="math display">\[y_t = βy_{t-1} + ε_t\]</span><br />
In order to test for autocorrelation in the residuals <span class="math inline">\(\hat{ε_t}\)</span> (epsilonhat) from the regression <span class="math inline">\(y_t = βy_{t-1} + ε_t\)</span> use the Box-Pierce statistic <span class="math inline">\(Q_m =T\cdot\sum_{j=1}^m \hat{ρ_j}^2\)</span>,<br />
where <span class="math inline">\(T = 280\)</span> denotes the sample size and <span class="math inline">\(\hat{ρ_j}\)</span> is the empirical <span class="math inline">\(j\)</span>th-order autocorrelation coefficient.<br />
Carry out the test for <span class="math inline">\(m = 2\)</span> and use the information in the corrupted R output below in combination with the estimation results reported in the table:<br />
(Autocorrelations of series epsilonhat, by lag)</p>
<table>
<thead>
<tr class="header">
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.000</td>
<td></td>
<td>0.212</td>
<td>0.152</td>
<td>-0.253</td>
<td>-1.000</td>
</tr>
</tbody>
</table>
<pre class="r"><code>dynlm( formula = epsilonhat ~ L(epsilonhat, 1 ))

# Residuals:
#     Min     1Q Median     3Q Max
# -4.0487 0.3869 0.0345 0.3575 3.5857

# Coefficients:
#                  Estimate Std. Error t value Pr(&gt;|t|)
# (Intercept)     -0.001806   0.046903  -0.038    0.969
# L(epsilonhat,1)  0.437636   0.053792   8.136 1.36e-14 ***</code></pre>
<ol style="list-style-type: decimal">
<li>State the null and the alternative hypothesis.<br />
</li>
<li>Select the appropriate <span class="math inline">\(5\%\)</span>-critical value from the following set and interpret the test decision:<br />
<span class="math display">\[\begin{aligned} F^{280-2}_2 &amp;= 3.03 \\ F^2_{280-2} &amp;= 19.49 \\ χ_2^2 &amp;= 5.99 \\ χ_{280-2}^2 &amp;= 317.89 \\ t_2 &amp;= 2.92 \\ t_{280-2} &amp;= 1.65 \end{aligned}\]</span><br />
</li>
<li>Why is the Durbin-Watson test invalid in this setting? (Max 3 sentences)</li>
</ol>
</blockquote>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(ε_t\)</span> has no autocorrelation (first two lags have zero coefficient)<br />
<span class="math inline">\(H_1\)</span>: <span class="math inline">\(ε_t\)</span> has autocorrelation<br />
</li>
<li>Critical value: <span class="math inline">\(χ_2^2 = 5.99\)</span> with <span class="math inline">\(df = 2\)</span><br />
<span class="math display">\[\begin{aligned} Q_2 &amp;= 280\cdot\sum_{j=1}^2 \hat{ρ_j}^2 \\
&amp;= 280\times (0.4376^2 + 0.212^2) \\
&amp;= 66.2 &gt; 5.99\end{aligned}\]</span><br />
Therefore, <span class="math inline">\(H_0\)</span> is rejected, and <span class="math inline">\(ε_t\)</span> has autocorrelation<br />
</li>
<li>Because the dependent variable (<span class="math inline">\(ε_t\)</span>) is lagged.</li>
</ol>
</div>
</div>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  (function() { 
  var d = document, s = d.createElement('script');
  s.src = 'https://loikein-github.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>





</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
          <li>By loikein with love</li>
        </ul>
      </footer>

    </div>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
  </body>
</html>

